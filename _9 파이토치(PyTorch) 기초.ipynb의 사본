{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"_9 파이토치(PyTorch) 기초.ipynb의 사본","provenance":[{"file_id":"1eHykNLFgidFmMBxKSDF9K5G2hPatXr5G","timestamp":1603365559334}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"e7cfec9a75824ca0badfd721564ef46d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_64b78d0cde0c461fa37d7c54348ed658","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_65d1573a9abd47d4a3ec3ab5a9125f52","IPY_MODEL_1cbf0c45322949bd8abcfe3fe996f04a"]}},"64b78d0cde0c461fa37d7c54348ed658":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"65d1573a9abd47d4a3ec3ab5a9125f52":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_682b64af1c874d9c98d27fe291a8b092","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_378f265c040744949671d8a24a9ae191"}},"1cbf0c45322949bd8abcfe3fe996f04a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_16c52afcd6d84430894f1f947d0a045b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:06&lt;00:00, 1494796.84it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b9b61265e7b142ef913a5d6307af8092"}},"682b64af1c874d9c98d27fe291a8b092":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"378f265c040744949671d8a24a9ae191":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"16c52afcd6d84430894f1f947d0a045b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b9b61265e7b142ef913a5d6307af8092":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d4a94efa48984d5bbddc5538526dfcf9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5b298b671afd45e695b728f5cabba821","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_d9b54548c832497fa0376504395a257f","IPY_MODEL_52f83747cf45403d8d88b32fbdf86b5f"]}},"5b298b671afd45e695b728f5cabba821":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d9b54548c832497fa0376504395a257f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f2470f7cbf08460ca5e1a81514db91b4","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d3370d92cebb4472b99746a9b01ed772"}},"52f83747cf45403d8d88b32fbdf86b5f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7fc48bc1c87c4c91a5e32e3529cd6b5c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 392671.51it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_399c52bcf8ab4c059ad64d1e81319a99"}},"f2470f7cbf08460ca5e1a81514db91b4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d3370d92cebb4472b99746a9b01ed772":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7fc48bc1c87c4c91a5e32e3529cd6b5c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"399c52bcf8ab4c059ad64d1e81319a99":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"308dabbf75f04c1aa1938c96bd666146":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f20488d4a53346f7865a71ffe4e03e86","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_38199483d85d4296a73635ec95795894","IPY_MODEL_ec1b478955924f02a1ae92188e5b1442"]}},"f20488d4a53346f7865a71ffe4e03e86":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"38199483d85d4296a73635ec95795894":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b4f51ae8249f47cf9f48c2bdd81e1ed4","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_49d1da9f6eda42a29bf1fbfdf149e74d"}},"ec1b478955924f02a1ae92188e5b1442":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_eb4f6a45951a4b719eb3be051eacff8a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:05&lt;00:00, 281892.26it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bc63836ec263410b9580bcec4ab7d7db"}},"b4f51ae8249f47cf9f48c2bdd81e1ed4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"49d1da9f6eda42a29bf1fbfdf149e74d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"eb4f6a45951a4b719eb3be051eacff8a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bc63836ec263410b9580bcec4ab7d7db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"177367e1b4754857a088ec3cd0367be6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b58d7b80cf0c48f9b9b9807c185f453a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c1ecdc692d8d435e9e91c7bc0e7c8ff6","IPY_MODEL_707e61e978664477a5dcd1dd98c46bac"]}},"b58d7b80cf0c48f9b9b9807c185f453a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c1ecdc692d8d435e9e91c7bc0e7c8ff6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9804b8f68ccc48cd8da62c43f4d08212","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3d103012b1214e5aaae9ffe329f0574e"}},"707e61e978664477a5dcd1dd98c46bac":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3d2840c829bd44c09bcfdfb6fb15602a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:00&lt;00:00, 23831.62it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_92ef8b84976a4999ba1871a166e6f739"}},"9804b8f68ccc48cd8da62c43f4d08212":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3d103012b1214e5aaae9ffe329f0574e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3d2840c829bd44c09bcfdfb6fb15602a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"92ef8b84976a4999ba1871a166e6f739":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"f9Xx-jP92OgP"},"source":["# 파이토치(PyTorch)\n","\n","<img src=\"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbuUgoV%2FbtqwWZvcHHX%2Fd6XzIFBEfiuFb0UvyV4A50%2Fimg.jpg\" width=\"300\">\n","\n","- 코드 출처: https://pytorch.org/tutorials/"]},{"cell_type":"markdown","metadata":{"id":"3cxreguz2sL0"},"source":["## 파이토치의 구성요소\n","\n","- `torch`: 텐서를 생성하는 라이브러리\n","\n","- `torch.autograd`: 자동미분 기능을 제공하는 라이브러리\n","\n","- `torch.nn`: 신경망을 생성하는 라이브러리\n","\n","- `torch.multiprocessing`: 병럴처리 기능을 제공하는 라이브러리\n","\n","- `torch.utils`: 데이터 조작 등 유틸리티 기능 제공\n","\n","- `torch.legacy`(./nn/.optim): Torch로을부터 포팅해온 코드\n","\n","- `torch.onnx`: ONNX(Open Neural Network Exchange)\n","\n","  - 서로 다른 프레임워크 간의 모델 공유할 때 사용"]},{"cell_type":"markdown","metadata":{"id":"gb5O_aSvtHvb"},"source":["## 텐서(Tensors)\n","- 넘파이(NumPy)의 ndarray와 유사\n","\n","- GPU를 사용한 연산 가속도 가능"]},{"cell_type":"code","metadata":{"id":"CmKIvnx0s8G6","executionInfo":{"status":"ok","timestamp":1603365147886,"user_tz":-540,"elapsed":6002,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch"],"execution_count":2,"outputs":[]},{"cell_type":"code","metadata":{"id":"49IHV-qJE5FI","executionInfo":{"status":"ok","timestamp":1603365147887,"user_tz":-540,"elapsed":5971,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"88f37af8-c18e-49e5-b826-1d32a7f878df","colab":{"base_uri":"https://localhost:8080/","height":37}},"source":["torch.__version__"],"execution_count":3,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'1.6.0+cu101'"]},"metadata":{"tags":[]},"execution_count":3}]},{"cell_type":"markdown","metadata":{"id":"isUHVy-gtZeT"},"source":["### 초기화 되지 않은 행렬 "]},{"cell_type":"code","metadata":{"id":"3PqY3cZatU0D","executionInfo":{"status":"ok","timestamp":1603365147888,"user_tz":-540,"elapsed":5917,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"9c6998b9-6c84-4b0b-feb4-d97b7ff11438","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["x = torch.empty(4,2)\n","print(x)"],"execution_count":4,"outputs":[{"output_type":"stream","text":["tensor([[3.9353e-35, 0.0000e+00],\n","        [3.3631e-44, 0.0000e+00],\n","        [       nan, 0.0000e+00],\n","        [1.1578e+27, 1.1362e+30]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"zPCIJ2pNteZv"},"source":["### 무작위로 초기화된 행렬"]},{"cell_type":"code","metadata":{"id":"h6oPj2Q9tdYx","executionInfo":{"status":"ok","timestamp":1603365147888,"user_tz":-540,"elapsed":5862,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"2fa3cfbb-5804-444d-be4d-4c15d54e7d1c","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["x = torch.rand(4,2)\n","print(x)"],"execution_count":5,"outputs":[{"output_type":"stream","text":["tensor([[0.5762, 0.2021],\n","        [0.7918, 0.3415],\n","        [0.4598, 0.4786],\n","        [0.3477, 0.4970]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"A5aHphIHtiJk"},"source":["### dtype이 long, 0으로 채워진 텐서"]},{"cell_type":"code","metadata":{"id":"4zykN8aMthXk","executionInfo":{"status":"ok","timestamp":1603365147888,"user_tz":-540,"elapsed":5807,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"cad5c1ca-72fd-42b7-ad3f-8a44adbdfa25","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["x = torch.zeros(4,2, dtype=torch.long)\n","print(x)"],"execution_count":6,"outputs":[{"output_type":"stream","text":["tensor([[0, 0],\n","        [0, 0],\n","        [0, 0],\n","        [0, 0]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"W4VL8C_ctu8b","executionInfo":{"status":"ok","timestamp":1603365147889,"user_tz":-540,"elapsed":5752,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"9e230a30-1583-4c35-a0fe-7f7088b3351d","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["x = torch.tensor([3, 2.3])\n","print(x)"],"execution_count":7,"outputs":[{"output_type":"stream","text":["tensor([3.0000, 2.3000])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"4RmVBVtIt46M","executionInfo":{"status":"ok","timestamp":1603365147889,"user_tz":-540,"elapsed":5691,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"790f001c-ecfb-4628-cf2e-5ad1d2aa5ed6","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["x = x.new_ones(2,4,dtype= torch.double)\n","print(x)"],"execution_count":8,"outputs":[{"output_type":"stream","text":["tensor([[1., 1., 1., 1.],\n","        [1., 1., 1., 1.]], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"xxskTUfGuPUe","executionInfo":{"status":"ok","timestamp":1603365148317,"user_tz":-540,"elapsed":6051,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"4bb3ee0b-00c3-4ab5-e793-2b27e5273e14","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["x = torch.randn_like(x, dtype=torch.float)\n","print(x)"],"execution_count":9,"outputs":[{"output_type":"stream","text":["tensor([[ 0.9053,  0.5523, -0.8764,  0.0549],\n","        [ 2.6328,  1.4964,  0.8210, -1.0664]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7j5sGxGvucpH"},"source":["### 텐서의 크기"]},{"cell_type":"code","metadata":{"id":"yy-JbqKEuYIR","executionInfo":{"status":"ok","timestamp":1603365148318,"user_tz":-540,"elapsed":5997,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"68ed5338-af9d-485d-8075-d307a43d8386","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(x.size())"],"execution_count":10,"outputs":[{"output_type":"stream","text":["torch.Size([2, 4])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ehOg0eDwufru"},"source":["## 텐서의 연산(operations)"]},{"cell_type":"markdown","metadata":{"id":"j8Doc_37uh3G"},"source":["### 덧셈 1"]},{"cell_type":"code","metadata":{"id":"Rw4JCYkYuef9","executionInfo":{"status":"ok","timestamp":1603365148318,"user_tz":-540,"elapsed":5942,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"a4f88121-b780-4ce2-f3d7-dcf32e24acdd","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["print(x)"],"execution_count":11,"outputs":[{"output_type":"stream","text":["tensor([[ 0.9053,  0.5523, -0.8764,  0.0549],\n","        [ 2.6328,  1.4964,  0.8210, -1.0664]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Wa44ur1Nuj5U","executionInfo":{"status":"ok","timestamp":1603365148318,"user_tz":-540,"elapsed":5884,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"02743dee-0829-4dfd-b1b1-4da8eeade51d","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["y = torch.rand(2,4)\n","print(y)\n","print(x + y)"],"execution_count":12,"outputs":[{"output_type":"stream","text":["tensor([[0.1011, 0.1184, 0.2430, 0.3308],\n","        [0.6842, 0.2062, 0.6315, 0.5982]])\n","tensor([[ 1.0063,  0.6707, -0.6334,  0.3857],\n","        [ 3.3170,  1.7026,  1.4525, -0.4682]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"E5gcOo-Ouo9B"},"source":["### 덧셈2"]},{"cell_type":"code","metadata":{"id":"Qx-NzJhhumZx","executionInfo":{"status":"ok","timestamp":1603365148319,"user_tz":-540,"elapsed":5831,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"6babfc5e-652a-49e0-de4d-c7dbc3f9ad77","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["print(torch.add(x,y))"],"execution_count":13,"outputs":[{"output_type":"stream","text":["tensor([[ 1.0063,  0.6707, -0.6334,  0.3857],\n","        [ 3.3170,  1.7026,  1.4525, -0.4682]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"RlvrQhLuuuIr"},"source":["### 덧셈3\n","- 결과 텐서를 인자로 제공"]},{"cell_type":"code","metadata":{"id":"lUsLAOTcur1-","executionInfo":{"status":"ok","timestamp":1603365148319,"user_tz":-540,"elapsed":5777,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8a5eb833-00cf-4ae9-8ad6-596061e00ade","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["result = torch.empty(2,4)\n","torch.add(x,y, out=result)\n","print(result)"],"execution_count":14,"outputs":[{"output_type":"stream","text":["tensor([[ 1.0063,  0.6707, -0.6334,  0.3857],\n","        [ 3.3170,  1.7026,  1.4525, -0.4682]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V6BdyZFSu2Ei"},"source":["### 덧셈4\n","- `in-place` 방식\n","\n","- (참고) in-place 방식\n","  - in-place방식으로 텐서의 값을 변경하는 연산 뒤에는 _''가 붙음\n","  - `x.copy_(y), x.t_()`"]},{"cell_type":"code","metadata":{"id":"lu8rR4WVu0wQ","executionInfo":{"status":"ok","timestamp":1603365148319,"user_tz":-540,"elapsed":5722,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8ea99a6e-a3f6-4712-dd82-c89f1a7f26ea","colab":{"base_uri":"https://localhost:8080/","height":119}},"source":["print(x)\n","print(y)\n","y.add_(x)\n","print(y)"],"execution_count":15,"outputs":[{"output_type":"stream","text":["tensor([[ 0.9053,  0.5523, -0.8764,  0.0549],\n","        [ 2.6328,  1.4964,  0.8210, -1.0664]])\n","tensor([[0.1011, 0.1184, 0.2430, 0.3308],\n","        [0.6842, 0.2062, 0.6315, 0.5982]])\n","tensor([[ 1.0063,  0.6707, -0.6334,  0.3857],\n","        [ 3.3170,  1.7026,  1.4525, -0.4682]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Uo8nsrGjOw6W"},"source":["### 그 외의 연산\n","- `torch.sub` : 뺄셈\n","\n","- `torch.mul` : 곱셉\n","\n","- `torch.div` : 나눗셈\n","\n","- `torch.mm` : 내적(dot product)"]},{"cell_type":"code","metadata":{"id":"S51kxzPTO1ER","executionInfo":{"status":"ok","timestamp":1603365148320,"user_tz":-540,"elapsed":5669,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"4b3ea727-03eb-4ad8-99d0-e5743923732c","colab":{"base_uri":"https://localhost:8080/"}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x - y)\n","print(torch.sub(x,y))\n","print(x.sub_(y))"],"execution_count":16,"outputs":[{"output_type":"stream","text":["tensor([[-1., -1.],\n","        [-1., -1.]])\n","tensor([[-1., -1.],\n","        [-1., -1.]])\n","tensor([[-1., -1.],\n","        [-1., -1.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"ou0dY8mkPR24","executionInfo":{"status":"ok","timestamp":1603365148320,"user_tz":-540,"elapsed":5615,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"9307e0e0-2333-4f2c-ffda-aa58dd24615a","colab":{"base_uri":"https://localhost:8080/","height":119}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x * y)\n","print(torch.mul(x,y))\n","print(x.mul_(y))"],"execution_count":17,"outputs":[{"output_type":"stream","text":["tensor([[ 2., 12.],\n","        [30., 56.]])\n","tensor([[ 2., 12.],\n","        [30., 56.]])\n","tensor([[ 2., 12.],\n","        [30., 56.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6RlZZBp3PbE4","executionInfo":{"status":"ok","timestamp":1603365148321,"user_tz":-540,"elapsed":5560,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"fd0666bb-2726-4dda-a1e3-f392ab15fdc5","colab":{"base_uri":"https://localhost:8080/","height":119}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x / y)\n","print(torch.div(x,y))\n","print(x.div_(y))"],"execution_count":18,"outputs":[{"output_type":"stream","text":["tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n","tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n","tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"7MR-ofE5P7VC","executionInfo":{"status":"ok","timestamp":1603365148321,"user_tz":-540,"elapsed":5505,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"77c081f8-28b5-43f9-c69c-71e3b33afaf1","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(torch.mm(x,y))\n"],"execution_count":19,"outputs":[{"output_type":"stream","text":["tensor([[20., 28.],\n","        [52., 76.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"8URGwHE_NjDi"},"source":["## 텐서의 조작(manipulations)"]},{"cell_type":"markdown","metadata":{"id":"uCsdZIPTvG53"},"source":["### 인덱싱\n","- 넘파이처럼 인덱싱 사용가능"]},{"cell_type":"code","metadata":{"id":"jF2DE8kzvOs3","executionInfo":{"status":"ok","timestamp":1603365148322,"user_tz":-540,"elapsed":5452,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"3fa37256-0201-4c57-d3aa-21e44ac77a56","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["print(x)"],"execution_count":20,"outputs":[{"output_type":"stream","text":["tensor([[1., 3.],\n","        [5., 7.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GQtBH3r3u7c3","executionInfo":{"status":"ok","timestamp":1603365148322,"user_tz":-540,"elapsed":5399,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"66433bc7-94de-45ec-b053-08ea40066d38","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(x[:, 1])"],"execution_count":21,"outputs":[{"output_type":"stream","text":["tensor([3., 7.])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"jEscXddKvQ5l"},"source":["### view\n","- 텐서의 크기(size)나 모양(shape)을 변경"]},{"cell_type":"code","metadata":{"id":"xwhWeqhLvKKj","executionInfo":{"status":"ok","timestamp":1603365148322,"user_tz":-540,"elapsed":5344,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"90edd4c7-70b8-4cea-8488-a68cf411f51b","colab":{"base_uri":"https://localhost:8080/","height":272}},"source":["x = torch.randn(4,5)\n","\n","y = x.view(20)\n","z = x.view(5, -1)\n","\n","print(x)\n","print(y)\n","print(z)\n","\n","\n","print(x.size())\n","print(y.size())\n","print(z.size())"],"execution_count":22,"outputs":[{"output_type":"stream","text":["tensor([[-1.3296, -0.8244,  0.7867,  0.0835, -0.5811],\n","        [-0.2710,  1.4187, -1.0593, -1.0796, -1.7541],\n","        [ 1.1232, -1.1416,  1.4281, -1.3923, -1.0402],\n","        [-0.1357,  0.2205, -0.1127,  0.1166, -0.6787]])\n","tensor([-1.3296, -0.8244,  0.7867,  0.0835, -0.5811, -0.2710,  1.4187, -1.0593,\n","        -1.0796, -1.7541,  1.1232, -1.1416,  1.4281, -1.3923, -1.0402, -0.1357,\n","         0.2205, -0.1127,  0.1166, -0.6787])\n","tensor([[-1.3296, -0.8244,  0.7867,  0.0835],\n","        [-0.5811, -0.2710,  1.4187, -1.0593],\n","        [-1.0796, -1.7541,  1.1232, -1.1416],\n","        [ 1.4281, -1.3923, -1.0402, -0.1357],\n","        [ 0.2205, -0.1127,  0.1166, -0.6787]])\n","torch.Size([4, 5])\n","torch.Size([20])\n","torch.Size([5, 4])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"iBY_wuIRvf5j"},"source":["### item\n","- 텐서에 값이 단 하나라도 존재하면 숫자값을 얻을 수 있음\n"]},{"cell_type":"code","metadata":{"id":"E0W24QqpvcmV","executionInfo":{"status":"ok","timestamp":1603365148323,"user_tz":-540,"elapsed":5292,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"3987a9a1-0b07-47f0-e29d-65a5cfd7a9f7","colab":{"base_uri":"https://localhost:8080/"}},"source":["x=  torch.randn(1)\n","\n","print(x)\n","\n","print(x.item())\n","print(x.dtype)"],"execution_count":23,"outputs":[{"output_type":"stream","text":["tensor([-0.2965])\n","-0.2964935302734375\n","torch.float32\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V1sCUVwC3Nua"},"source":["- 스칼라값 하나만 존재해야함"]},{"cell_type":"code","metadata":{"id":"jl4_FAgd3Lt9","executionInfo":{"status":"error","timestamp":1603365152156,"user_tz":-540,"elapsed":9069,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"d6a9bcdd-1f21-4ef1-a436-b4833359132b","colab":{"base_uri":"https://localhost:8080/","height":232}},"source":["x=  torch.randn(2)\n","\n","print(x)\n","\n","print(x.item())\n","print(x.dtype)"],"execution_count":24,"outputs":[{"output_type":"stream","text":["tensor([ 0.2302, -0.1064])\n"],"name":"stdout"},{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-24-cc6c8677be41>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      6\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: only one element tensors can be converted to Python scalars"]}]},{"cell_type":"markdown","metadata":{"id":"uThndsy5M6wM"},"source":["### squeeze \n","- 차원을 축소(제거)"]},{"cell_type":"code","metadata":{"id":"OF3rOavnRxgM","executionInfo":{"status":"ok","timestamp":1603365161686,"user_tz":-540,"elapsed":1246,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7205c137-41af-44ca-b93f-a1bd606061ab","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["tensor = torch.rand(1,3,3)\n","print(tensor)\n","tensor.shape\n"],"execution_count":25,"outputs":[{"output_type":"stream","text":["tensor([[[0.0852, 0.7075, 0.3722],\n","         [0.8803, 0.7646, 0.5658],\n","         [0.9560, 0.8155, 0.3423]]])\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 3, 3])"]},"metadata":{"tags":[]},"execution_count":25}]},{"cell_type":"code","metadata":{"id":"Y2jq0jHJR5Jw","executionInfo":{"status":"ok","timestamp":1603365161687,"user_tz":-540,"elapsed":660,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"9ef45221-e1fe-4aa5-8323-9b04762f1b50","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["t = tensor.squeeze()\n","\n","print(t)\n","print(t.shape)"],"execution_count":26,"outputs":[{"output_type":"stream","text":["tensor([[0.0852, 0.7075, 0.3722],\n","        [0.8803, 0.7646, 0.5658],\n","        [0.9560, 0.8155, 0.3423]])\n","torch.Size([3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"COv-dnTYNJ8Z"},"source":["### unsqueeze\n","- 차원을 증가(생성)"]},{"cell_type":"code","metadata":{"id":"PFxaHGY1NOBo","executionInfo":{"status":"ok","timestamp":1603365164279,"user_tz":-540,"elapsed":1014,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7d16449d-bc41-4dc4-ed9a-1f7af1aa6c55","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["tensor = torch.rand(1,3,3)\n","print(tensor)\n","tensor.shape\n"],"execution_count":27,"outputs":[{"output_type":"stream","text":["tensor([[[0.8608, 0.1878, 0.6152],\n","         [0.7929, 0.0360, 0.7703],\n","         [0.1213, 0.1053, 0.3559]]])\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 3, 3])"]},"metadata":{"tags":[]},"execution_count":27}]},{"cell_type":"code","metadata":{"id":"b6sa4tJ7SA8G","executionInfo":{"status":"ok","timestamp":1603365164280,"user_tz":-540,"elapsed":692,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"9d86cc0b-b281-4ab2-ebf3-44530751bca6","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["t = tensor.unsqueeze(dim=0)\n","\n","print(t)\n","print(t.shape)"],"execution_count":28,"outputs":[{"output_type":"stream","text":["tensor([[[[0.8608, 0.1878, 0.6152],\n","          [0.7929, 0.0360, 0.7703],\n","          [0.1213, 0.1053, 0.3559]]]])\n","torch.Size([1, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"_C_oa9JANOa6"},"source":["### stack\n","- 텐서간 결합"]},{"cell_type":"code","metadata":{"id":"f3x_XaUYNOuc","executionInfo":{"status":"ok","timestamp":1603365164782,"user_tz":-540,"elapsed":513,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ae299485-3e69-4ce2-8b13-b1d36d1b54d9","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["x = torch.FloatTensor([1, 4])\n","y = torch.FloatTensor([2, 5])\n","z = torch.FloatTensor([3, 6])\n","\n","print(torch.stack([x,y,z]))"],"execution_count":29,"outputs":[{"output_type":"stream","text":["tensor([[1., 4.],\n","        [2., 5.],\n","        [3., 6.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"XmJscbfg35-c"},"source":["### cat\n","- 텐서를 결합하는 메소드(concatenate)\n","\n","- 넘파이의 `stack`과 유사하지만, 쌓을 dim이 존재해야함\n","  - 예를 들어, 해당 차원을 늘려준 후 결합\n"]},{"cell_type":"code","metadata":{"id":"Mv3zlaNm37P1","executionInfo":{"status":"ok","timestamp":1603365166204,"user_tz":-540,"elapsed":1185,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8e53cbb8-7d46-4b9c-ab76-14441d4d0c78","colab":{"base_uri":"https://localhost:8080/","height":170}},"source":["a = torch.randn(1,1,3,3)\n","b = torch.randn(1,1,3,3)\n","c = torch.cat((a,b), dim=0)\n","\n","print(c)\n","print(c.size())"],"execution_count":30,"outputs":[{"output_type":"stream","text":["tensor([[[[-0.9252, -1.1632, -1.4563],\n","          [-0.0471,  0.1135, -0.2534],\n","          [-0.1753, -0.2244, -0.9254]]],\n","\n","\n","        [[[ 0.6940,  0.1563,  0.7582],\n","          [ 0.9869,  1.4703,  1.3958],\n","          [ 2.5886,  0.4564,  0.0611]]]])\n","torch.Size([2, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"69M5jY60S7Mi","executionInfo":{"status":"ok","timestamp":1603365166205,"user_tz":-540,"elapsed":712,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"b23dcfb0-0223-4184-88aa-9fc42f15db49","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["a = torch.randn(1,3,3)\n","b = torch.randn(1,3,3)\n","c = torch.cat((a,b), dim=2)\n","\n","\n","print(c)\n","print(c.size())"],"execution_count":31,"outputs":[{"output_type":"stream","text":["tensor([[[ 0.5565,  0.6813,  0.1054,  0.4357,  0.4533, -1.1796],\n","         [-0.6190,  0.3701,  0.7711, -0.0970,  1.1067, -0.1324],\n","         [ 1.1224,  0.4995,  0.9578,  0.2806,  1.2251, -0.5879]]])\n","torch.Size([1, 3, 6])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7gGXnOAqQTmG"},"source":["### chuck\n","- 텐서를 여러 개로 나눌 때 사용\n","\n","- 몇 개의 텐서로 나눌 것이냐"]},{"cell_type":"code","metadata":{"id":"pNV80VzPQZgG","executionInfo":{"status":"ok","timestamp":1603365166576,"user_tz":-540,"elapsed":456,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7d93c673-46d3-4777-8578-8bc378f2fda2","colab":{"base_uri":"https://localhost:8080/","height":221}},"source":["tensor = torch.rand(3,6)\n","t1, t2, t3 = torch.chunk(tensor, 3, dim=1)\n","\n","print(tensor)\n","print(t1)\n","print(t2)\n","print(t3)"],"execution_count":32,"outputs":[{"output_type":"stream","text":["tensor([[0.3745, 0.2792, 0.4768, 0.3322, 0.4377, 0.1422],\n","        [0.6580, 0.4033, 0.3157, 0.6040, 0.0978, 0.4108],\n","        [0.6482, 0.0608, 0.9243, 0.9032, 0.0191, 0.3682]])\n","tensor([[0.3745, 0.2792],\n","        [0.6580, 0.4033],\n","        [0.6482, 0.0608]])\n","tensor([[0.4768, 0.3322],\n","        [0.3157, 0.6040],\n","        [0.9243, 0.9032]])\n","tensor([[0.4377, 0.1422],\n","        [0.0978, 0.4108],\n","        [0.0191, 0.3682]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7U0Qb0jWQgm-"},"source":["### split\n","- `chunck`와 동일한 기능이지만 조금 다름\n","\n","- 하나의 텐서당 크기가 얼마이냐"]},{"cell_type":"code","metadata":{"id":"1V6DDnLVQqxz","executionInfo":{"status":"ok","timestamp":1603365167819,"user_tz":-540,"elapsed":1010,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ff378b72-e4bd-4f36-a144-a7c99549b7b3","colab":{"base_uri":"https://localhost:8080/","height":170}},"source":["tensor = torch.rand(3,6)\n","t1, t2 = torch.split(tensor, 3, dim=1)\n","\n","print(tensor)\n","print(t1)\n","print(t2)"],"execution_count":33,"outputs":[{"output_type":"stream","text":["tensor([[0.0300, 0.9757, 0.6445, 0.5914, 0.5872, 0.1562],\n","        [0.0974, 0.4001, 0.0630, 0.4045, 0.6093, 0.3181],\n","        [0.1652, 0.1701, 0.0882, 0.7886, 0.0296, 0.8922]])\n","tensor([[0.0300, 0.9757, 0.6445],\n","        [0.0974, 0.4001, 0.0630],\n","        [0.1652, 0.1701, 0.0882]])\n","tensor([[0.5914, 0.5872, 0.1562],\n","        [0.4045, 0.6093, 0.3181],\n","        [0.7886, 0.0296, 0.8922]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"estSwhCgvta6"},"source":["### torch ↔ numpy\n","- Torch Tensor(텐서)를 Numpy array(배열)로 변환 가능\n","\n","  - `numpy()`\n","  - `from_numpy()`\n","\n","- (참고)\n","  - Tensor가 CPU상에 있다면 Numpy 배열은 메모리 공간을 공유하므로 하나가 변하면, 다른 하나도 변함"]},{"cell_type":"code","metadata":{"id":"VxHI7c_yvmAT","executionInfo":{"status":"ok","timestamp":1603365168359,"user_tz":-540,"elapsed":936,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"742732c8-7938-4e4c-d14e-62a50319e1bc","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["a = torch.ones(7)\n","print(a)"],"execution_count":34,"outputs":[{"output_type":"stream","text":["tensor([1., 1., 1., 1., 1., 1., 1.])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"whbrhokHwJ3A","executionInfo":{"status":"ok","timestamp":1603365168847,"user_tz":-540,"elapsed":1131,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"bee254b6-ce7b-41c4-f8eb-4ea933d35802","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["b = a.numpy()\n","print(b)"],"execution_count":35,"outputs":[{"output_type":"stream","text":["[1. 1. 1. 1. 1. 1. 1.]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"5StIhUWDwQjA","executionInfo":{"status":"ok","timestamp":1603365168848,"user_tz":-540,"elapsed":864,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"4697e704-ad25-453b-c6f0-bb24a817dc3c","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["a.add_(1)\n","print(a)\n","print(b)"],"execution_count":36,"outputs":[{"output_type":"stream","text":["tensor([2., 2., 2., 2., 2., 2., 2.])\n","[2. 2. 2. 2. 2. 2. 2.]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"3RNS5-cRwTt8","executionInfo":{"status":"ok","timestamp":1603365169453,"user_tz":-540,"elapsed":1098,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7114be35-90c5-4cd1-de48-0501b4e39cec","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["import numpy as np\n","\n","a= np.ones(7)\n","b = torch.from_numpy(a)\n","np.add(a, 1, out=a)\n","print(a)\n","print(b)"],"execution_count":37,"outputs":[{"output_type":"stream","text":["[2. 2. 2. 2. 2. 2. 2.]\n","tensor([2., 2., 2., 2., 2., 2., 2.], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"v-ZaxSvLxEej"},"source":["## CUDA Tensors\n","- `.to` 메소드를 사용하여 텐서를 어떠한 장치로도 옮길 수 있음\n","  - 예) cpu, gpu"]},{"cell_type":"code","metadata":{"id":"xkaQznCRxpUj","executionInfo":{"status":"ok","timestamp":1603365169903,"user_tz":-540,"elapsed":852,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch"],"execution_count":38,"outputs":[]},{"cell_type":"code","metadata":{"id":"SCnC0x2Rxpbk","executionInfo":{"status":"ok","timestamp":1603365169904,"user_tz":-540,"elapsed":554,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ed47f83e-079f-42e1-cb9f-44aa42bac18d","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["x = torch.randn(1)\n","print(x)\n","print(x.item())\n","print(x.dtype)"],"execution_count":39,"outputs":[{"output_type":"stream","text":["tensor([-1.4824])\n","-1.4823514223098755\n","torch.float32\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GcSsFLkDw-nI","executionInfo":{"status":"ok","timestamp":1603365180836,"user_tz":-540,"elapsed":11168,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8efbb935-d8c5-4d76-ab3a-d6f5bbd446e3","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","y =torch.ones_like(x, device=device)\n","x = x.to(device)\n","z = x + y\n","print(device)\n","print(z)\n","print(z.to(\"cpu\", torch.double))"],"execution_count":40,"outputs":[{"output_type":"stream","text":["cuda\n","tensor([-0.4824], device='cuda:0')\n","tensor([-0.4824], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NKqiGvLWx2nk"},"source":["## AUTOGRAD (자동미분)\n","- autograd 패키지는 Tensor의 모든 연산에 대해 **자동 미분** 제공\n","\n","- 이는 코드를 어떻게 작성하여 실행하느냐에 따라 역전파가 정의된다는 뜻\n","\n","- backprop를 위한 미분값을 자동으로 계산"]},{"cell_type":"markdown","metadata":{"id":"0zH41l-MyMHi"},"source":["### Tensor\n","\n","- data: tensor형태의 데이터\n","\n","- grad: data가 겨쳐온 layer에 대한 미분값 저장\n","\n","- grad_fn: 미분값을 계산한 함수에 대한 정보 저장 (어떤 함수에 대해서 backprop 했는지)\n","\n","- `requires_grad` 속성을 `True`로 설정하면, 해당 텐서에서 이루어지는 모든 연산들을 추적하기 시작\n","\n","- 계산이 완료된 후, `.backward()`를 호출하면 자동으로 `gradient`를 계산할 수 있으며, `.grad` 속성에 누적됨\n","\n","- 기록을 추적하는 것을 중단하게 하려면, `.detach()`를 호출하여 연산기록으로부터 분리\n","\n","- 기록을 추적하는 것을 방지하기 위해 코드 블럭을 `with torch.no_grad():`로 감싸면 `gradient`는 필요없지만, `requires_grad=True`로 설정되어 학습 가능한 매개변수를 갖는 모델을 평가(evaluate)할 때 유용\n","\n","- Autograd 구현에서 매우 중요한 클래스 : `Function` 클래스"]},{"cell_type":"code","metadata":{"id":"ipdk_1jfx47I","executionInfo":{"status":"ok","timestamp":1603365180837,"user_tz":-540,"elapsed":10339,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch"],"execution_count":41,"outputs":[]},{"cell_type":"code","metadata":{"id":"ljNU-r9p0Rpo","executionInfo":{"status":"ok","timestamp":1603365180838,"user_tz":-540,"elapsed":10041,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7d2f8dd1-0269-4e59-f976-c63f77061d38","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["x=  torch.ones(3, 3, requires_grad=True)\n","print(x)"],"execution_count":42,"outputs":[{"output_type":"stream","text":["tensor([[1., 1., 1.],\n","        [1., 1., 1.],\n","        [1., 1., 1.]], requires_grad=True)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"or6sQ4EB0UYz","executionInfo":{"status":"ok","timestamp":1603365180838,"user_tz":-540,"elapsed":9708,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"a3f0e30b-4c8a-4b04-b397-6b7e3115a12e","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["y = x +5\n","print(y)"],"execution_count":43,"outputs":[{"output_type":"stream","text":["tensor([[6., 6., 6.],\n","        [6., 6., 6.],\n","        [6., 6., 6.]], grad_fn=<AddBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"PuQ7xDmu0Wpj","executionInfo":{"status":"ok","timestamp":1603365180838,"user_tz":-540,"elapsed":9366,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ee49bf56-b7cb-4b6f-bb71-c5411b11cef0","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(y.grad_fn)"],"execution_count":44,"outputs":[{"output_type":"stream","text":["<AddBackward0 object at 0x7f28fc3afd30>\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6_2iM-Zq0ZdG","executionInfo":{"status":"ok","timestamp":1603365180839,"user_tz":-540,"elapsed":9054,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"5d7c1134-a8a0-440a-944b-6a4203ec9605","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["z = y * y * 2\n","out = z.mean()\n","\n","print(z, out)"],"execution_count":45,"outputs":[{"output_type":"stream","text":["tensor([[72., 72., 72.],\n","        [72., 72., 72.],\n","        [72., 72., 72.]], grad_fn=<MulBackward0>) tensor(72., grad_fn=<MeanBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"2aZ8SWn_0nqt"},"source":["- `requires_grad_(...)`는 기존 텐서의 `requires_grad`값을 바꿔치기(`in-place`)하여 변경"]},{"cell_type":"code","metadata":{"id":"mHGROgrM0ebO","executionInfo":{"status":"ok","timestamp":1603365180839,"user_tz":-540,"elapsed":8279,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"3026ae8e-b3f3-4d09-ce41-0440225165ba","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["a = torch.randn(3,3)\n","a = ((a * 3) / (a -1))\n","print(a.requires_grad)\n","\n","a.requires_grad_(True)\n","print(a.requires_grad)\n","\n","b = (a*a).sum()\n","print(b.grad_fn)"],"execution_count":46,"outputs":[{"output_type":"stream","text":["False\n","True\n","<SumBackward0 object at 0x7f28fc2ff2b0>\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"KiEn_stZ1VgU"},"source":["### 기울기(Gradient)\n","- 역전파: `.backward()`를 통해 역전파 계산 가능"]},{"cell_type":"code","metadata":{"id":"1tdoN9p-1kn4","executionInfo":{"status":"ok","timestamp":1603365180840,"user_tz":-540,"elapsed":7652,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["out.backward()"],"execution_count":47,"outputs":[]},{"cell_type":"code","metadata":{"id":"CixGTXbV1B9p","executionInfo":{"status":"ok","timestamp":1603365180840,"user_tz":-540,"elapsed":7325,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"9a7db506-cfc1-4a0c-af64-ef21afc19cd9","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["print(x.grad)"],"execution_count":48,"outputs":[{"output_type":"stream","text":["tensor([[2.6667, 2.6667, 2.6667],\n","        [2.6667, 2.6667, 2.6667],\n","        [2.6667, 2.6667, 2.6667]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"SY63Mcc-1iNI","executionInfo":{"status":"ok","timestamp":1603365180840,"user_tz":-540,"elapsed":7018,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"627f38af-8406-4ba5-d4cb-480a34a1fa74","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["x = torch.randn(3, requires_grad=True)\n","\n","y = x * 2\n","while y.data.norm() <1000:\n","  y = y*2\n","\n","print(y)"],"execution_count":49,"outputs":[{"output_type":"stream","text":["tensor([1548.9619,  133.0661, -181.3449], grad_fn=<MulBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"YPaVAbIT3gx_","executionInfo":{"status":"ok","timestamp":1603365180841,"user_tz":-540,"elapsed":6729,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"dd640047-19e3-464d-8952-15a444189bf3","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["v = torch.tensor([0.1, 1.0, 0.0001], dtype=torch.float)\n","y.backward(v)\n","\n","print(x.grad)"],"execution_count":50,"outputs":[{"output_type":"stream","text":["tensor([1.0240e+02, 1.0240e+03, 1.0240e-01])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"0b9amArPXtcX"},"source":["- `with torch.no_grad()`를 사용하여 gradient의 업데이트를 하지 않음"]},{"cell_type":"code","metadata":{"id":"weeIe5_Z3jVe","executionInfo":{"status":"ok","timestamp":1603365180841,"user_tz":-540,"elapsed":6116,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"277d8198-76a1-4b34-bca9-e4c63e18480e","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["print(x.requires_grad)\n","print((x**2).requires_grad)\n","\n","with torch.no_grad():\n","  print((x**2).requires_grad)"],"execution_count":51,"outputs":[{"output_type":"stream","text":["True\n","True\n","False\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"bLcTLVRSmCdH"},"source":["- `detach()`: 내용물(content)은 같지만 require_grad가 다른 새로운 Tensor를 가져올 때"]},{"cell_type":"code","metadata":{"id":"ALcth7Ew3l7H","executionInfo":{"status":"ok","timestamp":1603365180841,"user_tz":-540,"elapsed":5490,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"88a5e4ab-9aea-4895-90e6-0efe4e20dc71","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["print(x.requires_grad)\n","y = x.detach()\n","print(y.requires_grad)\n","print(x.eq(y).all())"],"execution_count":52,"outputs":[{"output_type":"stream","text":["True\n","False\n","tensor(True)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NSarysrqBh9D"},"source":["### 자동 미분 흐름 다시 보기(1)\n","- 계산 흐름  \n","  $a \\rightarrow b  \\rightarrow c  \\rightarrow out $\n","\n","<br>\n","\n","## $\\quad \\frac{\\partial out}{\\partial a} = ?$\n","- `backward()`를 통해  \n","  $a \\leftarrow b  \\leftarrow c  \\leftarrow out $을 계산하면  \n","    $\\frac{\\partial out}{\\partial a}$값이 `a.grad`에 채워짐\n"]},{"cell_type":"code","metadata":{"id":"NUAc1etP3oBc","executionInfo":{"status":"ok","timestamp":1603365180841,"user_tz":-540,"elapsed":4823,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch"],"execution_count":53,"outputs":[]},{"cell_type":"code","metadata":{"id":"tCW7dq9uB89T","executionInfo":{"status":"ok","timestamp":1603365180842,"user_tz":-540,"elapsed":4551,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"70cd7579-0186-4e81-bcc7-8281878d2c92","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["a  = torch.ones(2,2)\n","print(a)"],"execution_count":54,"outputs":[{"output_type":"stream","text":["tensor([[1., 1.],\n","        [1., 1.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"-AyyGy49FLz9","executionInfo":{"status":"ok","timestamp":1603365180842,"user_tz":-540,"elapsed":4228,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"fdd3d108-b591-492d-a29a-fb9f1763582f","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["a = torch.ones(2,2, requires_grad=True)\n","print(a)"],"execution_count":55,"outputs":[{"output_type":"stream","text":["tensor([[1., 1.],\n","        [1., 1.]], requires_grad=True)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"SmmJa-hvFPGH","executionInfo":{"status":"ok","timestamp":1603365180843,"user_tz":-540,"elapsed":3903,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"80f27b1a-1afe-4c7e-f64d-8a6e87ee93ca","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["print(\"a.data:\", a.data)\n","print(\"a.grad\", a.grad)\n","print(\"a.grad_fn\", a.grad_fn)"],"execution_count":56,"outputs":[{"output_type":"stream","text":["a.data: tensor([[1., 1.],\n","        [1., 1.]])\n","a.grad None\n","a.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"BCwhTsiHGCmG"},"source":["- $b = a + 2$"]},{"cell_type":"code","metadata":{"id":"iUPt042iF9V1","executionInfo":{"status":"ok","timestamp":1603365180843,"user_tz":-540,"elapsed":3196,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"a28412c5-71b3-434c-8114-16d1f14b5d2c","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["b = a + 2\n","print(b)"],"execution_count":57,"outputs":[{"output_type":"stream","text":["tensor([[3., 3.],\n","        [3., 3.]], grad_fn=<AddBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6cw2zoq9GHLF"},"source":["- $c = b^2$ "]},{"cell_type":"code","metadata":{"id":"FRDS6gP0GFZG","executionInfo":{"status":"ok","timestamp":1603365180844,"user_tz":-540,"elapsed":2530,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"51077d15-9b88-498a-afe0-594b6a5e4a1b","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["c = b**2\n","print(c)"],"execution_count":58,"outputs":[{"output_type":"stream","text":["tensor([[9., 9.],\n","        [9., 9.]], grad_fn=<PowBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"VynoiUywGSwh","executionInfo":{"status":"ok","timestamp":1603365180844,"user_tz":-540,"elapsed":2197,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ab9797a4-7c15-4910-d4da-3877605fe82a","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["out = c.sum()\n","print(out)"],"execution_count":59,"outputs":[{"output_type":"stream","text":["tensor(36., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"v3ryJon9GeMn","executionInfo":{"status":"ok","timestamp":1603365180845,"user_tz":-540,"elapsed":1875,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"188e7314-24b2-4cea-829a-140c4376f573","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(out)\n","out.backward()"],"execution_count":60,"outputs":[{"output_type":"stream","text":["tensor(36., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"f0aoNsPDHsoG"},"source":["- a의 `grad_fn`이 None인 이유  \n","  직접적으로 계산한 부분이 없었기 때문"]},{"cell_type":"code","metadata":{"id":"bccI4vIWGgqj","executionInfo":{"status":"ok","timestamp":1603365180845,"user_tz":-540,"elapsed":1116,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"c83c6d83-fc08-45d5-a457-1c071026d1f0","colab":{"base_uri":"https://localhost:8080/","height":102}},"source":["print(\"a.data:\", a.data)\n","print(\"a.grad\", a.grad)\n","print(\"a.grad_fn\", a.grad_fn)"],"execution_count":61,"outputs":[{"output_type":"stream","text":["a.data: tensor([[1., 1.],\n","        [1., 1.]])\n","a.grad tensor([[6., 6.],\n","        [6., 6.]])\n","a.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"oka1mkadHq-N","executionInfo":{"status":"ok","timestamp":1603365180845,"user_tz":-540,"elapsed":743,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8080a744-391a-4be7-91db-0ba188794241","colab":{"base_uri":"https://localhost:8080/","height":139}},"source":["print(\"b.data:\", b.data)\n","print(\"b.grad\", b.grad)\n","print(\"b.grad_fn\", b.grad_fn)"],"execution_count":62,"outputs":[{"output_type":"stream","text":["b.data: tensor([[3., 3.],\n","        [3., 3.]])\n","b.grad None\n","b.grad_fn <AddBackward0 object at 0x7f28fc2ffa20>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"ZiYNajdLccUF","executionInfo":{"status":"ok","timestamp":1603365187113,"user_tz":-540,"elapsed":753,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ae130f8b-d67a-469b-caa3-71c4041cbfc4","colab":{"base_uri":"https://localhost:8080/","height":139}},"source":["print(\"c.data:\", c.data)\n","print(\"c.grad\", c.grad)\n","print(\"c.grad_fn\", c.grad_fn)"],"execution_count":63,"outputs":[{"output_type":"stream","text":["c.data: tensor([[9., 9.],\n","        [9., 9.]])\n","c.grad None\n","c.grad_fn <PowBackward0 object at 0x7f28fc2ff358>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"BcLoMYite0vU","executionInfo":{"status":"ok","timestamp":1603365187632,"user_tz":-540,"elapsed":946,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"cd9121c1-e5ba-4ee5-91da-253d98264c37","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["print(\"out.data:\", out.data)\n","print(\"out.grad\", out.grad)\n","print(\"out.grad_fn\", out.grad_fn)"],"execution_count":64,"outputs":[{"output_type":"stream","text":["out.data: tensor(36.)\n","out.grad None\n","out.grad_fn <SumBackward0 object at 0x7f28fc2ff358>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"qZXgwviHfovj"},"source":["### 자동 미분 흐름 다시 보기(2)\n","- `grad`값을 넣어서 `backward`\n","\n","- 아래의 코드에서 `.grad`값이 None은 gradient값이 필요하지 않기 때문"]},{"cell_type":"code","metadata":{"id":"bB6DCYXRfcI_","executionInfo":{"status":"ok","timestamp":1603365188691,"user_tz":-540,"elapsed":1396,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"f583bc78-d308-4b69-eeac-5fc6eda27113","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["x = torch.ones(3, requires_grad=True)\n","y = (x**2)\n","z = y**2 + x\n","out = z.sum()\n","print(out)"],"execution_count":65,"outputs":[{"output_type":"stream","text":["tensor(6., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"AVo-glm8fvFv","executionInfo":{"status":"ok","timestamp":1603365188691,"user_tz":-540,"elapsed":1062,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["grad = torch.Tensor([0.1, 1,  100])\n","z.backward(grad)"],"execution_count":66,"outputs":[]},{"cell_type":"code","metadata":{"id":"tdBklrepf2qq","executionInfo":{"status":"ok","timestamp":1603365189179,"user_tz":-540,"elapsed":1195,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8b357b85-8e3e-496d-ba0b-7e470f600ded","colab":{"base_uri":"https://localhost:8080/","height":68}},"source":["print(\"x.data:\", x.data)\n","print(\"x.grad\", x.grad)\n","print(\"x.grad_fn\", x.grad_fn)"],"execution_count":67,"outputs":[{"output_type":"stream","text":["x.data: tensor([1., 1., 1.])\n","x.grad tensor([  0.5000,   5.0000, 500.0000])\n","x.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"HQvUGlfRf7jU","executionInfo":{"status":"ok","timestamp":1603365189599,"user_tz":-540,"elapsed":1272,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"cf2e7538-c6c9-4231-dc5b-743aefcfd966","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["print(\"y.data:\", y.data)\n","print(\"y.grad\", y.grad)\n","print(\"y.grad_fn\", y.grad_fn)"],"execution_count":68,"outputs":[{"output_type":"stream","text":["y.data: tensor([1., 1., 1.])\n","y.grad None\n","y.grad_fn <PowBackward0 object at 0x7f28fc3afef0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"h7TFHdMfgxvW","executionInfo":{"status":"ok","timestamp":1603365189600,"user_tz":-540,"elapsed":998,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"d04e165f-af80-414f-b85b-f9a5363a9aa0","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["print(\"z.data:\", z.data)\n","print(\"z.grad\", z.grad)\n","print(\"z.grad_fn\", z.grad_fn)"],"execution_count":69,"outputs":[{"output_type":"stream","text":["z.data: tensor([2., 2., 2.])\n","z.grad None\n","z.grad_fn <AddBackward0 object at 0x7f28fc3af7f0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"DKv-osmNmWiA"},"source":["## nn & nn.functional\n","\n","- 두 패키지가 같은 기능이지만 방식이 조금 다름\n","\n","- 위의 `autograd` 관련 작업들을 두 패키지를 통해 진행할 수 있음\n","\n","- 텐서를 직접 다룰 때 `requires_grad`와 같은 방식으로 진행할 수 있음\n","\n","- 결론적으로, `torch.nn`은 attribute를 활용해 state를 저장하고 활용하고,  \n","  `torch.nn.functional`로 구현한 함수의 경우에는 인스턴스화 시킬 필요 없이 사용이 가능\n"," \n"]},{"cell_type":"markdown","metadata":{"id":"jk8fkKq3nWP1"},"source":["### nn 패키지\n","\n","- 주로 가중치(weights), 편향(bias)값들이 내부에서 자동으로 생성되는 레이어들을 사용할 때  \n","  - 따라서, `weight`값들을 직접 선언 안함\n","\n","- 예시\n","  - Containers\n","\n","  - Convolution Layers\n","\n","  - Pooling layers\n","\n","  - Padding Layers\n","\n","  - Non-linear Activations (weighted sum, nonlinearity)\n","\n","  - Non-linear Activations (other)\n","\n","  - Normalization Layers\n","\n","  - Recurrent Layers\n","\n","  - Transformer Layers\n","\n","  - Linear Layers\n","\n","  - Dropout Layers\n","\n","  - Sparse Layers\n","\n","  - Distance Functions\n","\n","  - Loss Functions\n","\n","  - ..\n","- https://pytorch.org/docs/stable/nn.html\n","\n"]},{"cell_type":"code","metadata":{"id":"8tEtWHAsmZMy","executionInfo":{"status":"ok","timestamp":1603365190682,"user_tz":-540,"elapsed":1165,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","import torch.nn as nn"],"execution_count":70,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NcjCbeEQqPSI"},"source":["- Convolution Layer 예시 (1)\n"]},{"cell_type":"code","metadata":{"id":"NQ7Y0tCOpkhM","executionInfo":{"status":"ok","timestamp":1603365191232,"user_tz":-540,"elapsed":926,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"a211e661-f9ca-460b-abc0-cb88c30b78c0","colab":{"base_uri":"https://localhost:8080/","height":1000}},"source":["m = nn.Conv2d(16, 33, 3, stride=2)\n","\n","m = nn.Conv2d(16, 33, (3,5), stride=(2,1), padding=(4,2))\n","\n","m = nn.Conv2d(16, 33, (3,5), stride=(2,1), padding=(4,2), dilation=(3,1))\n","\n","input = torch.randn(20, 16, 50, 100)\n","print(input)\n","output = m(input)\n","print(output)"],"execution_count":71,"outputs":[{"output_type":"stream","text":["tensor([[[[-1.1389e+00, -4.2023e-01, -1.3919e+00,  ...,  8.2125e-01,\n","           -2.1498e+00, -8.9554e-01],\n","          [ 6.4910e-01,  1.8785e+00,  7.5144e-01,  ...,  2.6952e+00,\n","            9.3599e-01, -3.6536e-01],\n","          [ 4.2818e-02, -1.0283e+00,  1.4949e+00,  ..., -7.0724e-01,\n","            1.6821e-01,  1.1752e+00],\n","          ...,\n","          [-1.0043e-01, -1.0591e+00, -1.0688e+00,  ..., -1.0545e+00,\n","           -9.5115e-01,  1.9302e-01],\n","          [ 2.3264e+00,  1.3540e-01,  9.1818e-01,  ...,  2.0992e-01,\n","           -1.4465e+00, -1.1123e+00],\n","          [ 7.0437e-01,  1.2351e+00,  4.2948e-01,  ..., -4.2993e-01,\n","            3.8181e-01,  7.5080e-01]],\n","\n","         [[ 6.0888e-02,  8.3482e-02, -1.0653e+00,  ..., -6.3745e-01,\n","           -1.2989e+00, -1.4107e+00],\n","          [-8.0529e-01, -2.1195e+00, -9.2021e-01,  ..., -7.0989e-01,\n","           -7.6137e-01,  1.6613e+00],\n","          [-2.5351e+00, -1.9252e-01,  3.7754e-01,  ...,  6.1120e-01,\n","            6.3824e-01,  1.7030e+00],\n","          ...,\n","          [ 9.4840e-01,  2.8748e-01, -6.0038e-01,  ...,  1.3970e+00,\n","           -1.2728e+00, -2.2149e-01],\n","          [-1.1306e+00,  3.8898e-01, -4.6990e-01,  ..., -1.4882e+00,\n","            1.4440e+00,  4.4634e-01],\n","          [ 5.8950e-01,  7.6343e-01,  6.0414e-01,  ..., -5.7863e-01,\n","           -7.8890e-01, -6.7225e-01]],\n","\n","         [[-5.1688e-01, -1.0208e+00,  3.1767e-01,  ..., -3.2458e-01,\n","            1.2037e-01,  5.2584e-01],\n","          [-3.9539e-01,  7.1720e-01, -9.4680e-01,  ...,  6.3537e-01,\n","           -1.2242e+00,  1.7965e-01],\n","          [ 1.1125e+00, -1.5593e-01, -1.5689e-01,  ..., -5.1098e-01,\n","           -5.1693e-01,  3.1392e-01],\n","          ...,\n","          [-3.8624e-01,  6.3144e-01, -2.0443e-02,  ...,  5.1192e-01,\n","            7.0745e-01, -3.7193e-01],\n","          [ 4.7688e-01, -1.7561e-01,  2.2292e-01,  ...,  4.5517e-01,\n","            2.5342e-02,  1.1613e+00],\n","          [-1.2485e+00, -3.2924e-01, -1.1091e-01,  ..., -1.2634e+00,\n","            8.2178e-01,  5.1737e-01]],\n","\n","         ...,\n","\n","         [[ 1.7287e+00, -6.4800e-01,  4.1338e-01,  ..., -1.7198e+00,\n","           -1.2192e+00,  6.9071e-01],\n","          [ 1.1813e+00, -1.0491e+00, -1.6049e-01,  ..., -3.5048e-01,\n","            3.8510e-01, -7.0764e-01],\n","          [-5.3596e-01,  2.1804e+00, -7.1584e-01,  ..., -3.4321e-01,\n","           -4.9616e-02, -3.7708e-01],\n","          ...,\n","          [ 3.1835e-01,  1.0550e+00,  2.4466e-01,  ...,  5.5399e-01,\n","           -8.1270e-01, -5.2010e-01],\n","          [-5.0378e-01,  7.1526e-01,  4.0166e-01,  ..., -7.4424e-01,\n","           -1.4433e-01,  5.2429e-01],\n","          [-9.7550e-01, -4.8236e-02,  2.0788e+00,  ...,  1.4845e+00,\n","            1.2025e-01,  5.8038e-01]],\n","\n","         [[-2.1777e-01, -8.6378e-01,  1.4514e+00,  ..., -1.4870e+00,\n","            1.0593e+00, -8.3536e-01],\n","          [-3.7374e-01, -4.0505e-01, -1.4763e-01,  ..., -2.5596e-01,\n","            1.4997e+00,  1.9757e+00],\n","          [-9.2958e-01, -7.2839e-01, -7.6522e-02,  ..., -5.8856e-01,\n","            1.5097e+00,  5.4555e-01],\n","          ...,\n","          [-1.1006e+00, -3.1455e-01, -1.0602e-01,  ..., -1.0834e+00,\n","           -3.5943e-01,  1.0514e+00],\n","          [ 1.2537e+00, -2.1544e+00, -1.2811e+00,  ...,  1.4055e+00,\n","           -8.0019e-02, -6.4536e-01],\n","          [ 1.7734e+00, -8.3550e-02, -3.6107e-01,  ..., -9.7026e-01,\n","           -3.9320e-01,  4.1114e-01]],\n","\n","         [[-5.4305e-01, -1.7615e-01,  5.0547e-01,  ..., -8.8427e-02,\n","           -1.2118e+00, -1.7467e+00],\n","          [ 8.3380e-01,  1.3512e-01,  2.1972e-01,  ..., -1.0750e+00,\n","            8.2756e-01, -1.3250e+00],\n","          [-2.3517e-01, -7.8462e-01, -1.9805e+00,  ..., -1.0851e+00,\n","           -6.6131e-01, -2.8656e-01],\n","          ...,\n","          [-2.6435e+00,  1.9202e-01,  1.7157e-01,  ...,  3.4921e-01,\n","            6.0337e-01, -1.2475e+00],\n","          [ 1.3497e-01,  1.3392e+00,  6.1319e-01,  ..., -2.7718e-02,\n","            6.0811e-01, -1.1765e+00],\n","          [ 1.4083e+00, -1.4340e+00,  1.6116e-01,  ..., -3.2707e+00,\n","           -5.4753e-02,  6.3553e-01]]],\n","\n","\n","        [[[-1.3954e+00, -2.3848e-01,  2.2810e+00,  ..., -9.0238e-01,\n","           -9.7368e-02, -1.9672e-01],\n","          [-8.8941e-01, -1.3939e+00, -5.2663e-02,  ...,  3.4390e-01,\n","           -1.2132e-01,  2.2796e+00],\n","          [ 2.0466e+00,  8.8454e-01,  1.1892e+00,  ...,  1.7162e-02,\n","            4.3584e-01,  3.9241e-01],\n","          ...,\n","          [-4.7647e-01, -1.2147e+00, -7.0885e-01,  ...,  1.0532e+00,\n","           -2.3470e-01,  7.5807e-01],\n","          [ 1.8319e+00, -5.8020e-02,  1.2274e+00,  ..., -1.0244e+00,\n","            1.0693e+00,  3.0559e-01],\n","          [ 1.0874e+00,  1.4435e+00, -1.1822e+00,  ...,  8.1600e-01,\n","           -1.2168e+00,  9.2575e-02]],\n","\n","         [[ 5.5018e-01, -9.7457e-01,  2.6459e-01,  ..., -3.8115e-01,\n","            1.0039e+00,  6.9002e-01],\n","          [-5.4980e-01,  2.0099e+00,  5.5714e-01,  ..., -1.2375e+00,\n","            1.0436e+00, -1.5954e+00],\n","          [-6.3784e-01, -2.9739e-01,  1.1112e+00,  ..., -2.8773e-01,\n","            1.5897e+00, -6.2731e-01],\n","          ...,\n","          [-1.0207e-01,  2.2516e-01,  3.9352e-01,  ...,  1.1169e-01,\n","           -1.4603e+00, -3.5501e-01],\n","          [-2.0004e-02,  2.2942e-01,  3.8940e-01,  ...,  1.2494e+00,\n","            1.6527e+00, -1.1668e-01],\n","          [ 7.5792e-02, -2.0386e-01, -1.5978e-01,  ...,  1.0815e+00,\n","           -4.7480e-01,  3.0787e-01]],\n","\n","         [[-1.2309e-01,  2.7299e-01, -5.0588e-01,  ..., -1.9407e-02,\n","           -5.0831e-01,  2.3468e+00],\n","          [-6.7512e-01,  1.1128e+00,  6.7624e-01,  ..., -2.0389e+00,\n","           -7.1383e-01,  9.5000e-01],\n","          [ 9.0516e-01,  1.0101e+00, -9.3273e-01,  ...,  5.4853e-01,\n","            2.7935e-01,  1.7993e+00],\n","          ...,\n","          [ 1.5193e+00,  1.7563e+00, -4.3763e-03,  ..., -2.5950e+00,\n","            2.0471e+00,  1.7102e+00],\n","          [-8.3945e-01, -1.1226e+00, -9.8253e-01,  ...,  9.9450e-01,\n","            4.8973e-01,  3.8995e-01],\n","          [-1.9673e+00,  1.6667e+00,  5.2788e-01,  ..., -4.4161e-01,\n","           -8.0673e-01,  3.5165e-01]],\n","\n","         ...,\n","\n","         [[ 1.2678e-01, -6.4002e-01,  1.2168e+00,  ..., -6.5733e-02,\n","            1.4013e+00, -8.8155e-01],\n","          [ 1.3099e+00,  1.9378e-01,  8.3573e-01,  ...,  4.4628e-01,\n","           -2.1585e+00, -6.1528e-01],\n","          [-6.0361e-01, -3.4430e-01, -6.1295e-03,  ...,  8.8725e-01,\n","            2.5357e+00,  9.2180e-01],\n","          ...,\n","          [ 1.2044e+00,  4.7521e-01, -1.2478e+00,  ...,  1.2702e+00,\n","            3.2278e-01,  1.7033e+00],\n","          [ 3.6239e-01, -9.4920e-01,  2.7981e-01,  ...,  1.7221e+00,\n","            1.4353e+00,  8.6927e-01],\n","          [ 9.7083e-01, -5.4671e-01,  1.2580e+00,  ..., -1.1542e+00,\n","           -1.5416e+00, -2.6523e-01]],\n","\n","         [[-1.0268e+00, -7.6001e-02,  8.6923e-01,  ...,  1.8254e+00,\n","           -1.0803e+00, -4.9744e-01],\n","          [-6.4636e-01, -1.2142e+00,  2.7986e-02,  ...,  9.2274e-01,\n","           -1.5537e+00, -1.4956e-01],\n","          [ 5.5078e-01,  1.9199e+00,  1.7945e-01,  ..., -7.3107e-01,\n","           -1.6776e-01,  6.2012e-01],\n","          ...,\n","          [-1.5791e+00,  1.4114e+00, -2.3116e-01,  ...,  6.7469e-01,\n","            8.2876e-01, -2.1073e+00],\n","          [-1.8030e-01,  5.5345e-01, -3.9548e-01,  ...,  8.3440e-01,\n","            1.9052e+00, -1.2780e-01],\n","          [-6.0917e-01,  3.0555e-01,  1.1893e+00,  ...,  4.1511e-01,\n","           -5.2207e-01,  1.3091e-01]],\n","\n","         [[ 2.0826e-01, -3.8411e-01,  3.3991e-01,  ..., -3.7461e-02,\n","            6.4959e-01, -8.0031e-01],\n","          [-7.2888e-01, -1.1497e-01, -5.8212e-01,  ..., -3.5057e-01,\n","            1.7927e+00, -1.1772e-01],\n","          [ 4.4966e-01,  9.5732e-01, -2.4127e-01,  ...,  5.6168e-01,\n","            1.8474e+00,  8.7915e-02],\n","          ...,\n","          [-1.3947e-01, -1.0918e+00,  6.7805e-01,  ...,  3.4646e-03,\n","           -1.2901e+00, -1.5120e+00],\n","          [-7.7656e-01,  5.0929e-01, -1.6818e-01,  ...,  9.7876e-02,\n","           -1.0385e+00,  2.7188e-01],\n","          [ 3.4816e-01,  1.1621e+00,  1.2842e+00,  ..., -2.2205e+00,\n","            1.6684e+00, -2.8992e-01]]],\n","\n","\n","        [[[-1.5674e+00, -1.2824e+00,  6.6375e-01,  ...,  4.4928e-01,\n","           -3.2750e-01,  1.8151e-01],\n","          [ 3.9672e-01,  1.2149e+00, -4.0705e-01,  ..., -1.6795e+00,\n","            3.6926e-02,  2.1004e+00],\n","          [ 2.3677e-01,  8.3887e-01, -1.0864e+00,  ..., -2.6163e+00,\n","           -3.8849e-01, -1.1539e+00],\n","          ...,\n","          [ 1.1212e+00,  1.1833e+00,  2.0506e-01,  ...,  1.8134e+00,\n","            4.9628e-01, -8.7226e-01],\n","          [-7.9041e-01, -1.6666e+00,  1.0069e-01,  ...,  8.2271e-01,\n","           -2.3835e-01, -1.0294e-02],\n","          [ 1.1518e+00, -1.7003e-01, -4.4005e-01,  ...,  2.8268e-01,\n","           -4.0416e-01,  1.9480e-01]],\n","\n","         [[ 1.4376e+00,  1.2757e+00,  1.0791e+00,  ..., -1.2653e+00,\n","            2.0842e-01,  1.7152e+00],\n","          [ 1.5868e-02, -1.7382e-01, -5.4351e-01,  ..., -1.1921e+00,\n","            1.2698e+00, -6.7244e-01],\n","          [-6.8736e-01,  1.2611e+00, -4.4853e-01,  ...,  4.3854e-01,\n","           -9.3453e-01, -7.1305e-01],\n","          ...,\n","          [-1.8440e-01, -1.4772e+00,  3.8721e-01,  ..., -1.2179e-01,\n","            7.6417e-01, -5.1893e-01],\n","          [ 1.5106e-01,  4.3022e-01, -1.5040e+00,  ...,  1.8926e+00,\n","           -1.2508e+00, -3.0510e+00],\n","          [ 5.4651e-01,  1.2565e+00,  2.8221e-01,  ...,  9.9631e-01,\n","           -1.2434e+00,  5.6975e-01]],\n","\n","         [[-2.7453e-01, -7.1383e-01,  6.5054e-01,  ...,  4.7190e-01,\n","           -3.4741e-01, -1.0354e-01],\n","          [-3.5935e-01, -1.8101e-01, -1.9357e+00,  ...,  2.0765e-01,\n","           -9.9611e-01, -1.8467e+00],\n","          [-6.6517e-01, -3.5243e-01,  6.4005e-01,  ..., -6.5938e-01,\n","           -1.0259e+00,  7.1548e-01],\n","          ...,\n","          [-1.5625e-02,  2.6817e-02,  6.8033e-01,  ...,  9.4788e-01,\n","           -2.0847e+00, -8.0278e-01],\n","          [-8.8748e-02,  1.5558e+00,  2.1488e-01,  ...,  7.9308e-01,\n","           -1.4923e+00,  8.5963e-02],\n","          [-1.0736e+00, -2.1289e+00,  1.1153e+00,  ...,  1.2537e+00,\n","            1.2751e+00, -1.7479e-01]],\n","\n","         ...,\n","\n","         [[-2.0035e+00, -1.6803e+00,  8.9148e-01,  ..., -6.9082e-01,\n","           -1.4132e+00,  6.2444e-01],\n","          [ 6.4198e-01,  8.6272e-01, -2.2515e-01,  ..., -1.2425e+00,\n","           -4.5828e-01, -2.0709e+00],\n","          [-6.5039e-02, -1.5061e+00,  1.8689e+00,  ...,  1.3360e+00,\n","           -6.5203e-01, -6.1367e-01],\n","          ...,\n","          [ 1.9145e-02,  1.1110e+00, -1.4922e+00,  ...,  7.9875e-01,\n","           -1.6615e-01,  1.3521e+00],\n","          [-9.1827e-01, -1.2996e-01,  2.0567e-01,  ...,  2.4953e+00,\n","            1.4245e+00,  1.7717e+00],\n","          [-1.4295e+00,  6.1026e-01, -1.7159e+00,  ..., -5.1267e-01,\n","            4.4586e-01, -1.1114e+00]],\n","\n","         [[ 7.9710e-01,  1.1951e+00, -7.4683e-01,  ..., -1.1862e+00,\n","           -7.2369e-01, -2.2688e-01],\n","          [ 1.6955e-01,  4.5548e-01,  9.7442e-01,  ...,  7.9367e-01,\n","            6.9806e-01,  1.8757e+00],\n","          [-1.5406e+00,  5.6132e-01,  7.9960e-01,  ..., -2.9743e+00,\n","            1.0122e+00, -2.1856e+00],\n","          ...,\n","          [-1.1199e+00,  3.0745e-02, -2.1739e+00,  ..., -1.4216e+00,\n","           -2.4376e-02, -1.4422e+00],\n","          [-1.6205e+00,  4.2367e-01, -9.9366e-01,  ..., -1.4456e-01,\n","            3.2750e-01,  6.2601e-01],\n","          [ 5.7910e-01,  1.0059e+00, -7.8953e-01,  ..., -1.8699e+00,\n","            9.0031e-01,  2.4646e-01]],\n","\n","         [[ 6.5172e-01, -1.8051e-03,  2.2517e-01,  ...,  7.2553e-01,\n","           -1.4593e+00, -5.0572e-01],\n","          [ 1.2607e+00,  1.6031e+00,  5.3921e-01,  ...,  6.0991e-01,\n","            9.6319e-01,  5.4998e-01],\n","          [-1.2602e+00, -7.3712e-01, -5.1524e-01,  ...,  1.3860e+00,\n","           -7.7450e-02, -1.3097e+00],\n","          ...,\n","          [ 6.6475e-01,  4.0099e-01, -5.7060e-01,  ...,  3.9147e-02,\n","            1.2035e+00,  3.8933e-01],\n","          [-1.0147e+00,  2.0337e-01, -5.2823e-01,  ...,  1.8118e-01,\n","            5.1847e-01,  7.7437e-01],\n","          [ 1.0252e-01, -6.7920e-01, -2.0326e-01,  ..., -1.1692e+00,\n","            1.4122e-01,  4.4622e-01]]],\n","\n","\n","        ...,\n","\n","\n","        [[[-1.6851e-01,  1.5316e+00,  1.5552e+00,  ..., -1.8564e+00,\n","            7.7681e-01, -1.0648e+00],\n","          [-7.7113e-01,  2.6840e+00,  8.0268e-01,  ..., -8.5127e-01,\n","            7.2186e-01,  7.6293e-01],\n","          [-1.9367e+00, -4.3461e-01,  8.4052e-01,  ..., -1.1007e+00,\n","            1.5673e+00, -7.4572e-01],\n","          ...,\n","          [-2.7204e+00, -1.0616e-01, -8.4431e-01,  ...,  4.2346e-01,\n","           -6.4360e-01, -4.2269e-01],\n","          [ 1.2185e+00, -1.2638e+00,  2.1615e-01,  ..., -1.0223e+00,\n","            1.9337e+00,  6.5699e-01],\n","          [ 1.3893e+00, -1.1866e+00, -1.1316e+00,  ..., -1.8428e-02,\n","            1.0211e+00, -8.0637e-01]],\n","\n","         [[ 1.1330e+00,  1.4022e+00, -1.0633e-01,  ..., -9.1012e-01,\n","           -4.1263e-01, -4.6809e-01],\n","          [-1.5664e-01,  1.0962e+00,  3.0399e-01,  ...,  4.9326e-01,\n","           -1.1878e+00, -8.0338e-02],\n","          [ 1.3646e+00, -2.2963e-01,  8.7848e-01,  ...,  8.7175e-01,\n","           -3.0044e+00,  5.3811e-01],\n","          ...,\n","          [-1.1035e+00,  7.3528e-01, -5.9369e-01,  ...,  3.2619e-01,\n","            1.9203e+00,  1.2046e+00],\n","          [ 2.3812e-01, -2.6770e-01, -1.6697e+00,  ...,  1.2989e+00,\n","            1.7745e+00,  1.8147e-01],\n","          [-4.0943e-01, -2.5236e-01, -6.6233e-01,  ..., -2.4755e-01,\n","           -5.7465e-01, -5.5691e-02]],\n","\n","         [[-1.0753e+00, -1.2239e+00,  3.4323e-01,  ...,  1.5383e-01,\n","            5.4727e-01, -6.4347e-01],\n","          [ 1.6334e-01,  2.9364e-01,  2.2424e-01,  ...,  1.2514e-01,\n","           -5.8324e-01,  5.1703e-01],\n","          [-5.2830e-01, -2.6164e-01, -2.4232e-01,  ...,  7.9465e-01,\n","            9.2299e-01, -1.2498e+00],\n","          ...,\n","          [ 1.2863e+00, -5.4328e-01, -1.5074e-02,  ..., -4.1338e-01,\n","           -9.5339e-01, -2.4239e-01],\n","          [ 1.6296e+00,  1.4157e+00,  1.4307e+00,  ..., -1.4554e+00,\n","           -1.8090e+00,  3.3792e-01],\n","          [-4.9282e-01,  4.5293e-01, -5.3706e-01,  ..., -5.2905e-01,\n","            1.0393e-01,  2.0343e+00]],\n","\n","         ...,\n","\n","         [[ 1.2571e+00, -9.5283e-01, -1.8994e-01,  ..., -3.3202e-01,\n","           -1.0566e+00, -3.1862e-01],\n","          [ 9.1618e-02, -3.7942e-01,  1.7304e+00,  ..., -9.9381e-01,\n","           -1.7802e+00,  3.4639e-01],\n","          [-4.8843e-01,  1.1292e+00,  6.8760e-01,  ..., -1.4350e+00,\n","            1.9550e+00,  2.0580e+00],\n","          ...,\n","          [ 1.1910e+00,  7.6504e-01, -9.7447e-01,  ..., -1.4186e+00,\n","           -7.4500e-01,  2.1303e-01],\n","          [-5.2556e-01,  1.0766e+00, -5.9226e-01,  ..., -1.9817e+00,\n","           -2.1981e+00, -9.1881e-02],\n","          [ 4.5123e-01,  4.4163e-01, -3.1237e-02,  ...,  4.5778e-01,\n","           -3.7768e-02, -1.5291e-01]],\n","\n","         [[ 7.3809e-01, -1.4219e+00, -3.3094e-01,  ..., -1.0538e+00,\n","            2.7699e-01, -1.0078e+00],\n","          [-2.7039e+00,  2.5166e+00, -2.7288e-01,  ...,  6.9328e-01,\n","            4.1263e-01,  7.0160e-01],\n","          [ 1.0552e-01,  2.3016e-01,  7.0562e-02,  ..., -1.7050e-01,\n","           -1.2618e+00,  1.2368e+00],\n","          ...,\n","          [-7.9644e-01, -1.0357e+00,  1.6918e+00,  ..., -1.8694e+00,\n","           -1.1488e+00, -1.4710e-01],\n","          [ 1.9788e-01,  1.2248e+00,  3.0116e-01,  ...,  6.0353e-01,\n","            1.6101e+00,  4.4049e-01],\n","          [ 4.0491e-01, -4.5124e-01,  3.3889e-02,  ..., -4.8212e-01,\n","           -1.0461e+00,  7.7130e-01]],\n","\n","         [[ 6.2864e-01, -6.3330e-01,  4.3398e-01,  ...,  3.3361e-01,\n","           -6.2267e-01,  4.9283e-01],\n","          [-3.4289e-01, -6.1210e-01,  1.5045e-01,  ...,  1.8731e+00,\n","            2.0799e+00,  4.7437e-01],\n","          [ 9.3560e-01, -7.3320e-01, -1.4355e-01,  ...,  3.9154e-01,\n","            4.9004e-01, -1.7282e-02],\n","          ...,\n","          [ 1.1095e+00, -1.8317e-01, -7.8495e-01,  ...,  6.5568e-01,\n","           -8.8240e-01, -5.1591e-02],\n","          [-1.2164e+00,  3.2255e-01, -7.0140e-01,  ..., -2.1585e-01,\n","           -1.3965e+00, -5.8175e-02],\n","          [ 1.1751e+00, -1.0442e+00,  1.2140e+00,  ..., -1.9950e+00,\n","            6.8197e-01, -3.7340e-02]]],\n","\n","\n","        [[[ 4.7960e-01, -1.2568e+00, -1.1086e+00,  ...,  1.0413e+00,\n","           -6.3523e-01,  1.4765e-01],\n","          [-1.6128e-01,  2.7588e-01, -4.0277e-01,  ...,  6.2762e-01,\n","           -6.9368e-01, -4.1728e-01],\n","          [-5.4164e-01, -5.6205e-01, -1.0956e+00,  ...,  1.7314e-02,\n","           -7.7328e-01,  2.0748e+00],\n","          ...,\n","          [ 1.9649e+00, -4.5597e-01,  1.6542e+00,  ...,  7.0587e-01,\n","            2.9898e-02, -7.7464e-01],\n","          [-4.9966e-01,  1.1596e+00, -2.8293e-01,  ..., -1.1840e+00,\n","            2.7970e-01,  1.6881e+00],\n","          [ 1.5305e+00,  2.3397e+00,  2.9216e-01,  ...,  3.3215e-01,\n","           -3.0042e+00,  3.3078e-01]],\n","\n","         [[-8.9310e-01, -8.5488e-01,  1.6688e+00,  ..., -2.1232e-02,\n","           -6.1783e-01, -5.7513e-02],\n","          [-4.9650e-01,  9.1541e-01, -8.4946e-01,  ..., -1.1533e+00,\n","            5.6729e-02,  3.5819e-01],\n","          [ 9.2513e-01, -2.4876e-01,  9.5282e-02,  ...,  3.3847e-01,\n","           -2.1165e+00,  1.2535e-01],\n","          ...,\n","          [-1.8095e+00,  1.4602e+00,  1.3820e+00,  ...,  5.3332e-01,\n","           -2.8585e-01, -1.0245e+00],\n","          [ 8.9075e-01, -1.7178e+00, -6.1075e-01,  ...,  4.7401e-01,\n","           -1.1629e+00,  2.6250e-01],\n","          [-9.0571e-02,  1.0628e+00, -5.0068e-01,  ...,  9.0196e-01,\n","            1.2365e+00,  9.6336e-02]],\n","\n","         [[ 5.8590e-01,  1.7955e+00, -7.5000e-01,  ...,  2.6570e-02,\n","            1.2814e+00,  1.2366e+00],\n","          [ 5.0504e-01, -1.4103e+00,  2.3596e-01,  ...,  1.3151e+00,\n","            1.1507e+00, -2.3719e-01],\n","          [-2.2477e-01, -3.9417e-01,  4.6604e-01,  ..., -2.4362e-01,\n","            6.9285e-01, -1.6852e+00],\n","          ...,\n","          [-1.8814e-01, -1.5395e+00,  7.1881e-01,  ...,  1.1626e+00,\n","           -1.0841e+00, -1.6164e-01],\n","          [-1.3881e+00, -4.3610e-01,  5.6680e-02,  ...,  1.1498e+00,\n","            5.8600e-02, -1.5193e+00],\n","          [-3.7316e-01,  1.8457e-01, -1.8821e-01,  ...,  1.1236e+00,\n","           -5.0214e-01,  1.6869e+00]],\n","\n","         ...,\n","\n","         [[ 1.2634e+00, -2.1940e-01,  3.2097e-01,  ..., -2.6097e-01,\n","           -7.6104e-01,  1.6080e-01],\n","          [ 4.5655e-02,  4.3205e-01, -5.9907e-01,  ..., -1.5703e+00,\n","           -1.3281e+00, -4.8716e-01],\n","          [ 6.2562e-01, -2.4768e-01,  1.4941e+00,  ..., -9.6875e-01,\n","           -3.7405e-01, -1.3336e+00],\n","          ...,\n","          [-1.0267e+00, -1.4399e+00, -3.8632e-02,  ..., -2.1467e-01,\n","           -3.5512e-02,  1.0335e+00],\n","          [-1.4326e+00, -2.2431e-01,  1.5768e+00,  ...,  3.5244e-01,\n","           -1.7747e+00,  2.0077e-01],\n","          [ 2.1916e-01,  1.3442e+00, -2.5041e-01,  ...,  1.3987e+00,\n","           -7.0476e-01, -1.6563e+00]],\n","\n","         [[-3.1423e+00, -6.3649e-01,  4.5061e-01,  ..., -1.3856e+00,\n","           -1.6429e+00, -1.8832e-02],\n","          [ 5.5203e-01,  1.2458e+00,  4.9057e-01,  ...,  1.2352e+00,\n","            1.2027e+00, -9.1031e-01],\n","          [-1.8296e+00,  7.5161e-01, -2.3229e+00,  ..., -8.5800e-01,\n","            1.0238e+00,  1.3338e+00],\n","          ...,\n","          [ 5.9867e-01, -1.2487e+00,  1.5337e-01,  ...,  2.1774e-01,\n","           -5.2638e-01, -6.4635e-01],\n","          [-3.9366e-01, -1.5758e+00, -2.4000e+00,  ..., -5.3879e-01,\n","            5.7956e-01,  1.1776e+00],\n","          [-1.7604e+00,  3.1333e-01, -1.0653e+00,  ...,  2.2748e-01,\n","            7.3058e-01, -9.0273e-01]],\n","\n","         [[ 3.5138e+00, -6.7597e-01,  1.3415e+00,  ..., -1.0622e-01,\n","           -2.0565e+00, -9.0089e-02],\n","          [ 6.4101e-01, -7.3631e-01, -4.6848e-01,  ...,  6.8906e-01,\n","           -2.7356e-01,  1.0862e+00],\n","          [-2.9971e-01,  1.1027e+00, -5.9545e-01,  ..., -2.4058e-01,\n","            8.2294e-01, -2.8749e-01],\n","          ...,\n","          [-3.7589e-01, -1.8502e+00,  1.2841e+00,  ...,  1.0965e+00,\n","           -6.2376e-01, -1.2502e-01],\n","          [ 1.1660e+00,  1.1446e+00, -1.4249e+00,  ..., -1.0604e+00,\n","           -1.0822e-02, -9.2880e-01],\n","          [ 3.2333e-01,  8.3768e-01,  2.4322e-01,  ...,  1.2821e+00,\n","            2.0441e+00,  1.9936e+00]]],\n","\n","\n","        [[[-5.2318e-01, -1.8454e+00, -4.6156e-01,  ..., -1.5881e+00,\n","           -6.7261e-01,  1.1350e-01],\n","          [ 4.1875e-01, -1.1149e+00,  1.1878e+00,  ...,  1.4862e-01,\n","           -2.6990e-01,  6.2924e-01],\n","          [-4.7000e-01,  3.9590e-01, -1.0924e+00,  ...,  5.1914e-01,\n","            5.8791e-01, -8.7792e-02],\n","          ...,\n","          [ 1.3825e+00, -8.2437e-01, -8.8387e-01,  ..., -2.9226e-01,\n","            8.2656e-02, -1.9097e+00],\n","          [ 1.2106e+00, -6.1013e-01,  1.9272e+00,  ...,  7.9325e-01,\n","            7.1271e-01,  4.9850e-01],\n","          [ 4.7237e-01,  2.5649e+00, -1.2130e+00,  ..., -7.6270e-01,\n","           -1.4650e+00, -5.7909e-01]],\n","\n","         [[ 6.7674e-01,  1.9087e+00, -1.4956e-01,  ..., -1.3875e+00,\n","            7.7415e-01, -4.4088e-01],\n","          [ 6.7187e-01, -2.0553e+00,  1.1901e-01,  ..., -1.7298e+00,\n","            1.7078e+00,  4.1847e-01],\n","          [ 1.2647e+00,  5.6929e-01,  1.1788e+00,  ..., -3.1794e-01,\n","           -1.8421e-01, -1.0278e-01],\n","          ...,\n","          [-1.8224e+00, -1.5896e+00, -1.1937e-01,  ...,  2.1621e-01,\n","           -1.0952e+00,  6.8224e-01],\n","          [-9.6240e-01, -1.6066e+00,  2.0859e-01,  ..., -1.2458e+00,\n","           -7.6382e-01,  9.0483e-01],\n","          [ 1.1524e+00,  6.1753e-01,  5.0288e-01,  ..., -1.3170e+00,\n","           -2.3576e-01, -1.6870e-01]],\n","\n","         [[-9.6183e-01, -6.8791e-01,  2.2294e+00,  ..., -9.5571e-01,\n","            1.1590e+00, -1.6380e+00],\n","          [ 8.7515e-03, -8.9551e-03,  3.3689e-02,  ...,  4.8667e-01,\n","           -7.6540e-01, -1.1040e+00],\n","          [-9.0809e-01,  5.6849e-01,  2.0813e+00,  ..., -2.1590e+00,\n","           -5.8629e-01, -5.2903e-01],\n","          ...,\n","          [-2.8377e-01,  1.5507e+00,  1.0194e+00,  ...,  3.5577e-01,\n","            2.3665e+00, -1.7060e+00],\n","          [ 1.2250e+00,  4.5584e-01, -1.2480e+00,  ..., -7.7317e-01,\n","            1.2199e+00,  7.5555e-01],\n","          [ 5.9515e-01,  2.0012e-01, -2.5073e-01,  ..., -1.1817e+00,\n","           -1.0222e+00, -3.3499e-01]],\n","\n","         ...,\n","\n","         [[ 2.9210e-01,  3.0217e-01, -1.7236e+00,  ...,  6.8778e-02,\n","            1.2050e+00, -9.1621e-01],\n","          [ 3.0648e-01,  8.9824e-01, -1.8963e-01,  ..., -9.5919e-01,\n","           -7.1010e-02, -3.2264e-01],\n","          [-1.0998e+00, -4.1058e-01, -1.1636e+00,  ...,  5.9523e-02,\n","            1.2502e+00,  3.8397e-01],\n","          ...,\n","          [ 6.1901e-01, -5.1769e-01, -6.6833e-02,  ...,  1.8766e+00,\n","            4.8308e-01, -1.2209e+00],\n","          [ 2.4682e+00,  1.0718e+00,  5.6617e-01,  ..., -2.3625e-01,\n","            4.5457e-01,  5.9826e-01],\n","          [-6.2694e-01,  1.2871e+00,  2.6240e-01,  ...,  1.6117e+00,\n","            5.8299e-01, -8.2946e-02]],\n","\n","         [[-2.7348e-01, -3.5920e-01,  1.3551e+00,  ...,  5.0818e-01,\n","           -1.4646e+00,  6.2406e-01],\n","          [ 1.8998e+00, -1.4937e+00, -6.1449e-01,  ...,  1.8397e-02,\n","            8.9039e-01,  4.3523e-01],\n","          [ 4.8888e-01,  3.5218e-02, -1.7323e-01,  ..., -1.6090e+00,\n","            3.7032e-01, -7.9073e-01],\n","          ...,\n","          [-9.2884e-01, -2.0809e-01, -2.7412e-01,  ..., -5.8425e-01,\n","            8.3135e-01,  1.5732e+00],\n","          [-3.6306e-01,  4.3154e-01, -7.0732e-01,  ...,  7.4464e-01,\n","            6.5682e-01,  2.1492e-01],\n","          [-1.4863e+00, -9.2108e-01,  2.9082e-01,  ..., -1.9173e+00,\n","           -3.5706e-01,  1.7519e+00]],\n","\n","         [[ 1.1523e+00, -9.9562e-01, -9.5984e-01,  ...,  3.7883e-01,\n","            9.0664e-01, -2.0382e-01],\n","          [-1.0231e+00,  6.0626e-01,  5.6273e-01,  ...,  3.0102e+00,\n","           -6.0082e-01, -3.8693e-01],\n","          [-7.2144e-01, -4.5744e-01,  1.5680e+00,  ..., -1.1906e+00,\n","           -2.4221e+00, -8.5873e-01],\n","          ...,\n","          [-6.2231e-01, -1.4172e+00,  2.5503e+00,  ...,  3.8974e-02,\n","           -3.4057e+00, -5.5281e-01],\n","          [ 4.0354e-02, -1.1680e+00, -1.9037e-01,  ..., -2.2466e+00,\n","            3.1411e-01, -1.2667e-01],\n","          [ 6.9784e-01, -3.3026e-01,  4.3275e-01,  ...,  5.7830e-01,\n","            8.9574e-01, -9.2735e-01]]]])\n","tensor([[[[-3.8940e-02, -3.2200e-01, -5.3292e-01,  ...,  8.1275e-01,\n","            2.2578e-01, -2.2369e-01],\n","          [-1.7594e-01,  7.3497e-01, -3.1555e-01,  ...,  1.1284e+00,\n","           -1.7491e-01, -3.9733e-01],\n","          [ 2.7626e-01, -1.4238e-01, -2.2724e-01,  ..., -6.0154e-01,\n","           -2.2191e-01, -3.3316e-01],\n","          ...,\n","          [ 2.0420e-01,  5.7855e-02, -8.8394e-02,  ..., -9.9844e-01,\n","            2.2811e-01,  8.7973e-02],\n","          [-5.6400e-02, -4.9325e-01, -8.6413e-01,  ...,  3.8851e-01,\n","           -8.2552e-01, -2.4651e-01],\n","          [ 4.3162e-01,  1.4962e+00,  7.4463e-01,  ...,  1.4938e-01,\n","           -3.1840e-01, -3.5310e-01]],\n","\n","         [[ 3.8770e-01,  6.7385e-01,  3.4910e-01,  ...,  3.1999e-01,\n","            2.8324e-01, -2.9675e-01],\n","          [-1.3292e-01, -5.8859e-02,  1.3637e-01,  ..., -1.2041e+00,\n","            1.4240e-01,  3.0838e-01],\n","          [ 6.9714e-01,  5.5101e-01, -1.5471e+00,  ...,  9.5782e-01,\n","            2.3170e-01, -4.3389e-01],\n","          ...,\n","          [-6.4577e-01,  1.0479e+00,  6.3629e-01,  ...,  3.4591e-01,\n","            4.8992e-01,  3.3227e-01],\n","          [-6.1779e-01,  1.3927e-01, -4.0406e-01,  ..., -1.7888e-01,\n","           -1.7985e-01, -2.0591e-01],\n","          [-1.4523e-01,  9.5393e-02, -5.8958e-01,  ...,  5.7917e-01,\n","            7.5100e-01,  2.4094e-01]],\n","\n","         [[ 1.9396e-01,  3.7335e-01, -4.1279e-01,  ..., -4.5979e-01,\n","           -1.1630e-01,  5.9340e-02],\n","          [-3.9772e-01, -5.7901e-01, -1.3659e-03,  ..., -6.4539e-01,\n","           -1.0984e+00,  2.5975e-01],\n","          [ 4.8252e-01,  4.0674e-01,  2.9577e-01,  ...,  5.2053e-01,\n","            2.5383e-01,  1.5196e-01],\n","          ...,\n","          [ 4.7747e-01,  1.1225e+00, -7.4728e-01,  ..., -6.4823e-01,\n","            1.6508e-01, -6.5292e-01],\n","          [-6.0756e-02,  3.3529e-01,  2.4309e-01,  ..., -4.0978e-01,\n","           -5.5106e-01, -8.6848e-03],\n","          [ 3.4019e-01,  4.2220e-02, -2.7755e-01,  ..., -3.5608e-02,\n","           -4.2499e-02, -5.2052e-01]],\n","\n","         ...,\n","\n","         [[-9.9064e-02,  1.4779e-01, -7.6629e-01,  ...,  2.9454e-01,\n","           -5.0933e-01,  1.4961e-01],\n","          [-5.0300e-01,  7.2371e-01,  8.8288e-03,  ...,  8.1740e-01,\n","            2.8114e-01,  2.1227e-01],\n","          [ 1.3288e-02,  3.4185e-01, -1.8269e+00,  ...,  4.0307e-01,\n","            4.4686e-01, -2.2732e-01],\n","          ...,\n","          [ 3.9679e-02, -8.5557e-03, -7.1907e-01,  ...,  7.6398e-01,\n","            2.1974e-01, -2.2719e-03],\n","          [-3.9232e-01, -7.8449e-02, -2.7722e-01,  ...,  5.4221e-01,\n","           -4.2765e-02, -1.0076e-01],\n","          [ 2.5491e-01, -3.7883e-01, -2.4007e-01,  ...,  6.2102e-01,\n","            5.7463e-01,  6.5369e-01]],\n","\n","         [[-1.9020e-01,  4.8707e-01, -1.3450e-01,  ..., -1.1250e-01,\n","            1.9959e-01, -1.5229e-01],\n","          [-8.7870e-02, -3.7449e-01,  5.6645e-01,  ..., -9.0985e-02,\n","            6.6774e-02, -2.1985e-01],\n","          [-2.0940e-01,  9.7862e-01, -2.3047e-01,  ..., -5.0590e-01,\n","           -5.7801e-01, -2.8515e-01],\n","          ...,\n","          [-8.7991e-02, -9.1591e-02,  3.9491e-01,  ..., -4.4889e-01,\n","           -5.4264e-01,  3.4727e-01],\n","          [-3.8493e-01, -1.1533e-01, -1.8144e-01,  ...,  1.6248e-01,\n","            4.4642e-01,  3.0525e-01],\n","          [-7.1329e-02, -6.0351e-01,  3.8875e-01,  ..., -8.7222e-01,\n","            5.7972e-02, -2.8724e-02]],\n","\n","         [[ 1.8221e-01, -2.2571e-01, -4.5706e-01,  ..., -2.2395e-01,\n","           -6.2625e-01,  5.4926e-02],\n","          [ 5.2883e-02,  3.1921e-01, -1.0330e-01,  ...,  7.7119e-01,\n","            3.6383e-01, -1.3263e-01],\n","          [-8.9972e-01,  3.4875e-01,  5.1368e-01,  ..., -4.6323e-02,\n","           -1.6271e-01,  2.6035e-01],\n","          ...,\n","          [-7.2328e-03,  6.4722e-01,  2.7175e-01,  ..., -7.2379e-01,\n","            2.6376e-01, -6.1084e-01],\n","          [-8.0000e-03, -4.9649e-01,  5.6455e-01,  ..., -5.9122e-01,\n","           -3.8443e-01,  4.4364e-01],\n","          [-2.0580e-01,  1.3113e+00, -4.3759e-02,  ..., -1.7177e-01,\n","           -6.4989e-01,  2.8884e-01]]],\n","\n","\n","        [[[ 3.8290e-01, -5.0408e-01,  2.4075e-03,  ...,  1.0204e-01,\n","           -1.6070e-01, -2.9816e-01],\n","          [-1.3221e-01, -2.5286e-01, -1.3731e-01,  ...,  6.3635e-01,\n","           -1.9030e-01, -1.6654e-01],\n","          [ 4.7412e-01, -5.7938e-01,  2.0632e-01,  ..., -3.5292e-01,\n","           -9.9229e-04, -6.6203e-01],\n","          ...,\n","          [ 2.9195e-01, -4.5356e-01, -8.9177e-01,  ...,  5.0700e-01,\n","            4.3170e-01,  2.7211e-01],\n","          [-8.1150e-03,  1.4957e-01, -1.5342e-01,  ...,  4.7704e-01,\n","           -4.5499e-02, -6.4403e-01],\n","          [-1.3880e-01, -2.1379e-01, -1.3533e-01,  ...,  9.4235e-02,\n","            2.7504e-01,  3.5183e-02]],\n","\n","         [[ 7.6427e-02, -3.3540e-01,  4.5683e-01,  ..., -3.2729e-01,\n","           -1.4065e-01, -1.6017e-01],\n","          [ 5.3656e-01, -1.1343e-01, -8.2039e-02,  ...,  6.3200e-01,\n","           -3.4834e-01, -4.2896e-02],\n","          [ 6.9761e-01,  4.6642e-01,  3.3932e-02,  ...,  2.5003e-01,\n","            6.5269e-01,  7.3857e-01],\n","          ...,\n","          [ 3.5103e-01,  1.5954e-01, -9.1047e-02,  ..., -7.2659e-01,\n","           -1.9244e-01, -1.0292e+00],\n","          [-2.4833e-01,  3.5905e-01, -2.9211e-01,  ...,  1.0641e-01,\n","            5.0410e-01,  3.9253e-01],\n","          [ 2.4076e-01,  4.6539e-01, -2.3248e-01,  ..., -4.7151e-01,\n","           -2.7053e-01, -2.2919e-02]],\n","\n","         [[ 6.2241e-02, -7.6625e-02,  6.4684e-01,  ...,  1.5642e-01,\n","            2.3006e-01, -2.4216e-01],\n","          [ 3.2169e-01,  7.0855e-03, -1.6605e-01,  ..., -6.2803e-01,\n","            5.1887e-01, -2.2784e-01],\n","          [ 3.7668e-01,  3.6397e-02,  1.6649e-02,  ..., -5.7939e-01,\n","            1.3782e-01, -5.7070e-01],\n","          ...,\n","          [-4.8064e-01, -4.2881e-01,  7.3962e-02,  ...,  5.1828e-01,\n","            8.0883e-01,  2.2479e-01],\n","          [-2.6191e-01, -5.7551e-03, -4.5713e-01,  ...,  8.0808e-02,\n","            5.0038e-01, -1.9695e-01],\n","          [-8.5335e-02,  3.6691e-02, -5.4188e-01,  ..., -1.1395e-01,\n","            3.2589e-01,  1.8712e-01]],\n","\n","         ...,\n","\n","         [[-9.2056e-02, -2.4495e-02,  3.6162e-01,  ...,  1.9543e-01,\n","           -3.1846e-01,  1.5457e-01],\n","          [-1.5075e-01,  3.0194e-01, -5.2438e-02,  ..., -1.0791e-01,\n","           -3.2459e-01, -2.0110e-01],\n","          [ 8.5474e-01, -4.4784e-01, -4.4289e-01,  ...,  1.8603e-01,\n","           -2.3750e-01, -5.3289e-02],\n","          ...,\n","          [ 8.6052e-01,  2.3733e-01,  3.6523e-01,  ...,  4.7417e-01,\n","            2.1221e-01, -7.9120e-01],\n","          [ 1.5511e-01,  2.5860e-02, -2.7490e-01,  ...,  1.0609e+00,\n","            1.4171e-01, -2.4531e-01],\n","          [-2.9308e-01, -6.5130e-01,  3.2120e-01,  ..., -6.5667e-01,\n","           -3.4762e-01, -5.0796e-01]],\n","\n","         [[ 1.1670e-01, -3.8619e-02, -9.5030e-02,  ..., -2.4043e-01,\n","           -1.9378e-01, -4.4943e-02],\n","          [ 2.4880e-01,  6.7516e-02, -1.7918e-01,  ...,  1.1109e+00,\n","            1.5287e-01,  3.7299e-04],\n","          [ 4.9347e-01,  6.7889e-01,  9.0764e-01,  ...,  1.6209e-01,\n","           -1.1385e-01,  6.1129e-01],\n","          ...,\n","          [-6.3719e-03,  5.5735e-01,  7.3746e-01,  ...,  4.1614e-01,\n","            2.4319e-01, -7.2612e-01],\n","          [-9.6972e-02,  3.4073e-02, -2.3357e-01,  ...,  3.1055e-01,\n","           -4.0915e-01, -1.0346e-01],\n","          [ 2.4781e-01, -3.2867e-01,  4.3155e-02,  ..., -5.1700e-01,\n","           -7.1931e-02, -5.0736e-01]],\n","\n","         [[-1.2983e-01, -2.4955e-01, -1.0653e-01,  ..., -5.1467e-01,\n","            2.6546e-01, -1.4628e-02],\n","          [-1.5829e-01, -3.7998e-01, -5.4633e-01,  ..., -9.4646e-02,\n","           -1.4492e-01,  4.5723e-01],\n","          [ 2.1230e-01,  3.6941e-03, -6.4244e-01,  ..., -1.6525e-01,\n","           -4.6104e-01,  7.3538e-01],\n","          ...,\n","          [ 8.4422e-01, -3.3044e-01, -1.8200e-01,  ..., -2.8376e-01,\n","            1.1685e-01,  5.4990e-01],\n","          [ 1.0809e-01,  1.8667e-01, -6.0653e-01,  ..., -8.0908e-01,\n","            1.4168e-01, -3.8098e-01],\n","          [ 1.5388e-01, -2.5885e-01, -2.7499e-01,  ..., -1.9140e-01,\n","           -2.0943e-01,  7.5956e-03]]],\n","\n","\n","        [[[ 1.0709e-01, -2.9365e-01,  7.6574e-01,  ...,  7.1993e-02,\n","           -6.3454e-01,  5.8253e-01],\n","          [-5.5843e-01, -7.8918e-01,  4.7348e-01,  ...,  4.6386e-01,\n","           -9.4689e-02,  4.7279e-01],\n","          [ 6.0152e-01,  3.1070e-02,  6.2447e-01,  ..., -4.5931e-01,\n","            7.7258e-01,  2.5073e-01],\n","          ...,\n","          [-5.5375e-01, -1.1319e+00, -5.4067e-01,  ...,  3.4404e-01,\n","           -3.0968e-01, -1.0939e-01],\n","          [-6.8796e-01, -4.9380e-01, -1.6359e-01,  ..., -1.7310e-01,\n","           -1.3931e-01, -4.5775e-01],\n","          [-6.8465e-02, -1.9244e-01,  9.1225e-02,  ..., -1.6161e-01,\n","           -4.0897e-01,  5.6595e-02]],\n","\n","         [[-1.1027e-01, -7.1977e-02, -3.3016e-01,  ...,  2.5992e-01,\n","            3.8279e-01, -1.7009e-02],\n","          [ 3.0042e-01, -4.2464e-01, -6.9554e-01,  ..., -4.5802e-02,\n","           -8.7896e-01,  1.0282e-01],\n","          [ 4.0571e-01,  2.5805e-01,  3.3016e-01,  ...,  4.1471e-01,\n","            1.4531e+00, -1.8988e-01],\n","          ...,\n","          [-2.1783e-01,  6.2984e-01,  1.2763e+00,  ...,  3.4276e-01,\n","           -5.8869e-02, -5.5027e-01],\n","          [ 6.9615e-01,  9.3722e-02, -6.7888e-01,  ..., -3.8946e-02,\n","            2.3404e-01, -3.8807e-01],\n","          [-1.9634e-01, -2.8547e-01, -7.2160e-02,  ...,  8.6206e-02,\n","            2.5949e-01,  4.0138e-01]],\n","\n","         [[ 1.5889e-01, -2.0000e-01, -1.5448e-01,  ..., -5.5993e-02,\n","            1.2161e-01, -1.6330e-01],\n","          [-2.1546e-01,  4.8864e-01, -1.3652e-01,  ..., -6.0871e-01,\n","            5.8725e-01, -2.5198e-01],\n","          [ 2.8475e-01,  4.2279e-01,  4.5845e-01,  ...,  1.3088e-02,\n","           -1.9924e-01, -3.0140e-01],\n","          ...,\n","          [-3.3632e-01, -1.4801e-01, -2.1429e-01,  ...,  7.6053e-01,\n","           -2.2768e-01,  5.4337e-01],\n","          [ 1.9451e-01, -2.3412e-01, -1.0408e-01,  ...,  6.3950e-01,\n","            1.1834e-01,  2.7473e-01],\n","          [ 2.7147e-01,  1.8895e-01,  1.3652e+00,  ...,  5.6300e-02,\n","           -2.5344e-01,  7.3629e-02]],\n","\n","         ...,\n","\n","         [[-1.0955e-01, -6.4603e-02, -1.3204e-01,  ..., -3.1438e-01,\n","           -2.9152e-01, -4.3349e-01],\n","          [-9.4308e-02, -2.4651e-01, -3.5795e-01,  ..., -1.2983e-01,\n","           -6.3304e-01,  3.3514e-02],\n","          [-2.4812e-01,  5.3350e-01,  4.1714e-01,  ...,  4.9149e-01,\n","           -4.4658e-01,  7.2696e-01],\n","          ...,\n","          [-2.4050e-01,  2.0142e-01, -6.0986e-02,  ..., -2.6675e-02,\n","           -3.8570e-01,  8.4711e-02],\n","          [ 2.6407e-01, -2.8559e-01, -1.3260e-01,  ..., -5.2925e-01,\n","            1.5320e-01, -3.0295e-01],\n","          [-3.7397e-01, -1.0221e-01, -1.6904e-01,  ...,  1.6436e-02,\n","            3.6256e-01, -1.1939e-01]],\n","\n","         [[ 1.5609e-01, -1.0644e-01, -2.9726e-01,  ...,  3.9042e-01,\n","           -3.8048e-01,  2.8293e-01],\n","          [-7.5725e-02, -6.4225e-01,  7.1210e-01,  ...,  6.9713e-01,\n","           -7.4209e-01, -4.3259e-01],\n","          [ 7.0927e-01,  1.2761e-01, -3.3216e-01,  ..., -5.3572e-01,\n","            4.4743e-01,  1.5502e-02],\n","          ...,\n","          [ 8.2029e-02,  5.1690e-01, -3.0074e-01,  ..., -2.8851e-01,\n","           -1.1616e+00, -7.1449e-01],\n","          [ 2.3225e-01,  3.2366e-01, -4.9621e-01,  ..., -6.5638e-01,\n","            3.8194e-01,  3.0661e-01],\n","          [-3.3720e-01, -4.2498e-01, -2.5880e-01,  ..., -4.1891e-01,\n","            2.3244e-02, -3.6020e-01]],\n","\n","         [[-5.3471e-01,  6.5127e-02, -3.7794e-01,  ...,  3.1651e-03,\n","            2.1383e-01,  7.6423e-03],\n","          [ 2.1409e-01,  2.6684e-01,  1.0642e+00,  ...,  1.3016e-01,\n","           -2.9316e-01,  7.1156e-01],\n","          [-3.0495e-01,  4.0987e-02,  1.1972e-01,  ...,  4.0565e-01,\n","            1.1806e+00, -7.8878e-01],\n","          ...,\n","          [-3.6463e-01,  4.4699e-02, -3.9941e-02,  ..., -4.4498e-01,\n","           -2.8777e-01,  3.3368e-01],\n","          [-4.5777e-01,  5.5702e-02,  2.8192e-01,  ..., -4.9072e-01,\n","           -5.6391e-01, -2.9795e-01],\n","          [-1.1695e-01, -8.0933e-02, -1.8027e-01,  ...,  1.2522e-01,\n","           -5.2960e-01,  1.6389e-03]]],\n","\n","\n","        ...,\n","\n","\n","        [[[ 7.1970e-02,  1.8019e-01, -1.0549e-01,  ..., -2.7687e-01,\n","           -2.9095e-01, -5.0818e-02],\n","          [-1.8330e-01,  4.2443e-01,  1.6737e-01,  ..., -8.6515e-02,\n","            2.8732e-01,  4.1612e-02],\n","          [ 2.0945e-01, -4.0368e-02, -3.0627e-01,  ...,  7.1015e-02,\n","            4.7696e-01,  8.7306e-03],\n","          ...,\n","          [ 7.1113e-01, -1.5432e-02,  2.1243e-02,  ...,  6.7754e-01,\n","           -6.2355e-01, -5.0460e-01],\n","          [-4.0536e-01,  4.0415e-01,  6.6520e-01,  ..., -5.5882e-01,\n","            9.2931e-02, -1.2686e-01],\n","          [ 3.4017e-01, -1.1030e-01,  2.1610e-01,  ...,  3.0043e-01,\n","            2.1691e-01, -2.9319e-01]],\n","\n","         [[ 2.5214e-01,  1.6637e-01,  3.2773e-01,  ...,  8.2356e-03,\n","           -2.5743e-01,  6.6284e-02],\n","          [ 9.8301e-02,  9.1720e-01,  1.2465e-01,  ..., -2.7929e-01,\n","           -3.7516e-01,  1.2352e-01],\n","          [ 3.1817e-01,  1.0407e-01, -1.0413e+00,  ..., -5.4447e-01,\n","           -6.1787e-01, -1.0384e-01],\n","          ...,\n","          [ 2.3379e-01,  6.2966e-01, -6.1499e-02,  ...,  6.0368e-01,\n","            1.0303e+00, -2.1807e-01],\n","          [-1.0172e-01, -3.8159e-01,  2.4968e-01,  ..., -4.9639e-01,\n","           -8.2614e-01,  2.4062e-01],\n","          [ 7.2345e-01, -4.0377e-01,  2.7281e-02,  ..., -3.6156e-01,\n","            9.9014e-01, -4.8210e-02]],\n","\n","         [[ 2.7273e-01,  1.6954e-03, -1.9162e-01,  ...,  2.6179e-01,\n","           -5.9699e-01,  3.6172e-01],\n","          [-6.2988e-02, -5.7639e-01, -7.2652e-01,  ...,  6.3314e-01,\n","           -3.0650e-01,  9.6138e-02],\n","          [ 2.8475e-01, -5.6256e-02,  1.0185e-01,  ..., -2.7285e-01,\n","            7.2928e-01,  1.2254e-01],\n","          ...,\n","          [ 8.1594e-02, -2.4893e-01,  3.2434e-03,  ..., -6.8766e-02,\n","           -4.8614e-01, -4.7824e-02],\n","          [-2.9244e-01, -3.4253e-02, -1.1210e+00,  ...,  2.6942e-01,\n","           -1.8847e-02,  8.8663e-02],\n","          [-5.5868e-01,  2.0998e-01, -6.8469e-01,  ..., -8.3891e-02,\n","           -1.0818e-01,  2.1823e-02]],\n","\n","         ...,\n","\n","         [[ 3.1685e-01,  8.3936e-02, -3.3685e-01,  ...,  1.1370e-02,\n","           -3.1867e-01,  7.9397e-02],\n","          [ 4.4338e-01, -2.0069e-01, -1.2060e+00,  ...,  6.1480e-02,\n","            4.5162e-01, -7.2362e-01],\n","          [-1.2859e-01, -2.8109e-01,  1.8843e-01,  ..., -1.0930e-01,\n","            7.4450e-02,  3.3132e-01],\n","          ...,\n","          [ 4.7250e-01,  2.5788e-01, -1.1897e+00,  ..., -9.0208e-01,\n","            3.2184e-01,  4.2364e-01],\n","          [-1.8182e-01,  2.2762e-02,  1.5072e-01,  ...,  9.5757e-01,\n","            2.2587e-02, -5.2246e-01],\n","          [-3.7973e-02, -6.4086e-01,  3.7019e-01,  ...,  9.4163e-02,\n","           -5.2651e-01,  1.8322e-01]],\n","\n","         [[-2.6074e-01,  3.0489e-01,  7.9139e-02,  ..., -5.1784e-01,\n","            2.7174e-01, -4.0470e-01],\n","          [ 5.9159e-02, -3.7734e-01,  3.4449e-01,  ..., -3.8509e-01,\n","           -1.9088e-01, -6.6036e-02],\n","          [ 8.0445e-01,  2.9957e-01, -7.1090e-01,  ..., -7.3666e-02,\n","            1.8446e-01,  6.6011e-01],\n","          ...,\n","          [ 2.7480e-01, -3.8265e-02, -1.3959e-01,  ...,  2.4090e-01,\n","           -1.0188e-01, -6.4067e-01],\n","          [ 1.8953e-01, -3.0090e-01,  3.6747e-01,  ..., -5.1500e-03,\n","           -1.1804e-01,  2.0290e-02],\n","          [ 7.7685e-02, -1.7276e-01, -8.3474e-02,  ...,  6.0368e-02,\n","            7.0448e-01, -1.3714e-01]],\n","\n","         [[ 6.7668e-02, -2.9305e-02, -7.0348e-02,  ...,  5.0848e-01,\n","           -1.2643e-01,  6.6658e-03],\n","          [ 3.7085e-01,  1.0003e+00,  1.3753e-01,  ..., -1.2417e-02,\n","            7.5550e-02, -4.0386e-01],\n","          [-3.1848e-01,  9.4891e-01, -5.1661e-02,  ...,  5.7946e-01,\n","            6.1653e-02, -3.2980e-01],\n","          ...,\n","          [ 5.8740e-01, -5.2517e-02,  8.1955e-01,  ..., -1.0085e-01,\n","           -2.5392e-01, -1.6492e-01],\n","          [ 2.5080e-01,  4.8048e-01,  9.5095e-02,  ...,  2.4552e-01,\n","            5.7531e-01,  1.0076e-01],\n","          [-1.9317e-01, -2.7158e-01, -2.1092e-01,  ..., -1.8935e-01,\n","            2.2844e-01,  1.4973e-01]]],\n","\n","\n","        [[[-1.2294e-01,  8.2292e-02,  2.7745e-01,  ...,  4.1535e-01,\n","           -3.5125e-01,  2.0406e-01],\n","          [ 3.8203e-01,  3.0626e-01, -5.7432e-01,  ...,  7.3821e-01,\n","            6.6613e-01, -2.6726e-01],\n","          [-2.6143e-01, -5.0239e-01, -2.3035e-01,  ...,  3.0279e-01,\n","            6.0794e-01, -3.0550e-01],\n","          ...,\n","          [-2.2720e-01,  4.9147e-01, -5.4708e-01,  ...,  1.0541e-01,\n","            8.7617e-01,  2.9966e-01],\n","          [ 1.8422e-01,  2.1055e-02, -2.1417e-01,  ...,  7.2263e-02,\n","            5.9381e-01, -5.5466e-01],\n","          [ 1.5866e-02, -3.5517e-01, -5.6216e-01,  ..., -9.4527e-02,\n","            6.4177e-01,  1.2519e-01]],\n","\n","         [[ 9.7861e-02,  3.5432e-01,  1.1614e-01,  ...,  9.2909e-01,\n","           -1.4307e-01,  3.2454e-03],\n","          [ 1.3600e-01,  8.0466e-02, -4.7393e-01,  ...,  2.5793e-01,\n","           -4.5141e-01, -1.0410e-01],\n","          [-7.1635e-02, -4.6396e-01, -1.2441e+00,  ...,  8.6147e-01,\n","           -2.3260e-01,  2.9055e-01],\n","          ...,\n","          [-1.0106e+00,  2.6711e-01, -7.8050e-01,  ...,  1.1211e+00,\n","            8.1970e-02,  6.9136e-01],\n","          [ 8.0193e-01,  9.4867e-02,  1.9000e-01,  ...,  5.9079e-01,\n","            6.0274e-01, -8.1955e-01],\n","          [ 2.4679e-01,  4.0115e-01, -1.8629e-01,  ...,  9.7323e-01,\n","           -2.3308e-01,  1.6846e-01]],\n","\n","         [[-3.5722e-01, -8.7920e-02,  2.2053e-02,  ..., -2.4803e-01,\n","           -4.0542e-02,  3.3189e-01],\n","          [ 6.5186e-02,  2.0214e-01,  6.4033e-01,  ...,  4.0832e-01,\n","            8.7189e-01,  2.0531e-01],\n","          [-3.2201e-01,  7.4149e-01, -1.8102e-01,  ..., -7.7482e-01,\n","            3.3852e-01, -3.7291e-01],\n","          ...,\n","          [-1.0323e-01,  5.5255e-01, -1.3072e-01,  ..., -1.9341e+00,\n","            3.2118e-01, -1.1205e+00],\n","          [-4.9337e-01,  2.7397e-01, -7.4492e-01,  ...,  5.1744e-02,\n","           -1.8655e-03, -1.4132e-01],\n","          [-1.0508e+00,  1.5739e-01, -2.3156e-01,  ...,  6.7266e-01,\n","           -7.1925e-01,  8.3473e-03]],\n","\n","         ...,\n","\n","         [[ 4.3571e-02, -4.5498e-01, -1.6059e-02,  ..., -2.0041e-01,\n","           -4.3161e-01,  6.6396e-01],\n","          [ 1.9577e-01,  2.4208e-01,  2.3256e-01,  ...,  6.1916e-01,\n","           -4.1375e-02, -4.1187e-01],\n","          [ 1.1133e+00, -3.3228e-01, -6.3922e-01,  ...,  3.7850e-01,\n","           -3.2442e-01, -5.8057e-01],\n","          ...,\n","          [-1.2673e-01,  1.9982e-01,  5.5219e-02,  ..., -3.5996e-01,\n","           -2.7646e-01, -2.8122e-01],\n","          [ 4.6813e-01,  4.2862e-01, -5.4942e-01,  ..., -4.4971e-02,\n","           -1.1875e+00,  3.6077e-01],\n","          [-2.0191e-01,  1.2262e-01,  4.1162e-01,  ..., -6.9000e-01,\n","           -6.6755e-01, -2.3347e-01]],\n","\n","         [[ 4.6995e-03, -1.5072e-02,  2.9657e-02,  ...,  8.5736e-02,\n","           -3.8488e-01, -1.8275e-01],\n","          [ 4.1305e-01,  8.4857e-01, -6.3556e-01,  ..., -3.4725e-01,\n","            3.4144e-02,  1.7576e-01],\n","          [-3.5411e-01,  3.9743e-04, -5.1006e-01,  ..., -2.5820e-01,\n","           -4.4674e-01, -9.7243e-02],\n","          ...,\n","          [-5.0456e-01,  7.6909e-01,  1.1035e+00,  ...,  4.1070e-01,\n","           -5.9323e-01, -3.6231e-01],\n","          [ 9.5752e-02,  8.0135e-01, -8.2252e-01,  ...,  2.1568e-01,\n","            1.9872e-02, -1.0133e+00],\n","          [-1.0196e-01, -8.0225e-01, -2.4983e-01,  ..., -4.9500e-02,\n","           -2.5664e-01,  1.6570e-02]],\n","\n","         [[-1.7049e-01,  5.3104e-01,  1.9050e-01,  ..., -7.7817e-02,\n","           -4.8977e-01, -2.1006e-01],\n","          [-3.0930e-01, -7.6580e-02,  4.2311e-01,  ...,  6.1938e-01,\n","            7.7653e-01, -3.6553e-01],\n","          [ 7.4507e-01,  4.8910e-01,  1.8922e-01,  ..., -4.7713e-01,\n","            5.9227e-01,  1.1616e-01],\n","          ...,\n","          [ 1.6632e-01, -2.6345e-01,  6.2711e-01,  ..., -5.5043e-01,\n","           -7.5183e-01,  9.9853e-01],\n","          [-6.0210e-01, -5.7937e-02, -3.8366e-01,  ..., -5.9082e-01,\n","            7.2223e-01, -4.8650e-01],\n","          [ 2.8440e-01, -3.8086e-01,  7.8047e-04,  ...,  2.8732e-01,\n","            6.7278e-01, -4.6581e-01]]],\n","\n","\n","        [[[ 9.9636e-02, -3.0042e-02,  5.7240e-01,  ...,  1.2660e-01,\n","            2.1370e-01, -4.7004e-01],\n","          [ 3.0326e-01, -1.0258e+00, -4.7831e-01,  ...,  4.6634e-01,\n","           -1.4711e-01, -3.8351e-01],\n","          [ 1.0087e-01, -8.2584e-01, -4.9079e-01,  ...,  8.4566e-01,\n","           -5.8910e-01, -1.0839e+00],\n","          ...,\n","          [ 8.7304e-02,  2.9469e-01, -4.5503e-01,  ...,  4.9724e-02,\n","           -4.5156e-01, -3.9284e-01],\n","          [ 1.6556e-01,  1.2672e-01,  4.8837e-02,  ..., -1.1137e+00,\n","            8.2022e-01,  5.5377e-01],\n","          [-5.5714e-01, -1.1073e-01,  7.2570e-02,  ...,  6.2137e-02,\n","           -6.1209e-01,  2.2477e-01]],\n","\n","         [[-2.2759e-01, -2.1330e-01,  7.2071e-02,  ..., -8.1905e-01,\n","           -6.0655e-01, -5.8025e-01],\n","          [ 3.7045e-01, -1.6786e-01,  8.6302e-02,  ..., -7.4394e-02,\n","           -1.2678e+00,  1.9556e-01],\n","          [ 1.5481e+00, -2.4321e-01, -4.9708e-01,  ...,  3.6762e-02,\n","            1.1587e+00,  2.6536e-01],\n","          ...,\n","          [ 9.4043e-01, -4.9237e-01, -5.1413e-01,  ..., -4.9052e-01,\n","            6.5203e-01, -1.1406e+00],\n","          [ 6.3941e-01,  4.4665e-01,  6.0094e-01,  ...,  1.1106e-02,\n","           -7.0383e-01,  4.4374e-02],\n","          [ 3.0923e-01,  3.2846e-01, -1.7938e-01,  ...,  2.2897e-01,\n","            1.0972e-01,  5.1211e-01]],\n","\n","         [[ 4.0171e-01, -5.4195e-01, -1.9846e-01,  ..., -2.7084e-01,\n","            1.0574e-01,  5.7456e-02],\n","          [-3.9643e-01,  4.2852e-02, -1.8097e-01,  ..., -5.4528e-01,\n","            3.2995e-02, -1.6663e-01],\n","          [-1.3351e+00,  3.9782e-01, -2.3348e-02,  ..., -3.7037e-03,\n","            1.3070e-01, -6.0672e-01],\n","          ...,\n","          [-6.0995e-01,  3.7964e-01, -5.8636e-02,  ..., -5.9179e-01,\n","           -2.9969e-01,  8.3175e-01],\n","          [-5.8713e-02,  3.0151e-01, -2.0895e-01,  ...,  6.8149e-01,\n","           -2.6628e-01,  2.1493e-01],\n","          [-1.2311e-01,  2.0280e-01, -1.5061e-01,  ..., -9.7996e-01,\n","           -3.6634e-01, -1.7248e-01]],\n","\n","         ...,\n","\n","         [[ 3.2990e-01, -3.1267e-01, -2.0620e-01,  ...,  6.8075e-02,\n","           -2.3640e-01,  3.4050e-01],\n","          [-3.9859e-01, -3.3601e-01,  4.6432e-01,  ...,  8.0988e-01,\n","            4.1658e-02,  6.4873e-01],\n","          [ 4.3368e-01, -1.2329e+00,  7.3570e-01,  ...,  3.1327e-01,\n","            4.5339e-01, -4.7804e-01],\n","          ...,\n","          [ 6.6205e-02, -2.9423e-01, -8.8121e-01,  ...,  9.9300e-01,\n","           -3.0390e-01,  9.7887e-01],\n","          [-5.9464e-01,  4.0250e-01, -3.1705e-01,  ...,  6.4996e-01,\n","            2.4566e-02, -2.8878e-02],\n","          [ 4.4828e-02, -6.1184e-01, -4.5847e-01,  ..., -6.3949e-02,\n","            4.0562e-01, -1.0192e-01]],\n","\n","         [[ 2.1559e-01, -1.4900e-02, -3.2708e-01,  ...,  8.6293e-02,\n","            2.9821e-01,  1.0728e-01],\n","          [-1.6681e-01, -1.5272e-01, -3.6605e-01,  ...,  9.9871e-01,\n","           -1.0772e-01,  1.3073e-02],\n","          [-9.5216e-01, -1.3398e-01, -5.0816e-01,  ...,  6.1764e-01,\n","           -4.3988e-01, -1.8391e-01],\n","          ...,\n","          [ 5.0649e-01,  1.5359e-01,  6.6262e-01,  ...,  1.8886e-01,\n","            1.3060e-02,  4.5683e-01],\n","          [ 6.5392e-02, -5.0969e-01,  6.0543e-01,  ..., -2.0234e-01,\n","           -3.9706e-01,  3.3924e-01],\n","          [ 2.4372e-01, -5.7861e-02,  3.3637e-01,  ...,  8.3378e-01,\n","           -6.4141e-01, -1.9574e-01]],\n","\n","         [[-1.2945e-01,  7.8338e-02, -3.2067e-01,  ...,  1.7594e-01,\n","            4.9072e-02, -2.0564e-01],\n","          [ 2.0135e-01, -1.6347e-01, -2.4942e-01,  ...,  3.5795e-02,\n","           -4.5737e-01,  1.9888e-01],\n","          [-1.2958e+00,  1.3044e-01,  6.2387e-01,  ..., -8.1187e-01,\n","            6.4231e-02, -8.7752e-01],\n","          ...,\n","          [-6.0456e-02, -3.8653e-01, -9.4107e-01,  ...,  1.9879e-01,\n","           -1.6364e-01, -6.5747e-01],\n","          [ 3.5954e-01, -2.0812e-01, -7.1801e-01,  ..., -3.3484e-02,\n","            2.6744e-01,  1.3037e-01],\n","          [ 1.8231e-02,  7.5358e-02,  4.8357e-01,  ...,  2.9008e-01,\n","           -7.2279e-03, -7.2800e-01]]]], grad_fn=<SlowConvDilated2DBackward>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"RLqGbclbp3_N","executionInfo":{"status":"ok","timestamp":1603365191672,"user_tz":-540,"elapsed":1072,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"23396301-6a45-4c5d-eb48-ff91bbb9480f","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["output.shape"],"execution_count":72,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([20, 33, 26, 100])"]},"metadata":{"tags":[]},"execution_count":72}]},{"cell_type":"markdown","metadata":{"id":"CYeGAJEuneqW"},"source":["### nn.functional 패키지\n","\n","- 가중치를 직접 선언하여 인자로 넣어줘야함\n","\n","- 예시)\n","  - Convolution functions\n","\n","  - Pooling functions\n","  \n","  - Non-linear activation functions\n","\n","  - Normalization functions\n","\n","  - Linear functions\n","\n","  - Dropout functions\n","  \n","  - Sparse functions\n","  \n","  - Distance functions\n","\n","  - Loss functions\n","  - ..\n","\n","- https://pytorch.org/docs/stable/nn.functional.html"]},{"cell_type":"code","metadata":{"id":"NpwbO9Dhpflm","executionInfo":{"status":"ok","timestamp":1603365191673,"user_tz":-540,"elapsed":447,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","import torch.nn.functional as F"],"execution_count":73,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"fUYaJ5aLqKed"},"source":["- Convolution Layer 예시 (2)"]},{"cell_type":"code","metadata":{"id":"GAWLQE2GouHP","executionInfo":{"status":"ok","timestamp":1603365192685,"user_tz":-540,"elapsed":759,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["filters = torch.randn(8, 4, 3 ,3)"],"execution_count":74,"outputs":[]},{"cell_type":"code","metadata":{"id":"lWmSlFBrpms1","executionInfo":{"status":"ok","timestamp":1603365193093,"user_tz":-540,"elapsed":797,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"62308e1f-8424-4fe1-9f6f-58a6d9602368","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["inputs = torch.randn(1,4,5,5)\n","conv = F.conv2d(inputs, filters, padding=1)\n","conv.shape"],"execution_count":75,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 8, 5, 5])"]},"metadata":{"tags":[]},"execution_count":75}]},{"cell_type":"markdown","metadata":{"id":"Wah4RsmgrRDP"},"source":["## Torchvision\n","\n","- `transforms`: 전처리할 때 사용하는 메소드\n","\n","- `transforms`에서 제공하는 클래스 이외에  \n","  일반적으로 클래스를 따로 만들어 전처리 단계를 진행\n","  \n","  - 아래의 코드에서 다양한 전처리 기술 확인  \n","    https://pytorch.org/docs/stable/torchvision/transforms.html\n"]},{"cell_type":"code","metadata":{"id":"akvq4QWmqSil","executionInfo":{"status":"ok","timestamp":1603365194223,"user_tz":-540,"elapsed":1243,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","import torchvision\n","import torchvision.transforms as transforms"],"execution_count":76,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"PKu5mzyTs-Qj"},"source":["- 예시)\n","  - `DataLoader`의 인자로 들어갈 `transform`을 미리 정의할 수 있음\n","\n","  - `Compose`를 통해 리스트 안에 순서대로 전처리 진행\n","\n","  - 대표적인 예로, `ToTensor`()를 하는 이유는  \n","   <u>torchvision이 PIL Image형태로만 입력을 받기 때문에</u> 데이터 처리를 위해서 Tensor형으로 변환해야함"]},{"cell_type":"code","metadata":{"id":"y6K7FH-Rs9my","executionInfo":{"status":"ok","timestamp":1603365194223,"user_tz":-540,"elapsed":652,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["transform = transforms.Compose([transforms.ToTensor(),\n","                                transforms.Normalize(mean=(0.5), std=(0.5,))])"],"execution_count":77,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"I4l1GvIlslKa"},"source":["## utils.data\n","\n","- `Dataset`에는 다양한 데이터셋이 존재  \n","  - MNIST, CIFAR10, ...\n","\n","- `DataLoader`, `Dataset`을 통해  \n","  `batch_size`, `train`여부, `transform`등을 인자로 넣어 데이터를 어떻게 load할 것인지 정해줄 수 있음"]},{"cell_type":"code","metadata":{"id":"1wsZKY7-s2Vv","executionInfo":{"status":"ok","timestamp":1603365194642,"user_tz":-540,"elapsed":543,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.transforms as transforms"],"execution_count":78,"outputs":[]},{"cell_type":"code","metadata":{"id":"lldpI2lquBu3","executionInfo":{"status":"ok","timestamp":1603365196466,"user_tz":-540,"elapsed":2014,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"6dc7b02c-3a78-4bc9-91d4-4a4359c2331a","colab":{"base_uri":"https://localhost:8080/","height":386,"referenced_widgets":["e7cfec9a75824ca0badfd721564ef46d","64b78d0cde0c461fa37d7c54348ed658","65d1573a9abd47d4a3ec3ab5a9125f52","1cbf0c45322949bd8abcfe3fe996f04a","682b64af1c874d9c98d27fe291a8b092","378f265c040744949671d8a24a9ae191","16c52afcd6d84430894f1f947d0a045b","b9b61265e7b142ef913a5d6307af8092","d4a94efa48984d5bbddc5538526dfcf9","5b298b671afd45e695b728f5cabba821","d9b54548c832497fa0376504395a257f","52f83747cf45403d8d88b32fbdf86b5f","f2470f7cbf08460ca5e1a81514db91b4","d3370d92cebb4472b99746a9b01ed772","7fc48bc1c87c4c91a5e32e3529cd6b5c","399c52bcf8ab4c059ad64d1e81319a99","308dabbf75f04c1aa1938c96bd666146","f20488d4a53346f7865a71ffe4e03e86","38199483d85d4296a73635ec95795894","ec1b478955924f02a1ae92188e5b1442","b4f51ae8249f47cf9f48c2bdd81e1ed4","49d1da9f6eda42a29bf1fbfdf149e74d","eb4f6a45951a4b719eb3be051eacff8a","bc63836ec263410b9580bcec4ab7d7db","177367e1b4754857a088ec3cd0367be6","b58d7b80cf0c48f9b9b9807c185f453a","c1ecdc692d8d435e9e91c7bc0e7c8ff6","707e61e978664477a5dcd1dd98c46bac","9804b8f68ccc48cd8da62c43f4d08212","3d103012b1214e5aaae9ffe329f0574e","3d2840c829bd44c09bcfdfb6fb15602a","92ef8b84976a4999ba1871a166e6f739"]}},"source":["trainset = torchvision.datasets.MNIST(root='/content/',\n","                                     train=True,\n","                                     download=True,\n","                                     transform=transform)\n","\n","testset = torchvision.datasets.MNIST(root='/content/',\n","                                     train=False,\n","                                     download=True,\n","                                     transform=transform)"],"execution_count":79,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /content/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e7cfec9a75824ca0badfd721564ef46d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/train-images-idx3-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to /content/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d4a94efa48984d5bbddc5538526dfcf9","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/train-labels-idx1-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to /content/MNIST/raw/t10k-images-idx3-ubyte.gz\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"308dabbf75f04c1aa1938c96bd666146","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/t10k-images-idx3-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to /content/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"177367e1b4754857a088ec3cd0367be6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/t10k-labels-idx1-ubyte.gz to /content/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"fKddZnT1uQmT","executionInfo":{"status":"ok","timestamp":1603365196466,"user_tz":-540,"elapsed":1621,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["train_loader = DataLoader(trainset, batch_size=8, shuffle=True, num_workers=2)\n","test_loader = DataLoader(testset, batch_size=8, shuffle=False, num_workers=2)"],"execution_count":80,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"zrxymquLxeo8"},"source":["- `batch_size`만큼 데이터를 하나씩 가져옴"]},{"cell_type":"code","metadata":{"id":"hvgMIyF6uUuU","executionInfo":{"status":"ok","timestamp":1603365196467,"user_tz":-540,"elapsed":939,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"5efccf0d-e127-40a2-b912-ce13523a9cea","colab":{"base_uri":"https://localhost:8080/","height":85}},"source":["dataiter = iter(train_loader)\n","images, labels = dataiter.next()\n","images.shape, labels.shape"],"execution_count":81,"outputs":[{"output_type":"stream","text":["\n","\n","\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["(torch.Size([8, 1, 28, 28]), torch.Size([8]))"]},"metadata":{"tags":[]},"execution_count":81}]},{"cell_type":"markdown","metadata":{"id":"YPUC0a0aw6OM"},"source":["<u>**(중요) torch에서는 channel(채널)이 앞에 옴**</u>\n","\n","- `channel first`\n","\n","- tensorflow, keras 등에서는 channel이 뒤에 옴(`channel last`)"]},{"cell_type":"markdown","metadata":{"id":"wuhylD3iyFYr"},"source":["### 데이터 확인"]},{"cell_type":"code","metadata":{"id":"C9hAQmQlul8P","executionInfo":{"status":"ok","timestamp":1603365196729,"user_tz":-540,"elapsed":376,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import matplotlib.pyplot as plt\n","plt.style.use(['seaborn-white'])"],"execution_count":82,"outputs":[]},{"cell_type":"code","metadata":{"id":"zDcUY6o4xUQp","executionInfo":{"status":"ok","timestamp":1603365200600,"user_tz":-540,"elapsed":1005,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"658fb934-4cce-4437-94c5-6c0fa281ff41","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["torch_image = torch.squeeze(images[0])\n","torch_image.shape"],"execution_count":83,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([28, 28])"]},"metadata":{"tags":[]},"execution_count":83}]},{"cell_type":"code","metadata":{"id":"MZmPWiGbxoiW","executionInfo":{"status":"ok","timestamp":1603365200601,"user_tz":-540,"elapsed":796,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"234ce02d-07cc-4987-d430-d761d782a257","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image = torch_image.numpy()\n","image.shape"],"execution_count":84,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(28, 28)"]},"metadata":{"tags":[]},"execution_count":84}]},{"cell_type":"code","metadata":{"id":"AUOdd4UaxaXO","executionInfo":{"status":"ok","timestamp":1603365200601,"user_tz":-540,"elapsed":439,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"205b16c3-a1f3-48ad-80be-0173c8d1ad7f","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["label = labels[0].numpy()\n","label.shape"],"execution_count":85,"outputs":[{"output_type":"execute_result","data":{"text/plain":["()"]},"metadata":{"tags":[]},"execution_count":85}]},{"cell_type":"code","metadata":{"id":"PDQfjw4wxr1z","executionInfo":{"status":"ok","timestamp":1603365201241,"user_tz":-540,"elapsed":746,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"80e9b606-72b3-46f6-c236-49f59db95361","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["label"],"execution_count":86,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(6)"]},"metadata":{"tags":[]},"execution_count":86}]},{"cell_type":"code","metadata":{"id":"JDCVw59ax3-A","executionInfo":{"status":"ok","timestamp":1603365202204,"user_tz":-540,"elapsed":1390,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7de28a89-3b84-4e6d-ecd4-8a8747e88ac9","colab":{"base_uri":"https://localhost:8080/","height":311}},"source":["plt.title(label)\n","plt.imshow(image, 'gray')\n","plt.show()"],"execution_count":87,"outputs":[{"output_type":"stream","text":["\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"JVcWQlxzihtS"},"source":["## 각 Layer 설명"]},{"cell_type":"code","metadata":{"id":"IGXn1_weif5H","executionInfo":{"status":"ok","timestamp":1603365202206,"user_tz":-540,"elapsed":770,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim"],"execution_count":88,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"73kJ3heBi26y"},"source":["### nn.Conv2d\n","\n","- `in_channels`: channel의 갯수\n","\n","- `out_channels`: 출력 채널의 갯수\n","\n","- `kernel_size`: 커널(필터) 사이즈\n","\n","- 텐서플로우, 케라스와 다르게 레이어의 `input`인자에도 값을 집어 넣어줘야함"]},{"cell_type":"code","metadata":{"id":"RcHJguyFipTl","executionInfo":{"status":"ok","timestamp":1603365202876,"user_tz":-540,"elapsed":928,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"d244e77e-d548-4518-f9bf-d3a4de074eae","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["nn.Conv2d(in_channels=1, out_channels=20, kernel_size=5, stride=1)"],"execution_count":89,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))"]},"metadata":{"tags":[]},"execution_count":89}]},{"cell_type":"code","metadata":{"id":"iWiJbViHjFG0","executionInfo":{"status":"ok","timestamp":1603365203479,"user_tz":-540,"elapsed":1027,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"db646e33-1a3d-4663-840e-2c7d90827121","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["layer = nn.Conv2d(1, 20, 5, 1).to(torch.device(\"cpu\"))\n","layer"],"execution_count":90,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))"]},"metadata":{"tags":[]},"execution_count":90}]},{"cell_type":"markdown","metadata":{"id":"GxWYFm2xjUeN"},"source":["- `wegiht`확인"]},{"cell_type":"code","metadata":{"id":"za0enRbyjPzV","executionInfo":{"status":"ok","timestamp":1603365203870,"user_tz":-540,"elapsed":783,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"5965800c-ba51-4cd8-c6cd-fe6fcc18369c","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["weight = layer.weight\n","weight.shape"],"execution_count":91,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([20, 1, 5, 5])"]},"metadata":{"tags":[]},"execution_count":91}]},{"cell_type":"markdown","metadata":{"id":"MAZcTU2gjiCX"},"source":["- `weight`는 `detach()`를 통해 꺼내줘야 `numpy()`변환이 가능"]},{"cell_type":"code","metadata":{"id":"9eN_oUBkjT85","executionInfo":{"status":"ok","timestamp":1603365204194,"user_tz":-540,"elapsed":467,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["weight = weight.detach()"],"execution_count":92,"outputs":[]},{"cell_type":"code","metadata":{"id":"kwso9tsijmz8","executionInfo":{"status":"ok","timestamp":1603365204762,"user_tz":-540,"elapsed":680,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"6a9acf80-078b-40e0-9ae2-21002edbc202","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["weight = weight.numpy()\n","weight.shape"],"execution_count":93,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(20, 1, 5, 5)"]},"metadata":{"tags":[]},"execution_count":93}]},{"cell_type":"code","metadata":{"id":"mUegf6HPjdPl","executionInfo":{"status":"ok","timestamp":1603365205800,"user_tz":-540,"elapsed":1386,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"c9704fa3-27bb-40d1-fe97-2d04fdfa5025","colab":{"base_uri":"https://localhost:8080/","height":262}},"source":["plt.imshow(weight[0,0, :,:], 'jet')\n","plt.colorbar()\n","plt.show()"],"execution_count":94,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"DMeTOqVmcdWa","executionInfo":{"status":"ok","timestamp":1603365205801,"user_tz":-540,"elapsed":1044,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"f6ed4da6-334a-42a3-c996-e6f445620023","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(images.shape)"],"execution_count":95,"outputs":[{"output_type":"stream","text":["torch.Size([8, 1, 28, 28])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"cvolnNsscdHs","executionInfo":{"status":"ok","timestamp":1603365205802,"user_tz":-540,"elapsed":762,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["input_image = torch.unsqueeze(images[0], dim=0)"],"execution_count":96,"outputs":[]},{"cell_type":"code","metadata":{"id":"NLOAfD5mjup1","executionInfo":{"status":"ok","timestamp":1603365206270,"user_tz":-540,"elapsed":1012,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["output_data = layer(input_image)"],"execution_count":97,"outputs":[]},{"cell_type":"code","metadata":{"id":"r50wFkl6j1sY","executionInfo":{"status":"ok","timestamp":1603365206271,"user_tz":-540,"elapsed":586,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["output = output_data.data"],"execution_count":98,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZiIp-frJj2Hl","executionInfo":{"status":"ok","timestamp":1603365206896,"user_tz":-540,"elapsed":822,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"c62a87b6-b53e-4a4d-a495-6ad00ae6beef","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["output_arr = output.numpy()\n","output_arr.shape"],"execution_count":99,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 20, 24, 24)"]},"metadata":{"tags":[]},"execution_count":99}]},{"cell_type":"code","metadata":{"id":"uOHMu-UQkW3a","executionInfo":{"status":"ok","timestamp":1603365208097,"user_tz":-540,"elapsed":1622,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"91cd4017-117d-47b6-b0b6-28c80080112d","colab":{"base_uri":"https://localhost:8080/","height":323}},"source":["plt.figure(figsize=(15,30))\n","\n","plt.subplot(131)\n","plt.title(\"input\")\n","plt.imshow(image, 'gray')\n","plt.subplot(132)\n","plt.title(\"weight\")\n","plt.imshow(weight[0,0,:,:], 'jet')\n","plt.subplot(133)\n","plt.title(\"Output\")\n","plt.imshow(output_arr[0,0,:,:], 'gray')"],"execution_count":100,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<matplotlib.image.AxesImage at 0x7f28f0892358>"]},"metadata":{"tags":[]},"execution_count":100},{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAA2IAAAEhCAYAAAAd/BN5AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3de1xVdb7/8TexJUERFAEv5aUeZoxojV0MHR1FHS+d8lJnNJIeHR1PHcvJHO3wsLRmnJOJXdVTGpUzZlNM2HVyhIemjacUU8sJmwa1MiRFQCSRjcqG3x/+2BNeWF9gs9be29fzL9nrzff72Uv3cn32uoXU1tbWCgAAAABgm0ucLgAAAAAALjY0YgAAAABgMxoxAAAAALAZjRgAAAAA2IxGDAAAAABsRiMGAAAAADajEcM5/v73v2vatGk+H7ekpEQbN270+bgAcLbRo0erpKSkwUxaWpqef/758y7bsmWLvv/++5YoDUAQqK2t1R//+EfdcsstGj16tEaNGqUFCxbo6NGjlr/75z//uVlzf/311/r000+bNQb8A40YztGvXz+9/PLLPh83NzdXH374oc/HBYCzrV+/Xh07dmzy7//hD3+gEQNwQc8884zef/99ZWRkaP369frggw8UGRmp1NRUVVVVXfD3iouL9dJLLzVr7g0bNtCIBQkaMZwjNzdXI0eO1LJly/S73/1O9913n4YPH67bb79dR44ckSQlJycrIyNDEydO1E033aRnn3223u+ePdaePXv0u9/9TtnZ2XrwwQcdeV8AAsvPf/5zHThwQJK0bt06JSYmyu12S5JWrVqlRx99VL///e81atQoJScna8WKFd7f7d27tw4fPqyamhotXLhQgwYN0h133KEXX3xRqamp3lx5ebmmT5+uoUOHatq0aaqoqNCzzz6rbdu2ae7cuVq3bp29bxqA3zt27Jj++Mc/asmSJerUqZMkyeVyae7cubr00kv17rvverdBdep+njx5sr7//nuNHj1ap06dUu/evbV69WqNGzdOSUlJev311yVJb731lu6++27v79f9/OGHH2rlypVavXq1nnjiCVvfN3yPRgwNWr9+vebNm6cNGzYoJiZGa9eu9S77/PPP9eabb+qDDz7Qn/70J3311VcXHKdPnz6aMmWKRo0apWeeecaO0gEEuAEDBuiz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\n","text/plain":["<Figure size 1080x2160 with 3 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"6sCqGmH_kwHm"},"source":["### Pooling\n","- `F.max_pool2d` \n","  - `stride`\n","\n","  - `kernel_size`\n","\n","- `torch.nn.MaxPool2d` 도 많이 사용"]},{"cell_type":"code","metadata":{"id":"AYqPrLH1kxQl","executionInfo":{"status":"ok","timestamp":1603365208098,"user_tz":-540,"elapsed":990,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"b5f4667f-12ee-475f-d9e7-b01c297ebeb6","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image.shape"],"execution_count":101,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(28, 28)"]},"metadata":{"tags":[]},"execution_count":101}]},{"cell_type":"code","metadata":{"id":"tvI8W_8Yk81S","executionInfo":{"status":"ok","timestamp":1603365208099,"user_tz":-540,"elapsed":761,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"0da6740f-3077-4e3d-b2c5-9480798df127","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["pool = F.max_pool2d(output, 2, 2)\n","pool.shape"],"execution_count":102,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 20, 12, 12])"]},"metadata":{"tags":[]},"execution_count":102}]},{"cell_type":"markdown","metadata":{"id":"aV3HK4FulCaJ"},"source":["- MaxPool Layer는 weight가 없기 때문에 바로 `numpy()`변환 가능"]},{"cell_type":"code","metadata":{"id":"fseB_qlflBta","executionInfo":{"status":"error","timestamp":1603365241488,"user_tz":-540,"elapsed":882,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"798fdc6d-8f9a-4ad9-9c9b-58607f574490","colab":{"base_uri":"https://localhost:8080/","height":181}},"source":["pool_arr = pool.numpy()\n","pool_arr.shape"],"execution_count":104,"outputs":[{"output_type":"error","ename":"AttributeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m<ipython-input-104-79145549e7a0>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mpool_arr\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpool\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnumpy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mpool\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mAttributeError\u001b[0m: 'Tensor' object has no attribute 'arr'"]}]},{"cell_type":"code","metadata":{"id":"6w8DQnNtlNCq","executionInfo":{"status":"ok","timestamp":1603365324432,"user_tz":-540,"elapsed":1048,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"233ca3e1-a026-4c8f-e3da-537c021d1abf","colab":{"base_uri":"https://localhost:8080/","height":313}},"source":["plt.figure(figsize=(10,15))\n","plt.subplot(121)\n","plt.title(\"input\")\n","plt.imshow(image, 'gray')\n","plt.subplot(122)\n","plt.title(\"output\")\n","plt.imshow(pool_arr[0,0,:,:], 'gray')\n","plt.show()"],"execution_count":106,"outputs":[{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAksAAAEoCAYAAABINbVrAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3de1RVdfrH8Q9yJAVFiACjFehqmbo0VzVZ4i01ytTyXiiJzdjM5JjmrUkWo2bZaJDdvJR3W6NTYajlrEwYLRvHESqdLFyZlyYjNEQ9IgooHPn90fL8MnXvI+3D3kfer7/k8PjsxyNsPnz3LaimpqZGAAAAuKQGdg8AAADgZIQlAAAAA4QlAAAAA4QlAAAAA4QlAAAAA4QlAAAAA4QlmPryyy/12GOPWd736NGj2rx5s+V9AeBKbN26VYcOHfpVPVavXm3RNHAiwhJMdejQQcuWLbO8b35+vj766CPL+wLAlXjzzTd/VVgqKSnR0qVLLZwITuOyewA4X35+vqZOnar+/fvL7XaruLhYe/bsUWRkpF5//XXFxMSoV69eGj58uD788EMdOnRIw4YN04QJE7x/95///OcFvV599VU999xz8ng8Ki8v1yuvvGLzvxLA1eLDDz/UggULVF1drZiYGD3//PN6/fXXFR8frzFjxkiS0tLSFB8fr7NnzyovL0/ffvut/vznP+tf//qXwsPD9fXXX+u7775Tu3bt9Morr6hx48Zq3bq1PvnkEzVv3lySvB8/8sgjKi4u1v3336/169crJCTEzn8+/ICVJVyRjRs3Kj09XZs2bVJUVJTWrFnj/dwXX3yhd999Vx988IHeeust7dmz57J92rVrpxEjRqh3794EJQCWOXTokKZNm6YFCxZo48aN6tGjh6ZPn37Z+gkTJig2NlYvvvii+vbtK0natGmT5s6dq08++USnTp0yPcQ2a9YsXX/99dq4cSNB6SpFWMIVueOOO3TDDTcoKChIbdu21eHDh72fGzhwoIKDgxUVFaXf/OY32rlzp42TAqiPtm3bprvuuksJCQmSpIceekj5+fmqrq72uUevXr0UGRmpBg0aKCkpSf/973/9NS4CBGEJV6Rp06bePwcHB8vj8Xg/btas2QV/PnnyZJ3OBgBut1vh4eHej5s2baqamhq53W6fe0RERHj/HB4ezr4MhCVY5+c7oxMnTqhZs2YXBSp2OgD8KSoqSidOnPB+XFpaqgYNGig2Nlbnzp274PXL+fm+rLS01PuLYIMGDbz7M6O/j6sPYQmW2bBhg86dO6ejR49q586duuOOOxQdHa2SkhIdO3ZMHo9H//jHP7z1LpdLZWVlNk4M4GrTpUsXff755yosLJQkvfPOO+rSpYuio6O951EWFhZecJrAL/dFW7du1cmTJ+XxeLRp0ybdcccdknRBjzVr1qhBgwbev19eXn5Fh/oQWAhLsEyrVq00dOhQ9evXT6mpqWrVqpUSEhI0ZMgQDRw4UCkpKerUqZO3vkuXLsrLy9OQIUNsnBrA1aR58+Z6/vnnNWbMGN1///367LPP9Nxzz+nhhx9WUVGR7rvvPr300kvq3bu39+/07t1bkyZN0ooVKyRJnTp10tixY3X33XcrPDzcu4+aOHGiZsyYoQEDBqhx48Zq0qSJpJ+uimvWrJm6dOnyq+/XBGcKqqmpqbF7CAS+Xr16KTMz0/sbGAAEovO3FDh/iwFAYmUJAADAEGEJAADAAIfhAAAADLCyBAAAYMAvz4arrKxUQUGBoqOjFRwc7I9NAHAYj8ejkpIStW/fXo0aNbJ7nFpj/wXUP2b7L7+EpYKCAj3yyCP+aA3A4f7+978H9FWR7L+A+uty+69ah6VZs2Zp165dCgoKUnp6ujp06OD9XHR0tCTp+++/5yZdQD3hcrkUHx/v/f4PVOfnT0hIUMOGDW2eBkZcLut/3/fHUwb8MWf79u0t7/m///3P8p6SVFVV5Ze+VqqqqtLBgwcvu/+q1f/gp59+qoMHDyorK0sHDhxQenq6srKyvJ8/v3RdXV1NWALqmUA/dHV+/oYNG/IEeYfzRwjxR09/hO6wsDDLe/rr6z0oKMgvff3hcvuvWp3gvX37diUlJUmSbrrpJpWWlurUqVO1nw4AAMChahWWjh49qsjISO/H1157rUpKSiwbCgAAwCksuXUAt2oCAABXq1qFpZiYGB09etT78ZEjRwL+pE4AAIBLqVVY6tKli3JyciRJu3fvVkxMjPfpywAQCGbNmqXk5GQNGzZMX375pd3jAHCwWp32f/vtt6tdu3YaNmyYgoKC9Mwzz1g9FwD4jdkVvQDwc7W+RvKpp56ycg4AqDOXu6KXFXIAl8Kz4QDUO1zRC+BKEJYA1Htc0QvACGEJQL3DFb0ArgRhCUC9wxW9AK6E9Q/BAQCH44peAFeCsASgXuKKXgC+4jAcAACAAVaW4Fj9+/c3rXnttddMazp06GBaU1ZW5tNMAID6h5UlAAAAA4QlAAAAAxyGAwAEpKqqKst7fv/995b3HDVqlOU98/PzLe/ZoAHrJ5fDOwMAAGCAsAQAAGCAsAQAAGCAsAQAAGCAsAQAAGCAq+FgC1+uuhgxYoRpTUJCgmlN69atTWs+//xz0xoAQP3EyhIAAIABwhIAAIABwhIAAIABwhIAAIABwhIAAIABwhIAAIABwhIAAIABwhIAAIABbkoJWwwdOtSSGgAA/I2VJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAANcDQcA8LuamhrLe+7evdvynkuXLrW856FDhyzvefjwYct7HjlyxPKeklRRUeGXvnWJlSUAAAADhCUAAAADHIaD5cLCwkxrUlNTLdmWL8vwO3bssGRbAID6iZUlAAAAA7VaWcrPz9f48ePVqlUrSdLNN9+sadOmWToYAACAE9T6MNydd96puXPnWjkLAACA43AYDgAAwECtw9L+/fs1evRoDR8+XNu2bbNyJgDwu8zMTCUnJ2vIkCHKzc21exwADlarw3AtWrTQ2LFj1adPHxUWFmrkyJHKzc1VSEiI1fMBgOXy8vK0b98+ZWVlye12a9CgQbrvvvvsHguAQ9UqLMXGxqpv376SpPj4eF133XUqLi7WjTfeaOlwAOAPHTt2VIcOHSRJ4eHhqqiokMfjUXBwsM2TAXCiWh2GW79+vZYtWyZJKikp0bFjxxQbG2vpYADgL8HBwQoNDZUkZWdnq3v37gQlAJdVq5WlXr166amnntLmzZtVVVWlGTNmcAgOXlOmTDGt6devn2nNmTNnTGumT59uWuOPZ1Lh6rBp0yZlZ2dr+fLldo8CwMFqFZaaNGmihQsXWj0LANSZrVu3auHChVq6dKmaNm1q9zgAHIzHnQCod8rKypSZmak333xTERERdo8DwOEISwDqnQ0bNsjtdmvChAne1zIyMhQXF2fjVACcirAEoN5JTk5WcnKy3WMACBDcwRsAAMAAYQkAAMAAYQkAAMAAYQkAAMAAJ3jjinTt2tW0Zvjw4ZZsa9GiRaY169ats2RbAH4SFBTkl76nT5+2vOcf/vAHy3v6Y05/PGzeHzeCrqiosLzn1YKVJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAPcwRteLVq0MK1ZuXKlaU1CQoJpTW5urmnN5MmTTWsAAPA3VpYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMcFPKeqJhw4amNW+//bZpjS83nDx9+rRpzfPPP29a4/F4TGsAAPA3VpYAAAAMEJYAAAAMcBgOAODlr8PfYWFhlvfs3Lmz5T1Xr15tec+goCDLe3777beW92zevLnlPSWpuLjYL33rEitLAAAABghLAAAABghLAAAABghLAAAABghLAAAABrgarp6YO3euac1dd91lybZSU1NNa/79739bsi0AAPzNp5WlvXv3KikpSatWrZIkHT58WKmpqUpJSdH48eN19uxZvw4JAFarrKxUUlKS1q5da/coABzONCyVl5dr5syZSkxM9L42d+5cpaSk6K233lJCQoKys7P9OiQAWO2NN95Qs2bN7B4DQAAwDUshISFasmSJYmJivK/l5+frnnvukST17NlT27dv99+EAGCxAwcOaP/+/erRo4fdowAIAKZhyeVyqVGjRhe8VlFRoZCQEElSVFSUSkpK/DMdAPhBRkaG0tLS7B4DQID41VfD1dTUWDEHANSJ9957T7feeqtuvPFGu0cBECBqdTVcaGioKisr1ahRIxUXF19wiA4AnGzLli0qLCzUli1b9OOPPyokJETNmzf3y3PGAFwdahWWOnfurJycHA0YMEC5ubnq1q2b1XMBgF+8+uqr3j/PmzdPN9xwA0EJgCHTsFRQUKCMjAwVFRXJ5XIpJydHc+bMUVpamrKyshQXF6eBAwfWxawAAAB1zjQstW/fXitXrrzo9RUrVvhlIFy5pKQk05rf//73lmxr2LBhpjXvv/++JdsC/G3cuHF2jwAgAPC4EwAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAO1us8SAMB+wcHBlvd87733LO8pSR988IHlPb/55hvLe548edLynkeOHLG8Z2FhoeU9r7/+est7SvLLfcx27dplaT+XyzgOsbIEAABggLAEAABggMNwDhcXF2das2bNGtMaX5bri4qKTGtycnJMawLx4coNGzY0rQkNDTWtOX36tE/bq66u9qkOAGA/VpYAAAAMEJYA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\n","text/plain":["<Figure size 720x1080 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"q7RVioKwlbH1"},"source":["### Linear\n","- 1d만 가능 `.view()`를 통해 1D로 펼쳐줘야함"]},{"cell_type":"code","metadata":{"id":"Kwcedadrlcbl","executionInfo":{"status":"ok","timestamp":1603365364463,"user_tz":-540,"elapsed":387,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"a8627018-738d-4adc-8d50-eb02f3f33627","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image = torch.from_numpy(image)\n","image.shape"],"execution_count":107,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([28, 28])"]},"metadata":{"tags":[]},"execution_count":107}]},{"cell_type":"code","metadata":{"id":"_mYQy4I3lmAm","executionInfo":{"status":"ok","timestamp":1603365382488,"user_tz":-540,"elapsed":758,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ea9f0981-a7d5-4e7d-dc30-c6c8454ab7e5","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["flatten = image.view(1, 28*28)\n","flatten.shape"],"execution_count":108,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 784])"]},"metadata":{"tags":[]},"execution_count":108}]},{"cell_type":"code","metadata":{"id":"6wgSmY0Zlofk","executionInfo":{"status":"ok","timestamp":1603365399459,"user_tz":-540,"elapsed":955,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"e083fbcc-c6fa-4875-ad18-4a39445dcdc6","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["lin = nn.Linear(784, 10)(flatten)\n","lin.shape"],"execution_count":110,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 10])"]},"metadata":{"tags":[]},"execution_count":110}]},{"cell_type":"code","metadata":{"id":"LcJFqf0alsxr","executionInfo":{"status":"ok","timestamp":1603365403222,"user_tz":-540,"elapsed":1049,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"d446f2d0-3026-477f-d929-fb33de3d31af","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["lin"],"execution_count":111,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[-0.1734,  0.8694,  0.6228, -0.4640,  0.4381,  0.2363, -0.0746, -0.7430,\n","          0.3460,  0.1032]], grad_fn=<AddmmBackward>)"]},"metadata":{"tags":[]},"execution_count":111}]},{"cell_type":"code","metadata":{"id":"ewEpebSVluHz","executionInfo":{"status":"ok","timestamp":1603365435668,"user_tz":-540,"elapsed":725,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"cc392427-5242-41f6-817d-6b424d93f887","colab":{"base_uri":"https://localhost:8080/","height":248}},"source":["plt.imshow(lin.detach().numpy(), 'jet')\n","plt.colorbar()\n","plt.show()"],"execution_count":113,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"0IjPKDKRl3CV"},"source":["### Softmax"]},{"cell_type":"code","metadata":{"id":"obhBb3O-lzbs","executionInfo":{"status":"ok","timestamp":1603365482378,"user_tz":-540,"elapsed":975,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["with torch.no_grad():\n","  flatten = image.view(1, 28*28)\n","  lin == nn.Linear(784, 10)(flatten)\n","  softmax =F.softmax(lin, dim=1)"],"execution_count":114,"outputs":[]},{"cell_type":"code","metadata":{"id":"ljgOEyNMmBEE","executionInfo":{"status":"ok","timestamp":1603365484605,"user_tz":-540,"elapsed":1039,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"3df282a3-9d23-42e2-a645-82cbdb296eba","colab":{"base_uri":"https://localhost:8080/","height":51}},"source":["softmax"],"execution_count":115,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[0.0675, 0.1914, 0.1496, 0.0505, 0.1244, 0.1016, 0.0745, 0.0382, 0.1134,\n","         0.0890]])"]},"metadata":{"tags":[]},"execution_count":115}]},{"cell_type":"code","metadata":{"id":"18ymFSRAmBo7","executionInfo":{"status":"ok","timestamp":1603365493771,"user_tz":-540,"elapsed":1040,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"202f4492-c622-4c1a-9cdb-8ca57c1b3891","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["np.sum(softmax.numpy())"],"execution_count":116,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.99999994"]},"metadata":{"tags":[]},"execution_count":116}]},{"cell_type":"markdown","metadata":{"id":"bYh13Bnj5wEN"},"source":["### F.relu\n","\n","- ReLU 함수를 적용하는 레이어\n","\n","- `nn.ReLU`로도 사용 가능"]},{"cell_type":"code","metadata":{"id":"D4VFePpR9_Ak","executionInfo":{"status":"ok","timestamp":1603365512140,"user_tz":-540,"elapsed":816,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"2f2db0f1-8613-4947-cb72-908600854a84","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["inputs = torch.randn(4,3, 28, 28).to(device)\n","inputs.shape"],"execution_count":117,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([4, 3, 28, 28])"]},"metadata":{"tags":[]},"execution_count":117}]},{"cell_type":"code","metadata":{"id":"1lKlSiaY5wZW","executionInfo":{"status":"ok","timestamp":1603365543138,"user_tz":-540,"elapsed":508,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"de5b99a7-eb21-4b6e-b7b4-05466ba10669","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["layer = nn.Conv2d(3, 20, 5, 1).to(device)\n","output = F.relu(layer(inputs))\n","output.shape"],"execution_count":118,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([4, 20, 24, 24])"]},"metadata":{"tags":[]},"execution_count":118}]},{"cell_type":"markdown","metadata":{"id":"0yuABl4h-yye"},"source":["## Optimizer\n","\n","- `import torch.optim as optim`\n","\n","- `model`의 파라미터를 업데이트\n","\n","- 예시)\n","  ```python\n","  optimizer = torch.optim.Adam(model.parameters(), lr=1e-4, weight_decay=1e-5)\n","  optimizer = optim.SGD(model.parameters(), lr=0.001)\n","  ```\n","\n","- `.zero_grad()`로 초기화\n","- `.step()`으로 업데이트\n","\n"]}]}