{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"_10.1 파이토치 MNIST 모델.ipynb의 사본","provenance":[{"file_id":"19fuJ3fsZ6y5Bq0hGcRBNdaYP_JSTzF8t","timestamp":1603382633488}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"d84757cda686492cabf05ec89fa8e125":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f83591c41b5e4c0785dd8ec27b29d62c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_cbfe3b682ceb417f8667d87edac56a6f","IPY_MODEL_84910634b7bd45f49221d5e74fe0d76f"]}},"f83591c41b5e4c0785dd8ec27b29d62c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cbfe3b682ceb417f8667d87edac56a6f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9bc2259633f545ccb2982375171a62cf","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_92d15a4c13be48f6a04679215609a687"}},"84910634b7bd45f49221d5e74fe0d76f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_4f557836079a4299b5aa9ceb581755e6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:20&lt;00:00, 2612789.30it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_eef1fd82dd304cacbcbe70709d4de222"}},"9bc2259633f545ccb2982375171a62cf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"92d15a4c13be48f6a04679215609a687":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4f557836079a4299b5aa9ceb581755e6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"eef1fd82dd304cacbcbe70709d4de222":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d8591403475643289d3141ad4536b763":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f28e4d9a0e9140ed9579bd4b1f9115e5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_15d6e5473fb14e509a6f52a1b788d10a","IPY_MODEL_7467e08b6ccf432d9d29fbb2821e402b"]}},"f28e4d9a0e9140ed9579bd4b1f9115e5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"15d6e5473fb14e509a6f52a1b788d10a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0a8e558dfd1640daafc8a77bf26bd1b9","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0dfbaa76b755444a8e0903e3ab3d172f"}},"7467e08b6ccf432d9d29fbb2821e402b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d0cbcda255994c1a890a45f78600ba43","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 34898.09it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9771c8dc50d848ecbb7a6494169461d0"}},"0a8e558dfd1640daafc8a77bf26bd1b9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0dfbaa76b755444a8e0903e3ab3d172f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d0cbcda255994c1a890a45f78600ba43":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9771c8dc50d848ecbb7a6494169461d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fb95184538a84f469a1b661801447beb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3b894f01c2cc402ba26d5956a0447c25","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5413fbf3a1484814ae7edc23dbf22729","IPY_MODEL_65f2af1daa3c4d0c8cdc173a7fcb6279"]}},"3b894f01c2cc402ba26d5956a0447c25":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5413fbf3a1484814ae7edc23dbf22729":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2000ef0bf41c4e6c82a5e1f2d468eb08","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_83eaee88fa6e459ca7e6716b91122737"}},"65f2af1daa3c4d0c8cdc173a7fcb6279":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_4211b8a25f2746f28e2066af9fbb2ff1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:00&lt;00:00, 2182152.32it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_826cc1c8440d424f938336355cea19a4"}},"2000ef0bf41c4e6c82a5e1f2d468eb08":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"83eaee88fa6e459ca7e6716b91122737":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4211b8a25f2746f28e2066af9fbb2ff1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"826cc1c8440d424f938336355cea19a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1420c0a39ae24d8bb1660bf3f98afaba":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e0c4d4192924471385d45dd6a69e7f85","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c41d0db3402349c39078618226c50c09","IPY_MODEL_c2e55918d7344840a828967543bb2dd5"]}},"e0c4d4192924471385d45dd6a69e7f85":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c41d0db3402349c39078618226c50c09":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4fed36dc40af4600a1401333874562fe","_dom_classes":[],"description":"  0%","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7aa448a75faf4ade9badad1ec1ac19d8"}},"c2e55918d7344840a828967543bb2dd5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_01729f0a2433473ea4f972135f978fae","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/4542 [00:00&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6831bdb194214df291a8c5e2756f6df0"}},"4fed36dc40af4600a1401333874562fe":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7aa448a75faf4ade9badad1ec1ac19d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"01729f0a2433473ea4f972135f978fae":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6831bdb194214df291a8c5e2756f6df0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"83d8c6ec890e4b3c98668e0d076d783a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_126954033301404fa8a584543b8acf03","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f3f2f41c514b4771aeb0be603a296efd","IPY_MODEL_3fbf9f6195004573bea18bb9f67868ee"]}},"126954033301404fa8a584543b8acf03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f3f2f41c514b4771aeb0be603a296efd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ea8e1fbfc88047ac94dd811140f13bd1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ee59a3acbf6a40f08161dac41be1b0e0"}},"3fbf9f6195004573bea18bb9f67868ee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_727247fe34b3420d80dfba23fd014339","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:00&lt;00:00, 35437434.35it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_523b7a44e40441c883cdc47058731213"}},"ea8e1fbfc88047ac94dd811140f13bd1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ee59a3acbf6a40f08161dac41be1b0e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"727247fe34b3420d80dfba23fd014339":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"523b7a44e40441c883cdc47058731213":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"542db397b5d64d748baa2c6e45fd417d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_2946f591219349459c56eefd5565b063","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8b32fde3f8364658ae21e508c6581091","IPY_MODEL_7c584227c8174f98a69fd68f928fcdb9"]}},"2946f591219349459c56eefd5565b063":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8b32fde3f8364658ae21e508c6581091":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_915c4dd96d85406097e3558dd955f9c0","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_378c80f118cf40dfa13fe2a6ce07c543"}},"7c584227c8174f98a69fd68f928fcdb9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b8a1302b620d4636b74a23811a26f27e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/? [00:00&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b27e6aa3d4574d67ab4eea771e511a60"}},"915c4dd96d85406097e3558dd955f9c0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"378c80f118cf40dfa13fe2a6ce07c543":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b8a1302b620d4636b74a23811a26f27e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b27e6aa3d4574d67ab4eea771e511a60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4daaeb40b5bc41308b1adbe7c59a1835":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_001f35557676494cb57f389941c33c43","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_73fa7ec3b7f7423abe78370857b3fc0b","IPY_MODEL_d0694b0bbe2a47c7b262d09249b4ff99"]}},"001f35557676494cb57f389941c33c43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"73fa7ec3b7f7423abe78370857b3fc0b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b78d0835acba4f3c84545b274de8f0ae","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8c64453b6f6f4c16b915b70a4df50c76"}},"d0694b0bbe2a47c7b262d09249b4ff99":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ed4f2a0776ed46a4ad52b61005df56ff","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:19&lt;00:00, 134806.45it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_08505e4c72834ebfa81d605fb04b876f"}},"b78d0835acba4f3c84545b274de8f0ae":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8c64453b6f6f4c16b915b70a4df50c76":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ed4f2a0776ed46a4ad52b61005df56ff":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"08505e4c72834ebfa81d605fb04b876f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d920d7d9cb0d42cab5c90e0a9d0db155":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a5da7851ddf04ed5bc01b6d8189c2549","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c5ac18b2723f4c4baf4de96d02dfd3da","IPY_MODEL_6624a1856ef34266b9b91834ea9cbce2"]}},"a5da7851ddf04ed5bc01b6d8189c2549":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c5ac18b2723f4c4baf4de96d02dfd3da":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6b3f515ae85e4fec95a3ad01a6be004b","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2e20b015b85844629868c38f706c41ec"}},"6624a1856ef34266b9b91834ea9cbce2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_35c0e268d604462db8876894e0abc418","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/? [00:00&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e6e2ab5f4d234997b3b1e9218d581db6"}},"6b3f515ae85e4fec95a3ad01a6be004b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"2e20b015b85844629868c38f706c41ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"35c0e268d604462db8876894e0abc418":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e6e2ab5f4d234997b3b1e9218d581db6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"N70Zo_KMAg1H"},"source":["# 파이토치 MNIST 모델"]},{"cell_type":"markdown","metadata":{"id":"aNj9ScsbAlr-"},"source":["## modules import "]},{"cell_type":"code","metadata":{"id":"IaKgb-5BAj68","executionInfo":{"status":"ok","timestamp":1603380792153,"user_tz":-540,"elapsed":593,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim\n","\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.datasets\n","import torchvision.transforms as transforms\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","plt.style.use(['seaborn-white'])"],"execution_count":8,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"-v_WXu5iDfZK"},"source":["## 전처리 설정\n","- `transform.Compose`"]},{"cell_type":"code","metadata":{"id":"Xu74M5BxDiLH","executionInfo":{"status":"ok","timestamp":1603380793961,"user_tz":-540,"elapsed":599,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                 transforms.Normalize((0.5,), (0.5, ))])"],"execution_count":9,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"E-eus2CsDoEe"},"source":["## 데이터 로드 및 데이터 확인"]},{"cell_type":"code","metadata":{"id":"P9FURlkCDnja","executionInfo":{"status":"ok","timestamp":1603380798540,"user_tz":-540,"elapsed":2788,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"47fc2cb3-07e8-40b4-8eb4-bb9e9806626c","colab":{"base_uri":"https://localhost:8080/","height":427,"referenced_widgets":["d84757cda686492cabf05ec89fa8e125","f83591c41b5e4c0785dd8ec27b29d62c","cbfe3b682ceb417f8667d87edac56a6f","84910634b7bd45f49221d5e74fe0d76f","9bc2259633f545ccb2982375171a62cf","92d15a4c13be48f6a04679215609a687","4f557836079a4299b5aa9ceb581755e6","eef1fd82dd304cacbcbe70709d4de222","d8591403475643289d3141ad4536b763","f28e4d9a0e9140ed9579bd4b1f9115e5","15d6e5473fb14e509a6f52a1b788d10a","7467e08b6ccf432d9d29fbb2821e402b","0a8e558dfd1640daafc8a77bf26bd1b9","0dfbaa76b755444a8e0903e3ab3d172f","d0cbcda255994c1a890a45f78600ba43","9771c8dc50d848ecbb7a6494169461d0","fb95184538a84f469a1b661801447beb","3b894f01c2cc402ba26d5956a0447c25","5413fbf3a1484814ae7edc23dbf22729","65f2af1daa3c4d0c8cdc173a7fcb6279","2000ef0bf41c4e6c82a5e1f2d468eb08","83eaee88fa6e459ca7e6716b91122737","4211b8a25f2746f28e2066af9fbb2ff1","826cc1c8440d424f938336355cea19a4","1420c0a39ae24d8bb1660bf3f98afaba","e0c4d4192924471385d45dd6a69e7f85","c41d0db3402349c39078618226c50c09","c2e55918d7344840a828967543bb2dd5","4fed36dc40af4600a1401333874562fe","7aa448a75faf4ade9badad1ec1ac19d8","01729f0a2433473ea4f972135f978fae","6831bdb194214df291a8c5e2756f6df0"]}},"source":["trainset = torchvision.datasets.MNIST(root='./data',\n","                                      train=True,\n","                                      download=True,\n","                                      transform=transform)\n","\n","testset = torchvision.datasets.MNIST(root='./data',\n","                                     train=False,\n","                                     download=True,\n","                                     transform=transform)"],"execution_count":10,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d84757cda686492cabf05ec89fa8e125","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d8591403475643289d3141ad4536b763","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"fb95184538a84f469a1b661801447beb","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n","\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1420c0a39ae24d8bb1660bf3f98afaba","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"YYAssGe4Dy3c","executionInfo":{"status":"ok","timestamp":1603380879885,"user_tz":-540,"elapsed":552,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["train_loader = DataLoader(trainset,\n","                          batch_size=128,\n","                          shuffle=True,\n","                          num_workers=2)\n","\n","test_loader = DataLoader(testset,\n","                         batch_size=128,\n","                         shuffle=False,\n","                         num_workers=2)"],"execution_count":12,"outputs":[]},{"cell_type":"code","metadata":{"id":"X6gBiInXEG19","executionInfo":{"status":"ok","timestamp":1603380894899,"user_tz":-540,"elapsed":779,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["image, label = next(iter(train_loader))"],"execution_count":13,"outputs":[]},{"cell_type":"code","metadata":{"id":"maF2sZwmEqYh","executionInfo":{"status":"ok","timestamp":1603380915481,"user_tz":-540,"elapsed":559,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"f62bc687-25aa-4926-de65-3318a88d914e","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["image.shape, label.shape"],"execution_count":16,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(torch.Size([128, 1, 28, 28]), torch.Size([128]))"]},"metadata":{"tags":[]},"execution_count":16}]},{"cell_type":"code","metadata":{"id":"IwylR2BtFDCf","executionInfo":{"status":"ok","timestamp":1603380964388,"user_tz":-540,"elapsed":559,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["def imshow(img):\n","  img = img / 2 + .5\n","  npimg = img.numpy()\n","  fig = plt.figure(figsize=(10,5))\n","  plt.imshow(np.transpose(npimg, (1,2,0)))\n","  plt.show()"],"execution_count":17,"outputs":[]},{"cell_type":"code","metadata":{"id":"4NKMcdmuFF7m","executionInfo":{"status":"ok","timestamp":1603381000492,"user_tz":-540,"elapsed":940,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"51d71903-4fff-457e-cd5f-2693f56612ee","colab":{"base_uri":"https://localhost:8080/","height":192}},"source":["dataiter = iter(train_loader)\n","images, labels = dataiter.next()\n","imshow(torchvision.utils.make_grid(images[:4]))"],"execution_count":18,"outputs":[{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAkwAAACvCAYAAAAPK4HGAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAbcUlEQVR4nO3de1RVZf7H8Q9xZBCVUDpYVFrLZWapmamFqYWUrMquk2nIWE1WDt3UCi85SsvRBNQpdUpDbSYvSeGs0pUrHG0548wgM2rZYDVmt6V4AyRFgSZw//6YFfPb59m1j8dzOFzer/++X5599teHA3zd+znPjrAsyxIAAAB+1DnhLgAAAKCpo2ECAABwQcMEAADggoYJAADABQ0TAACACxomAAAAF55AD5wzZ452796tiIgITZs2TX369Gn4Wm1trUpKSuT1ehUZGRmUQgEAAEKhvr5eZWVl6tWrl6Kjox3HBNQw/eMf/9A333yj/Px8ffHFF5o2bZry8/Mbvl5SUqIxY8YEVjUAAEAYrF69Wv3793f8WkANU1FRkW666SZJUrdu3XT8+HGdPHlS7du3lyR5vV5JUkpKimJiYgI5BQAAQKOorq7Wli1bGvoXJwE1TOXl5bryyisb4k6dOqmsrKyhYfrhNlxMTExDDgAAoCn7qWVEQVn0zdNVAABASxZQw5SQkKDy8vKG+OjRoz95GQsAAKA5C6hhuv7661VYWChJ2rNnjxISErj1BgAAWqyA1jD169dPV155pUaPHq2IiAjNnDkz2HUBAAA0GQHvw/Tss88Gsw4AAIAmK+CGKRheeOGFcJ4eYebPlUneI62bv1eveZ+0bvwugZtg3Anj0SgAAAAuaJgAAABc0DABAAC4oGECAABwQcMEAADggoYJAADABQ0TAACACxomAAAAFzRMAAAALmiYAAAAXNAwAQAAuKBhAgAAcEHDBAAA4MITyEHFxcV6+umn1b17d0nSZZddpl//+tdBLQwAAKCpCKhhkqSBAwdq4cKFwawFAACgSeKWHAAAgIuAG6Z9+/Zp/Pjxuv/++/W3v/0tmDUBAAA0KQHdkrvkkkv0xBNP6JZbbtH+/fs1duxYbdq0SVFRUcGuDwAAIOwCapg6d+6sW2+9VZLUpUsXnXfeeTpy5IguvvjioBYHwBQREWHktm/fbosHDhxojLnyyitt8SeffBLcwgCgBQvoltz69eu1fPlySVJZWZkqKirUuXPnoBYGAADQVAR0hWnYsGF69tlntWXLFn3//ffKysridhwAAGixAmqY2rdvryVLlgS7FgAAgCYp4H2Y8NO8Xq+Ry8nJscUjR440xsTExNhip/UqW7ZsscW/+MUvjDGHDh3yq040P3PmzDFy/fv3t8WnT59urHIAoFVgHyYAAAAXNEwAAAAuaJgAAABc0DABAAC4YNF3AM45x95njhkzxhjzyiuvGLl27dq5vnZtba0t3r9/vzFm2LBhtnjr1q3GmOTkZCN38OBB1/Oj6UtKSgp3CQjAZZddZos3b95sjLnwwgttcVlZmTFmxYoVRm7y5Mmu558+fbrrGF9Lly41cseOHTvj1wFaAq4wAQAAuKBhAgAAcEHDBAAA4II1TC48HnOKFi5caIvHjx/v12t9/PHHtvi3v/2tMaaoqMgWHzhwwBgza9YsWzxx4kRjzP3332/k5s+f71edaDqcHjnEY4iavh49ehi5999/3xYnJiYaYyzLssXnnXeeMSYzM9P1OCe/+c1vzviYqVOnGrm9e/cauddff90WO63rvOKKK2xxQUGBMWbcuHGuNSEwvr83RowYYYyZOXOmkevTp48tzs3NNcbMmDHDFvuuxW0puMIEAADggoYJAADABQ0TAACACxomAAAAF34t+t67d68yMjL04IMPKj09XYcOHVJmZqbq6+vl9XqVm5vbYhei3nDDDUbOn0XeTouu3377bVsc6BPlfRd9p6amGmOysrKMnO/CTDaga/quu+46I3fttde6Hvfhhx8aOTYubTx//OMfjdzFF18chkrOTkxMjJHr27evkXv55ZfP+LVHjRpl5F566SVbXFJScsav2xr5fp9iY2ONMRs2bLDF/fr18+u1ff9OPfPMM8YY3wX9TgvKWwLXK0zV1dWaNWuWbXfhhQsXKi0tTWvWrFHXrl0dP+0AAADQUrg2TFFRUcrLy1NCQkJDrri4WCkpKZL++wgO34/CAwAAtCSut+Q8Ho+xF1FNTU3DLbj4+HjH5x0BAAC0FGe96Nufzc8AAACas4B2+o6JiVFtba2io6N15MgR2+26lubee+8N6DinRjLQRd6+vv32W1u8Z88eY4zvIjxJuu2222zxypUrg1IPQic+Pj6g43bt2mXkfN83CJ5LL73UFgf6O9F3p+UhQ4YYYyIjI43cpk2bbLHTBwMiIiJscTD/s9uxY0db7PRhGV9t27Y1cr6/o1j0beratauRW758uS1OTk42xnzxxRe2+JVXXjHG7Ny508idf/75tnjSpEnGmJa6s7evgK4wDRo0SIWFhZL++4Pq9EMNAADQUrheYSopKVF2drZKS0vl8XhUWFioefPmacqUKcrPz1diYqLuuuuuxqgVAAAgLFwbpl69ejneuvHd0wcAAKClCmgNU2ty1VVXBXTcunXrglzJ2evUqVO4S4AL33Udzz33nF/HVVVV2eIFCxYErSa4890U0HdNj798t2iZP3++MaZdu3ZGrqKiIqDzBYtvTT179gzodQ4cOBCMcloU381rfderSeb8f/zxx8aYq6++Oij1OK2PbS0f/uLRKAAAAC5omAAAAFzQMAEAALigYQIAAHDBom8Xb731lpFzeoJ8Y/LdJG/QoEF+HfeXv/wlFOUgiPr06WOLnTYgdLJt2zZb/NlnnwWtJtilpaUZue7du4fkXE4bAjbFTQJPnTpli3fs2BGmSpo3pw8L+G5m6rToPz093RY7/d3yR3R0tJEbMWKELU5NTTXG+PvhlOaOK0wAAAAuaJgAAABc0DABAAC4YA2Ti0OHDgV0nNNO6L6be91xxx3GGKf70758H6Lp9DDO2bNnG7kPP/zQ9bUB/DSnh586/QwGokuXLrbYd72iJH311VdBOReanjFjxhi54cOHux7n+zfB6RjfDS9zc3ONMYMHDzZy11xzjev5fR/s21JxhQkAAMAFDRMAAIALGiYAAAAXNEwAAAAu/Fr0vXfvXmVkZOjBBx9Uenq6pkyZoj179iguLk6S9PDDD+vGG28MZZ1hEx8fH9BxvhuJNTanxaIXXHCBLQ50QTtCJ9D3zTfffBPkSvBj1q9fb+SefPJJW5yQkBDQay9btswWHz9+3BjzwAMPGLldu3a5vvbBgwcDqgmNp3fv3gEdt3LlStcxJSUltrhXr14BnWvNmjVG7qOPPgrotZob14apurpas2bNUlJSki0/adIkJScnh6wwAACApsL1llxUVJTy8vIC/h8TAABAc+faMHk8Hsfny6xatUpjx47VxIkTdezYsZAUBwAA0BQEtHHlnXfeqbi4OPXs2VOvvfaaFi9erBkzZgS7trDw3ZRu1qxZAb3O119/beQuueSSM34dpw3B3nvvPVvs8ZjfxvHjxxs536uETmO+/PLLMy0RQeS09swfb7zxRpArwY/Zs2ePkfPdKND3Z1Qy1xCec477Z27OPfdcI/fOO++4Hufk1VdftcXPP/+8MebEiRMBvTaCY9GiRUbOd1PUe++91xizf/9+W1xcXGyMmT9/vi2ePn26MWb06NGuNa5evdrI+T58uaUK6FNySUlJ6tmzpyRp2LBh2rt3b1CLAgAAaEoCapiefPLJho62uLhY3bt3D2pRAAAATYnrLbmSkhJlZ2ertLRUHo9HhYWFSk9P14QJE9S2bVvFxMToxRdfbIxaAQAAwsK1YerVq5fjHg+pqakhKQgAAKCpCWjRd0sRFRVl5HwXr3fs2NEY8/3339viO++80xjz17/+1cg5PeXcjdMi7JqaGtfjnDaymzNnji3Oz883xgwaNMgW+/5bETyxsbFGzuv1hqESnC3fTQGdftYfeeQRW+y0wPaiiy6yxd26dQtCdf+VkZFhi6+99lpjTEpKii2uqqoK2vnhzvd9JEnjxo2zxZMnTzbG/Oc//7HF/nzfnnnmGSPn9J78/e9/b4s/+OAD19duqXg0CgAAgAsaJgAAABc0TAAAAC5omAAAAFy06kXfV199tZF76KGHXI/z3Wn3/fff9+t8TjsEh8qKFSuM3GWXXWaLMzMzjTETJ060xTk5OcEtDA1GjBhh5Pr37+96nNMuvk6LRdG05OXl/WTsr5EjRxq5gQMH2uJJkyYZY3x3Fr/mmmuMMQsXLrTF/vw+ROOqqKgI6Lg2bdrY4rVr1xpjnJ4s8eijj9ri+vr6gM7fEnCFCQAAwAUNEwAAgAsaJgAAABeteg2T01oAX06bRGZlZYWgmtBbt26dLXZawxQfH99Y5bR6Tk8d94fTpnTV1dVnWw6aibfffts198ILLxhjjh8/bostyzLG+G5cOHv2bGPMvn37/KoTTYvvI8yGDBlijHnggQeMXGtes+SLK0wAAAAuaJgAAABc0DABAAC4oGECAABw4dei75ycHO3cuVN1dXV67LHH1Lt3b2VmZqq+vl5er1e5ubmKiooKda1B5/RkZl8nTpwwcp9++mkoygH88vHHH4e7BDRxJ0+eNHIffvihLe7bt68xxndzwwEDBhhjWPTd9N1zzz1GzndT4iVLlhhjVq1aFbKaWgLXhmn79u36/PPPlZ+fr8rKSt19991KSkpSWlqabrnlFi1YsEAFBQVKS0trjHoBAAAanestuQEDBujll1+WJMXGxqqmpkbFxcVKSUmRJCUnJ6uoqCi0VQIAAISRa8MUGRmpmJgYSVJBQYGGDh2qmpqahltw8fHxKisrC22VAAAAYeT3xpWbN29WQUGBVqxYoeHDhzfknTY/ay4OHz5s5BITE8NQSeN46qmnXMccPXq0ESrB2Xj33XfDXQKaoU8++cQWO61h8vXzn//cyL355ptBqwnBcdNNN9lip+/RgQMHbPHjjz8e0ppaIr8+Jbdt2zYtWbJEeXl56tChg2JiYlRbWytJOnLkiBISEkJaJAAAQDi5NkxVVVXKycnR0qVLFRcXJ0kaNGiQCgsLJUmbNm1y3GIdAACgpXC9Jbdx40ZVVlZqwoQJDbm5c+dq+vTpys/PV2Jiou66666QFgkAABBOrg3TqFGjNGrUKCP/+uuvh6QgAACApsbvRd8t0Zdffmnk+vXrZ4u/+eabxionYB07djRyzzzzjJG7//77bfHatWuNMT9sIYHg69Spky2+9NJLw1QJwuHGG2+0xXPnzjXG+C7E3blzZ0Dn6tatm5EbM2aMLfbnAzuvvvpqQOdH45o2bZot9njMP+2pqamNVU6LxaNRAAAAXNAwAQAAuKBhAgAAcEHDBAAA4KJVL/petGiRkbv33nttsdPiyR8eFfOD6urq4BbmokuXLrb4rbfeMsYMHDjQyPnu9Dt58mRjTF1d3VlWhx9zwQUX2OI+ffqEqRKEg++HM/r372+MOffcc11fp02bNkZuxowZtjjQh6H/6U9/ssU8J7TpWbZsmZHr2rWrLc7OzjbGfPbZZyGrqbXgChMAAIALGiYAAAAXNEwAAAAuWvUaph07dhi5p59+2hY7beTou5lcVlaWMWbz5s1GrqKiwhZ37tzZGBMbG2uLFy9ebIy59tprf/IYyXnDOd86y8rKjDFoWvbv32/kfJ86jpZj5syZttjpifLR0dFGLpBNCSsrK42c79qXxl6fCdO4ceNsse8GxJKUl5dni303skRwcIUJAADABQ0TAACACxomAAAAFzRMAAAALvxa9J2Tk6OdO3eqrq5Ojz32mD744APt2bNHcXFxkqSHH37YeBJ3c1BTU2PkfBfPOZk/f74tfvPNN40xx44dM3IlJSW22GlzSacFnb5Onjxpi8eOHWuMWb16tZHz5+nkCB3fRfb//ve/jTE9evSwxW+88YYx5uuvvw5qXWg6rr/++kY715o1a4zc1q1bG+38MDl9/1966SVb7PQ3Yvny5SGrCf/j2jBt375dn3/+ufLz81VZWam7775b1113nSZNmqTk5OTGqBEAACCsXBumAQMGNDzCITY2VjU1Naqvrw95YQAAAE2F6xqmyMjIhmenFRQUaOjQoYqMjNSqVas0duxYTZw40fH2EwAAQEvh98aVmzdvVkFBgVasWKGSkhLFxcWpZ8+eeu2117R48WLj4Y/NVW1trS12ekCv78aVc+fONcYMHjzYyA0dOtT1/Bs3brTF//znP40xv/vd72xxeXm56+si/I4ePWqLr7jiijBVgnD46KOPbPGnn35qjOnevbst9niCt7dwVVWVLd6wYUPQXhvBkZmZaeTatm1ri2+++WZjjO+D1REafn1Kbtu2bVqyZIny8vLUoUMHJSUlqWfPnpKkYcOGae/evSEtEgAAIJxcG6aqqirl5ORo6dKlDZ+Ke/LJJxse2VBcXGz8rwgAAKAlcb3eu3HjRlVWVmrChAkNuXvuuUcTJkxQ27ZtFRMToxdffDGkRQIAAISTa8M0atQojRo1ysjffffdISkIAACgqQneisJW5O9//7st9mcxN4DW7auvvrLFvXv3Nsb4Pol+6tSpxhinDwusX7/eFhcXFxtjsrOz/aoTjcNpc+HU1FQjl5WVZYv//Oc/G2PY6qdx8GgUAAAAFzRMAAAALmiYAAAAXNAwAQAAuGDRNwA0EW+++eZPxmg5OnbsaOS2bt1q5GbPnm2LT58+HaqS4IIrTAAAAC5omAAAAFzQMAEAALhgDRMAAI3s1ltvDXcJOENcYQIAAHBBwwQAAOCChgkAAMCF6xqmmpoaTZkyRRUVFfruu++UkZGhyy+/XJmZmaqvr5fX61Vubq6ioqIao14AAIBGF2FZlvVTAzZu3KjS0lI98sgjKi0t1S9/+Uv169dPQ4cO1S233KIFCxbo/PPPV1paWsMxBw4cUEpKim6//Xa1b98+5P8IAACAQJ08eVIbNmzQli1bdNFFFzmOcb0ld+utt+qRRx6RJB06dEidO3dWcXGxUlJSJEnJyckqKioKYtkAAABNi9/bCowePVqHDx/WkiVL9NBDDzXcgouPj1dZWVnICgQAAAg3vxumtWvX6tNPP9Vzzz2n/38Xz+WOHgAAQLPnekuupKREhw4dkiT17NlT9fX1ateunWprayVJR44cUUJCQmirBAAACCPXhmnHjh1asWKFJKm8vFzV1dUaNGiQCgsLJUmbNm3SkCFDQlslAABAGLnekhs9erSef/55paWlqba2VjNmzFCvXr00efJk5efnKzExUXfddVdj1AoAABAWrg1TdHS05s+fb+Rff/31kBQEAADQ1ITk4bv19fWSpOrq6lC8PAAAQND80K/80L84CUnD9MM2A1u2bAnFywMAAARdWVmZunbt6vg1152+A1FbW6uSkhJ5vV5FRkYG++UBAACCpr6+XmVlZerVq5eio6Mdx4SkYQIAAGhJXLcVAAAAaO1omAAAAFyEZNH3D+bMmaPdu3crIiJC06ZNU58+fUJ5ulYpJydHO3fuVF1dnR577DH17t1bmZmZqq+vl9frVW5ubsNz/3D2amtrNWLECGVkZCgpKYm5DqH169dr2bJl8ng8euqpp9SjRw/mOwROnTqlyZMn6/jx4/r+++/1+OOPy+v1KisrS5LUo0cPvfDCC+EtsgXYu3evMjIy9OCDDyo9PV2HDh1yfD+vX79ef/jDH3TOOefovvvu08iRI8NderPjNNdTp05VXV2dPB6PcnNz5fV6z3yurRApLi62Hn30UcuyLGvfvn3WfffdF6pTtVpFRUXWuHHjLMuyrGPHjlk33HCDNWXKFGvjxo2WZVnW/PnzrdWrV4ezxBZnwYIF1j333GOtW7eOuQ6hY8eOWcOHD7eqqqqsI0eOWNOnT2e+Q2TlypXWvHnzLMuyrMOHD1upqalWenq6tXv3bsuyLGvSpEnW1q1bw1lis3fq1CkrPT3dmj59urVy5UrLsizH9/OpU6es4cOHWydOnLBqamqs2267zaqsrAxn6c2O01xnZmZa7733nmVZlrVq1SorOzs7oLkO2S25oqIi3XTTTZKkbt266fjx4zp58mSoTtcqDRgwQC+//LIkKTY2VjU1NSouLlZKSookKTk5WUVFReEssUX54osvtG/fPt14442SxFyHUFFRkZKSktS+fXslJCRo1qxZzHeIdOzYUd9++60k6cSJE4qLi1NpaWnDHQHm+uxFRUUpLy/P9txVp/fz7t271bt3b3Xo0EHR0dHq16+fdu3aFa6ymyWnuZ45c6ZSU1Ml/e/9Hshch6xhKi8vV8eOHRviTp06NezPhOCIjIxUTEyMJKmgoEBDhw5VTU1Nw22K+Ph45jyIsrOzNWXKlIaYuQ6dAwcOqLa2VuPHj1daWpqKioqY7xC57bbbdPDgQd18881KT09XZmamYmNjG77OXJ89j8djfFTd6f1cXl6uTp06NYzh7+aZc5rrmJgYRUZGqr6+XmvWrNHtt98e0FyHdA3T/2exe0HIbN68WQUFBVqxYoWGDx/ekGfOg+edd95R3759dfHFFzt+nbkOvm+//VaLFy/WwYMHNXbsWNscM9/B8+677yoxMVHLly/XZ599pscff1wdOnRo+DpzHXo/NsfMffDU19crMzNT1113nZKSkrRhwwbb1/2Z65A1TAkJCSovL2+Ijx49Kq/XG6rTtVrbtm3TkiVLtGzZMnXo0EExMTGqra1VdHS0jhw5YrssicBt3bpV+/fv19atW3X48GFFRUUx1yEUHx+vq6++Wh6PR126dFG7du0UGRnJfIfArl27NHjwYEnS5Zdfru+++051dXUNX2euQ8Pp94fT382+ffuGscqWY+rUqerataueeOIJSc49ittch+yW3PXXX6/CwkJJ0p49e5SQkKD27duH6nStUlVVlXJycrR06VLFxcVJkgYNGtQw75s2bdKQIUPCWWKL8dJLL2ndunV66623NHLkSGVkZDDXITR48GBt375dp0+fVmVlpaqrq5nvEOnatat2794tSSotLVW7du3UrVs37dixQxJzHSpO7+errrpK//rXv3TixAmdOnVKu3btUv/+/cNcafO3fv16tWnTRk899VRDLpC5DulO3/PmzdOOHTsUERGhmTNn6vLLLw/VqVql/Px8LVq0SJdeemlDbu7cuZo+fbq+++47JSYm6sUXX1SbNm3CWGXLs2jRIl144YUaPHiwJk+ezFyHyNq1a1VQUCBJ+tWvfqXevXsz3yFw6tQpTZs2TRUVFaqrq9PTTz8tr9erGTNm6PTp07rqqqs0derUcJfZrJWUlCg7O1ulpaXyeDzq3Lmz5s2bpylTphjv5/fff1/Lly9XRESE0tPTdccdd4S7/GbFaa4rKir0s5/9rOGiTbdu3ZSVlXXGc82jUQAAAFyw0zcAAIALGiYAAAAXNEwAAAAuaJgAAABc0DABAAC4oGECAABwQcMEAADg4v8AE4e9l/A5gtwAAAAASUVORK5CYII=\n","text/plain":["<Figure size 720x360 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"GCxg2k3oFjwk"},"source":["## 신경망 구성"]},{"cell_type":"code","metadata":{"id":"igYMZcWgBCML","executionInfo":{"status":"ok","timestamp":1603381530341,"user_tz":-540,"elapsed":579,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"2d293c55-07be-486b-828b-033ac378b446","colab":{"base_uri":"https://localhost:8080/","height":148}},"source":["class Net(nn.Module):\n","  def __init__(self):\n","    super(Net, self).__init__()\n","\n","    self.conv1 = nn.Conv2d(1, 6, 3)\n","    self.conv2 = nn.Conv2d(6, 16, 3)\n","    self.fc1 = nn.Linear(16 * 5 * 5, 120)\n","    self.fc2 = nn.Linear(120, 84)\n","    self.fc3 = nn.Linear(84, 10)\n","\n","  def forward(self, x):\n","    x = F.max_pool2d(F.relu(self.conv1(x)), (2,2))\n","    x = F.max_pool2d(F.relu(self.conv2(x)), 2)\n","    x = x.view(-1, self.num_flat_featrues(x))\n","    x = F.relu(self.fc1(x))\n","    x = F.relu(self.fc2(x))\n","    x = self.fc3(x)\n","    return x\n","\n","  def num_flat_featrues(self, x):\n","    size = x.size()[1:]\n","    num_features =  1\n","    for s in size:\n","      num_features *= s\n","    \n","    return num_features\n","  \n","net = Net()\n","print(net)"],"execution_count":36,"outputs":[{"output_type":"stream","text":["Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6CN4Kbd9FliP"},"source":["- `.parameters()` "]},{"cell_type":"code","metadata":{"id":"ZxxZoCC-Fn9b","executionInfo":{"status":"ok","timestamp":1603381532283,"user_tz":-540,"elapsed":587,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"e720f19e-2b6b-444f-8421-b7d82a69adcb","colab":{"base_uri":"https://localhost:8080/","height":55}},"source":["params = list(net.parameters())\n","print(len(params))\n","print(params[0].size())"],"execution_count":37,"outputs":[{"output_type":"stream","text":["10\n","torch.Size([6, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"jelPFbNgFwmG"},"source":["임의의 값을 넣어 forward값 확인"]},{"cell_type":"code","metadata":{"id":"nI-7V1oUFoxG","executionInfo":{"status":"ok","timestamp":1603381533036,"user_tz":-540,"elapsed":458,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"b7f7599f-4289-490e-9f13-6a314898b08f","colab":{"base_uri":"https://localhost:8080/","height":55}},"source":["input = torch.randn(1, 1, 28, 28)\n","out = net(input)\n","print(out)"],"execution_count":38,"outputs":[{"output_type":"stream","text":["tensor([[ 0.0102,  0.0280, -0.0377,  0.0349, -0.0815, -0.0930,  0.0454,  0.0013,\n","         -0.0964,  0.0561]], grad_fn=<AddmmBackward>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"hFAKDY87FRuu"},"source":["## 손실함수와 옵티마이저"]},{"cell_type":"code","metadata":{"id":"XHGAenL0Fu7R","executionInfo":{"status":"ok","timestamp":1603382132718,"user_tz":-540,"elapsed":695,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(net.parameters(), lr=0.001, momentum=0.9)"],"execution_count":56,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NV5_xdUsGB1x"},"source":["## 모델 학습\n","\n","- `optimizer.zero_grad` : 가중치의 그래디언트 초기화\n","\n","- loss 계산\n","\n","- `loss.backward()`\n","\n","- `optmizer.step()` : 업데이트"]},{"cell_type":"markdown","metadata":{"id":"rBIYk0aTGEPW"},"source":["- 배치수 확인"]},{"cell_type":"code","metadata":{"id":"qax43PdgDQBk","executionInfo":{"status":"ok","timestamp":1603381609708,"user_tz":-540,"elapsed":610,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"7e8f9d0b-57e3-4d83-968d-6581e0c63dba","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["total_batch = len(train_loader)\n","print(total_batch)"],"execution_count":41,"outputs":[{"output_type":"stream","text":["469\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"4eHTyg6eHzMI"},"source":["- 설명을 위해 `epochs=2`로 지정"]},{"cell_type":"code","metadata":{"id":"NzwisgcADQOD","executionInfo":{"status":"ok","timestamp":1603382181374,"user_tz":-540,"elapsed":36017,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"5b9b6d2a-8e40-4c2a-86ad-f2a7f01e1def","colab":{"base_uri":"https://localhost:8080/","height":167}},"source":["for epoch in range(2):\n","  running_loss = 0.0\n","  for i, data in enumerate(train_loader, 0):\n","    inputs, labels = data\n","\n","    optimizer.zero_grad()\n","\n","    outputs = net(inputs)\n","    loss = criterion(outputs, labels)\n","    loss.backward()\n","    optimizer.step()\n","\n","    running_loss += loss.item()\n","    if i % 100 ==99:\n","      print(\"Epoch:{}, Iter:{}, Loss{}\".format(epoch+1, i+1, running_loss /2000))\n","      running_loss = 0.0"],"execution_count":57,"outputs":[{"output_type":"stream","text":["Epoch:1, Iter:100, Loss0.1083818380832672\n","Epoch:1, Iter:200, Loss0.09907212442159653\n","Epoch:1, Iter:300, Loss0.0742030007839203\n","Epoch:1, Iter:400, Loss0.044820976346731184\n","Epoch:2, Iter:100, Loss0.025257968127727508\n","Epoch:2, Iter:200, Loss0.02061134372651577\n","Epoch:2, Iter:300, Loss0.018759261146187783\n","Epoch:2, Iter:400, Loss0.016737200476229192\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"tumNqvreIMUC"},"source":["## 모델의 저장 및 로드\n","\n","- `torch.save`\n","  - `net.state_dict()`를 저장\n","\n","- `torch.load`\n","  - `load_state_dict`로 모델을 로드"]},{"cell_type":"code","metadata":{"id":"lxj4a7oHDQRR","executionInfo":{"status":"ok","timestamp":1603382183007,"user_tz":-540,"elapsed":585,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["PATH = './mnist_net.pth'\n","torch.save(net.state_dict(), PATH)"],"execution_count":58,"outputs":[]},{"cell_type":"code","metadata":{"id":"9GqVJlGzDQTe","executionInfo":{"status":"ok","timestamp":1603382184216,"user_tz":-540,"elapsed":883,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ba935a34-95c1-4818-eeba-010ded96d26f","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["net = Net()\n","net.load_state_dict(torch.load(PATH))"],"execution_count":59,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":59}]},{"cell_type":"code","metadata":{"id":"15cyBDq0DQV2","executionInfo":{"status":"ok","timestamp":1603382184472,"user_tz":-540,"elapsed":425,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"8f04000f-bda2-4b0d-e9e7-bc7c819be5d4","colab":{"base_uri":"https://localhost:8080/","height":148}},"source":["net.parameters"],"execution_count":60,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<bound method Module.parameters of Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")>"]},"metadata":{"tags":[]},"execution_count":60}]},{"cell_type":"markdown","metadata":{"id":"5IecfHZiI09W"},"source":["## 모델 테스트"]},{"cell_type":"code","metadata":{"id":"QewXif2NDQYZ","executionInfo":{"status":"ok","timestamp":1603382185913,"user_tz":-540,"elapsed":699,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"5a565896-1519-44bd-dbbf-b6f876e2ca5d","colab":{"base_uri":"https://localhost:8080/","height":192}},"source":["dataiter = iter(test_loader)\n","images, labels = dataiter.next()\n","\n","imshow(torchvision.utils.make_grid(images[:4]))"],"execution_count":61,"outputs":[{"output_type":"display_data","data":{"image/png":"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detW2+uBzLVrDVNCQoKKi4ur42+++UZer9ett7th7dq1SxkZGXrjjTfUsGFDeTweVVRUKC4uTqdOnbJdlkTwdu7cqWPHjmnnzp06efKkYmNjmWsXNW3aVPfcc49iYmLUqlUr3XLLLYqOjma+XbBv3z716tVLktS+fXtdvHhRlZWV1a8z1+7w9/fD338377777jBWWXfMnj1brVu31lNPPSXJf49immvXbsndf//9ys7OliQVFBQoISFBDRo0cOvtbkjnz59Xenq6Vq1apfj4eElSz549q+c9JydHvXv3DmeJdcbLL7+szZs363e/+51Gjx6tyZMnM9cu6tWrl3bv3q3Lly+rpKREZWVlzLdLWrdurf3790uSCgsLdcsttygxMVF79uyRxFy7xd/nuUuXLvr000917tw5lZaWat++ferWrVuYK639tmzZonr16unpp5+uzgUz167u9L1s2TLt2bNHUVFRmj9/vtq3b+/WW92QMjMztWLFCrVp06Y69+KLL2ru3Lm6ePGiWrRoocWLF6tevXphrLLuWbFihb773e+qV69emjVrFnPtkk2bNikrK0uS9MQTT6hTp07MtwtKS0s1Z84cnT59WpWVlZo6daq8Xq/mzZuny5cvq0uXLpo9e3a4y6zV8vPztWTJEhUWFiomJkbNmzfXsmXLlJaW5vg8b9++XWvXrlVUVJRSUlL0wAMPhLv8WsXfXJ8+fVo333xz9UWbxMRELViw4JrnmkejAAAAGLDTNwAAgAENEwAAgAENEwAAgAENEwAAgAENEwAAgAENEwAAgAENEwAAgMH/A1oDgJ58c5zAAAAAAElFTkSuQmCC\n","text/plain":["<Figure size 720x360 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"ELx5TrT-DQao","executionInfo":{"status":"ok","timestamp":1603382186857,"user_tz":-540,"elapsed":498,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["outputs = net(images)"],"execution_count":62,"outputs":[]},{"cell_type":"code","metadata":{"id":"9yaMMa8VDQdI","executionInfo":{"status":"ok","timestamp":1603382187121,"user_tz":-540,"elapsed":390,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"b9746b43-42cd-45b0-b3cc-cf32e5599ef3","colab":{"base_uri":"https://localhost:8080/","height":129}},"source":["_, predicted = torch.max(outputs, 1)\n","print(predicted)"],"execution_count":63,"outputs":[{"output_type":"stream","text":["tensor([7, 2, 1, 0, 4, 1, 4, 9, 6, 9, 0, 6, 9, 0, 1, 5, 9, 7, 3, 4, 9, 6, 6, 5,\n","        4, 0, 7, 4, 0, 1, 3, 1, 3, 6, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 3, 2,\n","        4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 4, 3, 7, 4, 6, 4, 3, 0, 7, 0,\n","        2, 7, 1, 7, 3, 7, 9, 7, 9, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 4, 3, 1, 4,\n","        1, 8, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2,\n","        5, 4, 7, 6, 7, 9, 0, 5])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"qOQWilyPOja5","executionInfo":{"status":"ok","timestamp":1603382188054,"user_tz":-540,"elapsed":393,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"ea675dd3-f3bf-46aa-f007-2b49500e13b8","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["print(''.join('{}\\t'.format(str(predicted[j].numpy())) for j in range(4)))"],"execution_count":64,"outputs":[{"output_type":"stream","text":["7\t2\t1\t0\t\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"T1qsc9TUDQfk","executionInfo":{"status":"ok","timestamp":1603382296418,"user_tz":-540,"elapsed":2707,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"97e7413c-2004-4af3-c2b1-23ed61f105ca","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():\n","  for data in test_loader:\n","    images, labels = data\n","    outputs = net(images)\n","    _, predicted = torch.max(outputs.data, 1)\n","    total += labels.size(0)\n","    correct += (predicted == labels).sum().item()\n","\n","  \n","print(100 * correct / total)"],"execution_count":68,"outputs":[{"output_type":"stream","text":["91.77\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"HQBRrbueR94k"},"source":["## GPU 설정 후 학습\n","- 설정 후, 모델과 데이터에 `to`로 GPU를 사용 가능한 형태로 변환 해줘야 한다.\n","\n","- `.cuda()` 로도 가능"]},{"cell_type":"code","metadata":{"id":"uaO3lXxRjslc","executionInfo":{"status":"ok","timestamp":1603382356644,"user_tz":-540,"elapsed":4288,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim\n","\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.datasets\n","import torchvision.transforms as transforms\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","plt.style.use(['seaborn-white'])"],"execution_count":1,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"02LdHlTTSz5L"},"source":["- 현재 GPU 설정"]},{"cell_type":"code","metadata":{"id":"Ybsjn80uSx3X","executionInfo":{"status":"ok","timestamp":1603382356647,"user_tz":-540,"elapsed":1273,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"fb7e3c73-d32d-4391-d77b-8408b8d83a7d","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["torch.cuda.is_available()"],"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"code","metadata":{"id":"HlPZI5wfDQhv","executionInfo":{"status":"ok","timestamp":1603382397427,"user_tz":-540,"elapsed":750,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["use_cuda = torch.cuda.is_available()\n","device = torch.device(\"cuda\" if use_cuda else \"cpu\")"],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"ykIP4ceaSCib","executionInfo":{"status":"ok","timestamp":1603382398724,"user_tz":-540,"elapsed":653,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"dce0dee8-9d42-4d54-a6e6-7c6423d67118","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["device"],"execution_count":5,"outputs":[{"output_type":"execute_result","data":{"text/plain":["device(type='cuda')"]},"metadata":{"tags":[]},"execution_count":5}]},{"cell_type":"markdown","metadata":{"id":"JZ6fOMoakAIi"},"source":["- 데이터 로드\n"]},{"cell_type":"code","metadata":{"id":"WUwhAT3IkBbN","executionInfo":{"status":"ok","timestamp":1603382469380,"user_tz":-540,"elapsed":1786,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"e00902f4-b634-4023-9020-37e72814f34d","colab":{"base_uri":"https://localhost:8080/","height":408,"referenced_widgets":["83d8c6ec890e4b3c98668e0d076d783a","126954033301404fa8a584543b8acf03","f3f2f41c514b4771aeb0be603a296efd","3fbf9f6195004573bea18bb9f67868ee","ea8e1fbfc88047ac94dd811140f13bd1","ee59a3acbf6a40f08161dac41be1b0e0","727247fe34b3420d80dfba23fd014339","523b7a44e40441c883cdc47058731213","542db397b5d64d748baa2c6e45fd417d","2946f591219349459c56eefd5565b063","8b32fde3f8364658ae21e508c6581091","7c584227c8174f98a69fd68f928fcdb9","915c4dd96d85406097e3558dd955f9c0","378c80f118cf40dfa13fe2a6ce07c543","b8a1302b620d4636b74a23811a26f27e","b27e6aa3d4574d67ab4eea771e511a60","4daaeb40b5bc41308b1adbe7c59a1835","001f35557676494cb57f389941c33c43","73fa7ec3b7f7423abe78370857b3fc0b","d0694b0bbe2a47c7b262d09249b4ff99","b78d0835acba4f3c84545b274de8f0ae","8c64453b6f6f4c16b915b70a4df50c76","ed4f2a0776ed46a4ad52b61005df56ff","08505e4c72834ebfa81d605fb04b876f","d920d7d9cb0d42cab5c90e0a9d0db155","a5da7851ddf04ed5bc01b6d8189c2549","c5ac18b2723f4c4baf4de96d02dfd3da","6624a1856ef34266b9b91834ea9cbce2","6b3f515ae85e4fec95a3ad01a6be004b","2e20b015b85844629868c38f706c41ec","35c0e268d604462db8876894e0abc418","e6e2ab5f4d234997b3b1e9218d581db6"]}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                 transforms.Normalize((0.5,), (0.5, ))])\n","\n","trainset = torchvision.datasets.MNIST(root='./data',\n","                                      train=True,\n","                                      download=True,\n","                                      transform=transform)\n","\n","testset = torchvision.datasets.MNIST(root='./data',\n","                                     train=False,\n","                                     download=True,\n","                                     transform=transform)\n","\n","train_loader = DataLoader(trainset,\n","                          batch_size=128,\n","                          shuffle=True,\n","                          num_workers=2)\n","\n","test_loader = DataLoader(testset,\n","                         batch_size=128,\n","                         shuffle=False,\n","                         num_workers=2)"],"execution_count":6,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"83d8c6ec890e4b3c98668e0d076d783a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-images-idx3-ubyte.gz to ./data/MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"542db397b5d64d748baa2c6e45fd417d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4daaeb40b5bc41308b1adbe7c59a1835","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d920d7d9cb0d42cab5c90e0a9d0db155","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"34WyPzrzS8Cd"},"source":["- 모델 생성"]},{"cell_type":"code","metadata":{"id":"lpFTp1Tbjyeb","executionInfo":{"status":"ok","timestamp":1603382482910,"user_tz":-540,"elapsed":664,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"2a05a626-ac2c-4ce7-9f9d-e09fcb5bc1e7","colab":{"base_uri":"https://localhost:8080/","height":148}},"source":["class Net(nn.Module):\n","  def __init__(self):\n","    super(Net, self).__init__()\n","\n","    self.conv1 = nn.Conv2d(1, 6, 3)\n","    self.conv2 = nn.Conv2d(6, 16, 3)\n","    self.fc1 = nn.Linear(16 * 5 * 5, 120)\n","    self.fc2 = nn.Linear(120, 84)\n","    self.fc3 = nn.Linear(84, 10)\n","\n","  def forward(self, x):\n","    x = F.max_pool2d(F.relu(self.conv1(x)), (2,2))\n","    x = F.max_pool2d(F.relu(self.conv2(x)), 2)\n","    x = x.view(-1, self.num_flat_featrues(x))\n","    x = F.relu(self.fc1(x))\n","    x = F.relu(self.fc2(x))\n","    x = self.fc3(x)\n","    return x\n","\n","  def num_flat_featrues(self, x):\n","    size = x.size()[1:]\n","    num_features =  1\n","    for s in size:\n","      num_features *= s\n","    \n","    return num_features\n","  \n","net = Net()\n","print(net)"],"execution_count":7,"outputs":[{"output_type":"stream","text":["Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"BndKyGxnSCXK","executionInfo":{"status":"ok","timestamp":1603382502988,"user_tz":-540,"elapsed":10775,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["net = Net().to(device)"],"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"aHWkPKpRSxYW","executionInfo":{"status":"ok","timestamp":1603382512449,"user_tz":-540,"elapsed":821,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}}},"source":["criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(net.parameters(), lr=0.001, momentum=0.9)"],"execution_count":9,"outputs":[]},{"cell_type":"code","metadata":{"id":"-3dCbF7DSxWC","executionInfo":{"status":"ok","timestamp":1603382624384,"user_tz":-540,"elapsed":18969,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"170a0d3c-4b2f-4062-c9bc-cc67611fd62c","colab":{"base_uri":"https://localhost:8080/","height":167}},"source":["for epoch in range(2):\n","  running_loss = 0.0\n","  for i, data in enumerate(train_loader, 0):\n","    inputs, labels = data[0].to(device), data[1].to(device)\n","\n","    optimizer.zero_grad()\n","\n","    outputs = net(inputs)\n","    loss = criterion(outputs, labels)\n","    loss.backward()\n","    optimizer.step()\n","\n","    running_loss += loss.item()\n","    if i % 100 ==99:\n","      print(\"Epoch:{}, Iter:{}, Loss{}\".format(epoch+1, i+1, running_loss /2000))\n","      running_loss = 0.0"],"execution_count":14,"outputs":[{"output_type":"stream","text":["Epoch:1, Iter:100, Loss0.09504685032367706\n","Epoch:1, Iter:200, Loss0.06631866437196732\n","Epoch:1, Iter:300, Loss0.04214525759220123\n","Epoch:1, Iter:400, Loss0.03200792278349399\n","Epoch:2, Iter:100, Loss0.02313980311155319\n","Epoch:2, Iter:200, Loss0.020468027114868163\n","Epoch:2, Iter:300, Loss0.01810529248416424\n","Epoch:2, Iter:400, Loss0.016721061140298844\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"v5-a95lgSxUH","executionInfo":{"status":"ok","timestamp":1603382630999,"user_tz":-540,"elapsed":2208,"user":{"displayName":"김정훈","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh8ozrjTEd4aTd3Fh173JQLBXjO_CSmgf9PQPLonQ=s64","userId":"01114927838914716549"}},"outputId":"5a9dd53a-a90f-463c-953a-1ba5092c1b73","colab":{"base_uri":"https://localhost:8080/","height":36}},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():\n","  for data in test_loader:\n","    images, labels = data[0].to(device), data[1].to(device)\n","    outputs = net(images)\n","    _, predicted = torch.max(outputs.data, 1)\n","    total += labels.size(0)\n","    correct += (predicted == labels).sum().item()\n","\n","  \n","print(100 * correct / total)"],"execution_count":15,"outputs":[{"output_type":"stream","text":["91.51\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"N7Ht8b49DJBG"},"source":[""],"execution_count":null,"outputs":[]}]}